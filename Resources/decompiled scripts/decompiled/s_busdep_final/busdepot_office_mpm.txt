void main()
{
    l_U0 = 1;
    l_U1 = 144;
    l_U2 = 0;
    l_U3 = 1;
    l_U4 = 0;
    l_U5 = 1.00000000;
    l_U6 = -5.00000000;
    l_U7 = 0;
    l_U8 = 0;
    l_U9 = 0;
    l_U13 = 42;
    l_U14 = 0;
    l_U15 = 0;
    l_U16 = 0;
    l_U17 = 0;
    l_U18 = 0;
    l_U19 = 90.00000000;
    l_U20 = {0.00000000, 0.00000000, 0.00000000};
    l_U23 = {0.00000000, 0.00000000, 0.00000000};
    l_U26 = 0;
    l_U27 = 0;
    l_U28 = 0;
    l_U29 = 0;
    l_U30 = 0;
    l_U31 = 0;
    l_U32 = nil;
    l_U33 = {0.00000000, 0.00000000, 0.00000000};
    l_U36 = 0;
    l_U37 = 0;
    l_U38 = 0;
    l_U40 = 0;
    l_U41 = 0;
    l_U42 = 1500;
    StrCopy( ref l_U52, "DEFAULT_SCRIPTED_CAMERA", 32 );
    StrCopy( ref l_U60, "DEFAULT_SPLINE_CAMERA", 32 );
    l_U68 = 0;
    l_U69 = 0;
    l_U70 = 0;
    l_U71 = 0;
    l_U73 = 0;
    l_U110 = 0;
    l_U219 = 0;
    l_U220 = 0;
    l_U285 = 4100;
    l_U388 = 0;
    l_U389 = 0;
    l_U390 = {-36.47900000, 78.27500000, 0.20000000};
    l_U393 = 180.00000000;
    l_U403 = 2650;
    l_U404 = {-35.42800000, 75.93300000, 1.64800000};
    l_U407 = 180.00000000;
    l_U408 = 0;
    l_U409 = 1650;
    l_U410 = 1000;
    l_U420 = -95.00000000;
    l_U421 = -1.09100000;
    l_U422 = 1000;
    l_U423 = {-39.83800000, 83.30100000, 0.20000000};
    l_U426 = 45.00000000;
    l_U427 = {-39.61500000, 84.51500000, 0.20000000};
    l_U430 = 180.00000000;
    sub_597( "SP", "Script busdepot_office_mpm.sc is starting up...", 0 );
    l_U68 = 1;
    while (IS_EXITFLAG_SET() == 0)
    {
        sub_666();
        if (l_U69 == 0)
        {
            sub_13049();
        }
        WAIT( 0 );
    }
    sub_8068();
    sub_33851();
    SET_EXITFLAG_RESPONSE();
    SET_SCRIPT_AS_NO_LONGER_NEEDED( "busdepot_office_mpm" );
    sub_597( "SP", "Script busdepot_office_mpm.sc is terminating...", 0 );
    return;
}

void sub_597(unknown uParam0, unknown uParam1, string sParam2)
{
    unknown uVar5;

    if (IS_STRING_NULL( sParam2 ))
    {
        sParam2 = "###";
    }
    uVar5 = GET_REAL_GAME_TIMER();
    return;
}

void sub_666()
{
    switch (l_U69)
    {
        case 0:
        if (g_U764 == 9)
        {
            if (sub_764())
            {
                l_U69 = 5;
            }
            if ((((IS_PED_DEAD( sub_1036() )) == 0) || ((IS_PED_DEAD( sub_1036() )) == 1)) AND (((IS_PED_DEAD( g_U2595 )) == 1) AND ((DOES_PED_EXIST( g_U2595 )) == 1)))
            {
                sub_597( "SP", "Mission Failed: Giovanna died.", 0 );
                g_U2872 = 1;
                if ((HAS_PED_BEEN_DAMAGED_BY_PED( g_U2595, sub_1036(), 0 )) == 1)
                {
                    ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 0, 1 );
                    BULLET_CAMERA_TRACK_UNTIL_GROUNDED( 1 );
                    l_U73 = 1;
                    l_U69 = 1;
                    sub_597( "SP", "eFailState = FAIL_HANDLE_GIO_DEATH_CAM", 0 );
                }
            }
            if ((IS_PED_DEAD( sub_1036() )) == 1)
            {
                l_U69 = 3;
                sub_597( "SP", "eFailState = FAIL_WAITING_FOR_PLAYER", 0 );
            }
        }
        else if ((sub_1615() == 1) || ((g_U2628 == 1) || ((((IS_PED_DEAD( g_U2595 )) == 1) AND ((DOES_PED_EXIST( g_U2595 )) == 1)) || ((IS_PED_DEAD( sub_1036() )) == 1))))
        {
            if (((CUTSCENE_NAMED_IS_LOADING( "mid_10e_bus_concat" )) == 1) || ((CUTSCENE_IS_LOADED( "mid_10e_bus_concat" )) == 1))
            {
                CLEAR_NAMED_CUTSCENE( "mid_10e_bus_concat" );
            }
            sub_1747( ref g_U765[9] );
            SET_EXITFLAG_FOR_SCRIPT( GET_ID_OF_THIS_THREAD() );
        }
        break;
        case 1:
        if (sub_1800() == 1)
        {
            l_U69 = 3;
            sub_597( "SP", "eFailState = FAIL_WAITING_FOR_PLAYER", 0 );
        }
        break;
        case 2:
        if (sub_2877() == 1)
        {
            l_U69 = 4;
            sub_597( "SP", "eFailState = FAIL_WAITING_FOR_RESPAWN", 0 );
        }
        break;
        case 3:
        if ((sub_6512( 0 )) == 1)
        {
            l_U69 = 4;
            sub_597( "SP", "eFailState = FAIL_WAITING_FOR_RESPAWN", 0 );
        }
        break;
        case 4:
        if (((IS_PED_DEAD( sub_1036() )) == 0) AND (IS_LAST_MAN_STANDING_ACTIVE() == 0))
        {
            l_U69 = 5;
            sub_597( "SP", "eFailState = FAIL_CLEANUP_ALL", 0 );
        }
        break;
        case 5:
        sub_597( "SP", "eFailState = FAIL_CLEANUP_ALL", 0 );
        if (((IS_PED_DEAD( sub_1036() )) == 0) AND ((IS_PLAYER_DEAD( sub_1058() )) == 0))
        {
            FREEZE_PED_POSITION( sub_1036(), 0 );
            SET_PED_VISIBLE( sub_1036(), 1 );
            SET_PLAYER_CONTROL( sub_1058(), 0, 0 );
            if ((GET_IS_PED_FORCED_TO_WALK( sub_1036() )) == 1)
            {
                SET_PED_FORCED_TO_WALK( sub_1036(), 0 );
            }
            PED_ACTION_TREE_PLAY_NODE( sub_1036(), "/Global/Player/PlayerRoot/PLAYER_INITIALIZE_IDLE" );
        }
        DO_SCREEN_FADE_OUT( 0 );
        AUDIO_MUSIC_SUSPEND( 500 );
        sub_8068();
        sub_3085( g_U2595 );
        l_U69 = 6;
        sub_597( "SP", "eFailState = FAIL_RESTORE_PLAYER", 0 );
        break;
        case 6:
        sub_597( "SP", "eFailState = FAIL_RESTORE_PLAYER", 0 );
        if (l_U74._fU0)
        {
            sub_8999( ref l_U74, sub_1036() );
        }
        sub_12702();
        l_U69 = 7;
        sub_597( "SP", "eFailState = FAIL_RESTART_CHECKPOINT", 0 );
        break;
        case 7:
        if (GET_NUMBER_OF_STREAMING_REQUESTS() == 0)
        {
            sub_597( "SP", "eFailState = FAIL_RESTART_CHECKPOINT", 0 );
            l_U68 = 1;
            l_U69 = 0;
        }
        else
        {
            sub_597( "CCB", "Waiting for stream requests...", 0 );
        }
        break;
    }
    return;
}

int sub_764()
{
    if (HAS_SELECTED_RETRY_CHECKPOINT())
    {
        if (IS_IN_NYMINUTE_MODE())
        {
            SWITCH_TO_LEVEL( GET_INDEX_OF_CURRENT_LEVEL() );
        }
        if (HAS_CUTSCENE_FINISHED() == 0)
        {
            return 0;
        }
        l_U0 = 0;
        g_U648 = 1;
        DO_SCREEN_FADE_OUT( 0 );
        ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 1, 1 );
        TERMINATE_GAME_BULLET_CAMERA();
        if (IS_ANIMATED_CAMERA_PLAYING())
        {
            CAMERA_ANIMATED_STOP( 0, 0 );
        }
        STOP_ALL_SCRIPTED_CONVERSATIONS( 0 );
        DEACTIVATE_BULLET_TIME( 1, 0 );
        END_POSTFX_BLENDER( 0, 0 );
        END_POSTFX_BLENDER( 2, 0 );
        END_POSTFX_BLENDER( 3, 0 );
        END_POSTFX_BLENDER( 4, 0 );
        END_POSTFX_BLENDER( 5, 0 );
        END_POSTFX_BLENDER( 7, 0 );
        END_POSTFX_BLENDER( 9, 0 );
        END_POSTFX_BLENDER( 10, 0 );
        END_POSTFX_BLENDER( 11, 0 );
        END_POSTFX_BLENDER( 12, 0 );
        END_POSTFX_BLENDER( 13, 0 );
        END_POSTFX_BLENDER( 14, 0 );
        END_POSTFX_BLENDER( 15, 0 );
        END_POSTFX_BLENDER( 16, 0 );
        STOP_ALL_IMAGEFX( 0 );
        if (NOT (IS_PED_DEAD( sub_1036() )))
        {
            SET_PED_FORCED_TO_WALK( sub_1036(), 0 );
            SET_PLAYER_FORCED_AIM( sub_1058(), 0, 0 );
            SET_PLAYER_CAN_USE_SHOOTDODGE( sub_1058(), 1 );
            if ((IS_PED_VISIBLE( sub_1036() )) == 0)
            {
                SET_PED_VISIBLE( sub_1036(), 1 );
            }
        }
        CLEAR_PRINTS();
        CLEAR_HELP();
        SET_INTERACTIONTEXT_VISIBLE( 0 );
        RENDER_SCRIPT_CAMS( 0, 0, 3000, 0 );
        DESTROY_ALL_CAMS();
        AUDIO_MUSIC_SUSPEND( 500 );
        return 1;
    }
    return 0;
}

int sub_1036()
{
    if (DOES_MAIN_PLAYER_EXIST())
    {
        return GET_PLAYER_PED( sub_1058() );
    }
    return 0;
}

void sub_1058()
{
    return GET_PLAYER_ID();
}

void sub_1615()
{
    return g_U648;
}

void sub_1747(int iParam0)
{
    iParam0->_fU36 = 0;
    iParam0->_fU40 = 0;
    return;
}

int sub_1800()
{
    switch (l_U73)
    {
        case 0: break;
        case 1:
        sub_597( "SP", "eGioDeathCamState = DEATHCAM_SETUP", 0 );
        sub_1911( 1, 0, 0, 1 );
        g_U2872 = 1;
        sub_2085( ref l_U267, 2250, 1, 0 );
        sub_2221( ref l_U267 );
        l_U73 = 2;
        sub_597( "SP", "eGioDeathCamState = DEATHCAM_WAITING_FOR_BULLETCAM", 0 );
        case 2:
        if (((l_U267._fU16 == 1) || ((sub_2421( ref l_U267 )) == 1)) AND ((IS_BULLET_CAMERA_RUNNING( 0 )) == 0))
        {
            DO_SCREEN_FADE_OUT( 0 );
            ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 1, 0 );
            BULLET_CAMERA_TRACK_UNTIL_GROUNDED( 0 );
            l_U73 = 3;
            sub_597( "SP", "eGioDeathCamState = DEATHCAM_FINISHED", 0 );
        }
        break;
        case 3:
        sub_597( "SP", "eGioDeathCamState = DEATHCAM_FINISHED", 0 );
        l_U73 = 0;
        sub_597( "SP", "eGioDeathCamState = DEATHCAM_IDLE", 0 );
        return 1;
        break;
    }
    return 0;
}

void sub_1911(int iParam0, int iParam1, unknown uParam2, boolean bParam3)
{
    END_POSTFX_BLENDER( 12, 0 );
    if (bParam3)
    {
        STOP_ALL_IMAGEFX( 0 );
    }
    SET_WIDESCREEN_BORDERS( 1, 500 );
    DISPLAY_HUD( 0 );
    if (iParam0 == 1)
    {
        if (NOT (IS_PED_DEAD( sub_1036() )))
        {
            SET_PLAYER_CONTROL( sub_1058(), 0, uParam2 );
            SET_PED_DUCKING( sub_1036(), 0 );
            if (iParam1 == 1)
            {
                CLEAR_PED_TASKS_IMMEDIATELY( sub_1036() );
            }
            SET_PED_INVINCIBLE( sub_1036(), 1 );
        }
    }
    DEACTIVATE_BULLET_TIME( 1, 0 );
    return;
}

void sub_2085(int iParam0, unknown uParam1, boolean bParam2, int iParam3)
{
    if (bParam2)
    {
        iParam0->_fU0 = TIMERA();
    }
    else
    {
        iParam0->_fU0 = TIMERB();
    }
    if (iParam3 == 1)
    {
        iParam0->_fU0 = TIMERSYSTEM();
    }
    iParam0->_fU4 = iParam0->_fU0;
    iParam0->_fU12 = uParam1;
    iParam0->_fU16 = 0;
    iParam0->_fU20 = 0;
    iParam0->_fU24 = 0;
    iParam0->_fU28 = bParam2;
    iParam0->_fU32 = iParam3;
    iParam0->_fU8 = 0;
    return;
}

void sub_2221(int iParam0)
{
    if (NOT iParam0->_fU20)
    {
        iParam0->_fU20 = 1;
        iParam0->_fU16 = 0;
        if (iParam0->_fU28)
        {
            iParam0->_fU0 = TIMERA();
        }
        else
        {
            iParam0->_fU0 = TIMERB();
        }
        if (iParam0->_fU32 == 1)
        {
            iParam0->_fU0 = TIMERSYSTEM();
        }
        iParam0->_fU4 = iParam0->_fU0;
    }
    return;
}

int sub_2421(int iParam0)
{
    if (iParam0->_fU16)
    {
        return 0;
    }
    else if (NOT iParam0->_fU20)
    {
        return 0;
    }
    if (iParam0->_fU28)
    {
        iParam0->_fU4 = TIMERA();
    }
    else
    {
        iParam0->_fU4 = TIMERB();
    }
    if (iParam0->_fU32 == 1)
    {
        iParam0->_fU4 = TIMERSYSTEM();
    }
    if ((iParam0->_fU4 - iParam0->_fU0) >= iParam0->_fU12)
    {
        iParam0->_fU16 = 1;
        iParam0->_fU20 = 0;
        return 1;
        break;
    }
    return 0;
}

int sub_2877()
{
    vector vVar2;
    float fVar5;
    vector vVar6;
    float fVar9;
    vector vVar10;
    float fVar13;

    vVar2 = {-39.83800000, 83.30100000, 0.20000000};
    fVar5 = 0.00000000;
    vVar6 = {-39.61500000, 84.51500000, 0.20000000};
    fVar9 = 180.00000000;
    vVar10 = {-40.67800000, 81.21500000, 0.86600000};
    fVar13 = 0.00000000;
    switch (l_U71)
    {
        case 0: break;
        case 1:
        sub_597( "SP", "eGioDeathMPMNISState = NIS_START", 0 );
        sub_1911( 1, 0, 0, 1 );
        ENABLE_CROSSHAIR( 0 );
        sub_3085( l_U234 );
        l_U234 = sub_3163( ref l_U221 );
        if (((IS_PED_DEAD( l_U234 )) == 0) AND ((DOES_PED_EXIST( l_U234 )) == 1))
        {
            SET_PED_NAME_DEBUG( l_U234, "piGiovanna" );
            SET_ROOM_FOR_PED_BY_NAME( l_U234, ref g_U1848 );
            SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( l_U234, 1 );
            SET_PED_VISIBLE( l_U234, 0 );
            SET_PED_COLLISION( l_U234, 0 );
            SET_PED_INVINCIBLE( l_U234, 1 );
            SET_PED_PROOFS( l_U234, 1, 1, 1, 1, 1 );
            SET_PED_CAN_RAGDOLL( l_U234, 0 );
        }
        sub_3085( l_U248 );
        l_U248 = sub_3163( ref l_U235 );
        if (((IS_PED_DEAD( l_U248 )) == 0) AND ((DOES_PED_EXIST( l_U248 )) == 1))
        {
            SET_PED_NAME_DEBUG( l_U248, "piMid10cFailEnemy" );
            SET_ROOM_FOR_PED_BY_NAME( l_U248, ref g_U1848 );
            SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( l_U248, 1 );
            SET_PED_VISIBLE( l_U248, 0 );
            SET_PED_COLLISION( l_U248, 0 );
            SET_PED_INVINCIBLE( l_U248, 1 );
            SET_PED_PROOFS( l_U248, 1, 1, 1, 1, 1 );
            SET_PED_CAN_RAGDOLL( l_U248, 0 );
            sub_4352( l_U248, g_U2855, 25000, 0, 0 );
        }
        sub_4684( l_U234, vVar2, fVar5 );
        sub_4684( l_U248, vVar6, fVar9 );
        ISEQ_REGISTER_ENTITY( 1106596692, "gio", l_U234, 0 );
        ISEQ_REGISTER_ENTITY( 1106596692, "enemy", l_U248, 0 );
        ISEQ_START( 1106596692 );
        l_U71 = 2;
        sub_597( "SP", "eGioDeathMPMNISState = NIS_LOADING", 0 );
        break;
        case 2:
        sub_597( "SP", "eGioDeathMPMNISState = NIS_FIRST_FRAME", 0 );
        sub_3085( g_U2595 );
        sub_3085( l_U218 );
        CAMERA_PLAY_ANIMATED( "LEVEL_S_BUS_CP_05", "MID_10C_BUS_CAM", 1, vVar10, fVar13, 0, 0 );
        if (((IS_PED_DEAD( sub_1036() )) == 0) AND ((DOES_PED_EXIST( sub_1036() )) == 1))
        {
            sub_4684( sub_1036(), -40.93153000, 77.92513000, 0.20012300, 0.00000000 );
            SET_PED_VISIBLE( sub_1036(), 0 );
        }
        if (((IS_PED_DEAD( l_U234 )) == 0) AND ((DOES_PED_EXIST( l_U234 )) == 1))
        {
            SET_PED_COLLISION( l_U234, 1 );
            SET_PED_VISIBLE( l_U234, 1 );
        }
        if (((IS_PED_DEAD( l_U248 )) == 0) AND ((DOES_PED_EXIST( l_U248 )) == 1))
        {
            SET_PED_COLLISION( l_U248, 1 );
            SET_PED_VISIBLE( l_U248, 1 );
        }
        ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 1, 0 );
        DEACTIVATE_BULLET_TIME( 1, 0 );
        DO_SCREEN_FADE_IN( 0 );
        sub_2085( ref l_U249, 0, 1, 0 );
        sub_2221( ref l_U249 );
        sub_2085( ref l_U258, 4500, 1, 0 );
        sub_2221( ref l_U258 );
        l_U71 = 3;
        sub_597( "SP", "eGioDeathMPMNISState = NIS_PLAYING", 0 );
        break;
        case 3:
        if ((sub_2421( ref l_U249 )) == 1)
        {
            sub_5354( ref l_U377 );
            sub_5441( 1, l_U234, "GIOVANNA", ref l_U377, 2, 0 );
            sub_5441( 2, l_U248, "M10_CP_60_AVG", ref l_U377, 2, 0 );
            sub_5695( "SBUS_MID10CBUS", ref l_U377, 7, 1 );
        }
        if ((IS_ANIMATED_CAMERA_PLAYING() == 0) || ((l_U258._fU16 == 1) || ((sub_2421( ref l_U258 )) == 1)))
        {
            if ((sub_6512( 0 )) == 1)
            {
                sub_3085( l_U234 );
                sub_3085( l_U248 );
                if (((IS_PED_DEAD( sub_1036() )) == 0) AND ((DOES_PED_EXIST( sub_1036() )) == 1))
                {
                    SET_PED_VISIBLE( sub_1036(), 1 );
                }
                AUDIO_MUSIC_SUSPEND( 500 );
                if (IS_ANIMATED_CAMERA_PLAYING() == 1)
                {
                    CAMERA_ANIMATED_STOP( 0, 0 );
                }
                l_U71 = 0;
                sub_597( "SP", "eGioDeathMPMNISState = NIS_IDLE", 0 );
                return 1;
            }
        }
        break;
    }
    return 0;
}

void sub_3085(unknown uParam0)
{
    if (DOES_PED_EXIST( uParam0 ))
    {
        if ((NOT (IS_PED_DEAD( uParam0 ))) || (IS_PED_DEAD( uParam0 )))
        {
            REMOVE_ALL_PED_WEAPONS( uParam0 );
            DELETE_PED( ref uParam0 );
        }
    }
    return;
}

void sub_3163(int iParam0)
{
    int iVar3;

    iVar3 = 0;
    if (iParam0->_fU16 == 0)
    {
        if (iParam0->_fU20 != 0)
        {
            iVar3 = GET_SCENE_PED_MODEL( iParam0->_fU20 );
        }
    }
    else
    {
        iVar3 = iParam0->_fU16;
    }
    if ((HAS_MODEL_LOADED( iVar3 )) == 0)
    {
        SCRIPT_ASSERT( "Error: The model you are trying to create a ped with MUST BE PRELOADED!!!!", 0 );
        sub_3333( iParam0->_fU16, 1 );
    }
    iParam0->_fU40 = CREATE_PED( iParam0->_fU24, iParam0->_fU16, iParam0->_fU0, iParam0->_fU12, 1, iParam0->_fU48 );
    if (((IS_PED_DEAD( iParam0->_fU40 )) == 0) AND ((DOES_PED_EXIST( iParam0->_fU40 )) == 1))
    {
        if (iParam0->_fU20 != 0)
        {
            SET_PERSISTENT_PED_VARIATION_ENUM( iParam0->_fU40, iParam0->_fU20 );
        }
        SET_PED_RELATIONSHIP_GROUP( iParam0->_fU40, iParam0->_fU28 );
        SET_PED_RELATIONSHIP( iParam0->_fU40, iParam0->_fU36, iParam0->_fU32 );
        SET_LOAD_COLLISION_FOR_PED_FLAG( iParam0->_fU40, 1 );
        SET_PED_COORDS_NO_OFFSET( iParam0->_fU40, "[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( iParam0->_fU40 ) );
        SET_PED_HEADING( iParam0->_fU40, iParam0->_fU12 );
        iParam0->_fU44 = 1;
    }
    else
    {
        SCRIPT_ASSERT( "Error: The ped you created doesn't exist or is dead!", 0 );
    }
    sub_3815( iParam0->_fU40 );
    sub_3895( iParam0->_fU40 );
    return iParam0->_fU40;
}

void sub_3333(unknown uParam0, boolean bParam1)
{
    if ((IS_MODEL_IN_CDIMAGE( uParam0 )) == 0)
    {
        sub_3438( "[SP]### ERROR! (LoadModel) Trying to load a model that isn't in the img! ###" );
    }
    REQUEST_MODEL( uParam0 );
    "[doubled result, dropped if not asigned]";
    if (bParam1)
    {
        while ((HAS_MODEL_LOADED( uParam0 )) == 0)
        {
            WAIT( 0 );
        }
    }
    return;
}

void sub_3438(unknown uParam0)
{
    return;
}

void sub_3815(unknown uParam0)
{
    if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
    {
        SET_PED_HEALTH( uParam0, 200, 0 );
        SET_PED_ACCURACY( uParam0, -729479261 );
    }
    return;
}

void sub_3895(unknown uParam0)
{
    if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
    {
        SET_PED_AI_TEMPLATE( uParam0, "AIT_DEFAULT_GENERIC" );
    }
    return;
}

void sub_4352(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, int iParam4)
{
    unknown Result;

    if ((HAS_WEAPON_LOADED( uParam1 )) == 0)
    {
        SCRIPT_ASSERT( "The weapon model you are giving to the ped's hand MUST BE PRELOADED!!!!", 0 );
    }
    Result = nil;
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        Result = GIVE_WEAPON_TO_PED_HAND( uParam0, uParam1, uParam2, uParam3 );
        if (iParam4 == 1)
        {
            Result = GET_WEAPON_FROM_HAND( uParam0, uParam3, 0 );
            while (NOT (GET_DOES_WEAPON_EXIST( Result )))
            {
                WAIT( 0 );
                if ((IS_PED_DEAD( uParam0 )) == 0)
                {
                    Result = GET_WEAPON_FROM_HAND( uParam0, uParam3, 0 );
                }
            }
        }
    }
    else
    {
        sub_3438( "[SP]### (F_GivePedWeapon) Error: Trying to give a dead ped a weapon. ###" );
    }
    return Result;
}

void sub_4684(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4)
{
    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        SET_PED_COORDS( uParam0, uParam1, 1 );
        SET_PED_HEADING( uParam0, uParam4 );
    }
    return;
}

void sub_5354(int iParam0)
{
    iParam0->_fU4 = -1;
    iParam0->_fU16 = 0;
    iParam0->_fU20 = 0;
    iParam0->_fU24 = 0;
    iParam0->_fU28 = 0;
    iParam0->_fU32 = 0;
    iParam0->_fU36 = 0;
    return;
}

void sub_5441(int iParam0, unknown uParam1, unknown uParam2, int iParam3, unknown uParam4, unknown uParam5)
{
    if (iParam3->_fU32)
    {
        ;
    }
    else if (iParam3->_fU36 == 0)
    {
        iParam3->_fU36 = 1;
        iParam3->_fU4 = CREATE_NEW_SCRIPTED_CONVERSATION( uParam4 );
        if (iParam3->_fU4 == -1)
        {
            iParam3->_fU32 = 1;
        }
    }
    if ((iParam0 < 9) AND ((iParam0 >= 0) AND ((iParam3->_fU4 < 4) AND (iParam3->_fU4 >= 0))))
    {
        g_U16[iParam3->_fU4]._fU16[iParam0]._fU0 = uParam1;
        g_U16[iParam3->_fU4]._fU16[iParam0]._fU4 = GET_HASH_KEY( uParam2 );
        if (NOT (IS_PED_INJURED( uParam1 )))
        {
            SET_PED_CAN_PLAY_AMBIENT_ANIMS( uParam1, uParam5 );
        }
    }
    return;
}

void sub_5695(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3)
{
    return sub_5719( uParam0, ref g_U157._fU0, uParam1, uParam2, uParam3 );
}

void sub_5719(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4)
{
    char[16] cVar7;
    char[12] cVar11;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;

    StrCopy( ref cVar7, uParam1, 16 );
    array(ref cVar11, 2);
    StrCopy( ref cVar11[0], uParam0, 16 );
    StrCopy( ref cVar11[1], "END", 16 );
    return sub_5774( ref cVar11, uParam2, uParam3, 0, 0, 0, 0, ref cVar7, uParam4 );
}

int sub_5774(unknown uParam0, int iParam1, unknown uParam2, boolean bParam3, boolean bParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8)
{
    int I;
    unknown uVar12;
    unknown uVar13;

    if (iParam1->_fU4 == -1)
    {
        return 0;
    }
    iParam1->_fU0 = uParam2;
    if (NOT (sub_5809( iParam1 )))
    {
        return 0;
    }
    uVar12 = iParam1->_fU4;
    uVar13 = GET_HASH_KEY( ref (uParam0^)[0] );
    iParam1->_fU16 = uVar13;
    SET_CONVERSATION_CHECK_HASH( uVar12, uVar13 );
    g_U157._fU132 = 0;
    iParam1->_fU24 = 0;
    iParam1->_fU28 = uParam5;
    if (bParam3)
    {
        if (iParam1->_fU20)
        {
            iParam1->_fU20 = 0;
        }
    }
    else
    {
        iParam1->_fU20 = 0;
        if (bParam4)
        {
            iParam1->_fU12 = uParam6;
            iParam1->_fU20 = 0;
        }
        else
        {
            iParam1->_fU12 = 0;
            iParam1->_fU20 = 0;
        }
    }
    iParam1->_fU24 = bParam4;
    for ( I = 0; I <= 24; I++ )
    {
        StrCopy( ref g_U233[uVar12][I], "END", 16 );
    }
    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        g_U233[uVar12][I] = {(uParam0^)[I]};
    }
    g_U192[uVar12] = {(iParam1^)};
    sub_6303( ref g_U16[uVar12], ref g_U157 );
    StrCopy( ref g_U16[uVar12]._fU0, uParam7, 16 );
    g_U16[uVar12]._fU136 = uParam8;
    g_U11[iParam1->_fU4] = 1;
    return 1;
}

int sub_5809(int iParam0)
{
    switch (g_U11[iParam0->_fU4])
    {
        case 1:
        case 2:
        return 0;
        break;
    }
    if (IS_SCRIPTED_CONVERSATION_ONGOING( iParam0->_fU4 ))
    {
        if (g_U1[iParam0->_fU4] > iParam0->_fU0)
        {
            return 0;
        }
        STOP_SCRIPTED_CONVERSATION( iParam0->_fU4, 0, 0 );
    }
    g_U1[iParam0->_fU4] = iParam0->_fU0;
    g_U6[iParam0->_fU4]++;
    if (g_U6[iParam0->_fU4] > 100000)
    {
        g_U6[iParam0->_fU4] = 1;
    }
    iParam0->_fU8 = g_U6[iParam0->_fU4];
    return 1;
}

void sub_6303(int iParam0, int iParam1)
{
    int I;

    iParam0->_fU0 = {iParam1->_fU0};
    for ( I = 0; I <= 8; I++ )
    {
        iParam0->_fU92[I] = iParam1->_fU92[I];
    }
    iParam0->_fU132 = iParam1->_fU132;
    iParam0->_fU136 = iParam1->_fU136;
    return;
}

int sub_6512(int iParam0)
{
    iParam0 = 1;
    switch (l_U41)
    {
        case 0:
        if (NOT (sub_6573( ref l_U43 )))
        {
            if ((IS_DEATH_PANEL_WIPE_ALLOWED()) AND (IS_PED_DEAD( sub_1036() )))
            {
                l_U42 = 2000;
                ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 0, 1 );
            }
            sub_2085( ref l_U43, l_U42, 1, 1 );
            sub_2221( ref l_U43 );
        }
        if (sub_2421( ref l_U43 ))
        {
            sub_597( "NS", " show fail/retry text", 0 );
            if ((IS_DEATH_PANEL_WIPE_ALLOWED()) AND (IS_PED_DEAD( sub_1036() )))
            {
                if ((IS_BULLET_CAMERA_RUNNING( 0 )) == 0)
                {
                    if (IS_SCREEN_FADED_OUT())
                    {
                        DO_SCREEN_FADE_IN( 0 );
                    }
                }
                ENABLE_DEATHHELPERTEXT( 1, 1, 0 );
            }
            else if (IS_SCREEN_FADED_OUT())
            {
                DO_SCREEN_FADE_IN( 0 );
                ENABLE_DEATHHELPERTEXT( 1, iParam0, 0 );
            }
            else
            {
                ENABLE_DEATHHELPERTEXT( 1, iParam0, 0 );
            }
            if (NOT (IS_PLAYER_DEAD( sub_1058() )))
            {
                SET_PLAYER_CONTROL( sub_1058(), 0, 0 );
            }
            DISPLAY_HUD( 0 );
            l_U41 = 1;
        }
        break;
        case 1:
        if ((((NOT IS_QUIT_CONFIRMING()) == 1) AND (IS_BUTTON_JUST_PRESSED( 0, 501 ))) || ((N_1855335259()) || (IS_CONTROL_JUST_PRESSED( 2, 82 ))))
        {
            if (IS_QUIT_CONFIRMING() == 1)
            {
                l_U41 = 2;
            }
            else
            {
                l_U41 = 3;
            }
        }
        break;
        case 2:
        sub_597( "NS", "Player will QUIT", 0 );
        sub_7032();
        if (iParam0 == 1)
        {
            DO_SCREEN_FADE_OUT( 0 );
        }
        START_PANEL_WIPE( 0, 6 );
        SET_EXITFLAG_FOR_SCRIPT( GET_ID_OF_THIS_THREAD() );
        RETURN_TO_TITLESCREEN( 0 );
        break;
        case 3:
        sub_597( "NS", "Player will RETRY", 0 );
        if (IS_IN_NYMINUTE_MODE())
        {
            SWITCH_TO_LEVEL( GET_INDEX_OF_CURRENT_LEVEL() );
        }
        if (iParam0 == 1)
        {
            DO_SCREEN_FADE_OUT( 0 );
        }
        sub_7032();
        return 1;
        break;
    }
    return 0;
}

int sub_6573(int iParam0)
{
    if (iParam0->_fU20 == 1)
    {
        return 1;
    }
    if (iParam0->_fU16 == 1)
    {
        return 1;
    }
    return 0;
}

void sub_7032()
{
    sub_597( "NS", "P_PostFailRetryCleanup", 0 );
    sub_7082( ref l_U43 );
    ENABLE_DEATHHELPERTEXT( 0, 0, 2000 );
    SET_SCRIPT_CONTROL_RESET_ON_PLAYER_DEATH( 0 );
    if (NOT (IS_PLAYER_DEAD( sub_1058() )))
    {
        SET_PLAYER_CONTROL( sub_1058(), 1, 0 );
    }
    DISPLAY_HUD( 1 );
    l_U40 = 0;
    l_U40 = l_U40;
    l_U41 = 0;
    return;
}

void sub_7082(int iParam0)
{
    if (iParam0->_fU28)
    {
        iParam0->_fU0 = TIMERA();
    }
    else
    {
        iParam0->_fU0 = TIMERB();
    }
    if (iParam0->_fU32 == 1)
    {
        iParam0->_fU0 = TIMERSYSTEM();
    }
    iParam0->_fU4 = iParam0->_fU0;
    iParam0->_fU16 = 0;
    iParam0->_fU20 = 0;
    iParam0->_fU24 = 0;
    return;
}

void sub_8068()
{
    sub_597( "SP", "P_CLEANUP_ALL", 0 );
    ISEQ_UNREGISTER_ENTITY( -1476959292, "gio" );
    ISEQ_UNREGISTER_ENTITY( -1476959292, "enemy" );
    ISEQ_TERMINATE( -1476959292 );
    sub_8164( -1476959292, ref g_U1272 );
    ISEQ_UNREGISTER_ENTITY( 689789076, "player" );
    ISEQ_TERMINATE( 689789076 );
    sub_8164( 689789076, ref g_U1272 );
    ISEQ_UNREGISTER_ENTITY( 1106596692, "gio" );
    ISEQ_UNREGISTER_ENTITY( 1106596692, "enemy" );
    ISEQ_TERMINATE( 1106596692 );
    sub_8164( 1106596692, ref g_U1272 );
    sub_3085( l_U218 );
    sub_3085( l_U234 );
    sub_3085( l_U248 );
    sub_8678( g_U2852 );
    sub_8678( g_U2853 );
    SET_KILL_EFFECT_NAME( "kill_flash" );
    sub_8748();
    return;
}

void sub_8164(int iParam0, unknown uParam1)
{
    int I;
    int iVar5;

    if (ISEQ_DOES_EXIST( iParam0 ))
    {
        for ( I = 0; I <= ((uParam1^) - 1); I++ )
        {
            if (((uParam1^)[I]._fU4 == 1) || (((uParam1^)[I]._fU4 == 2) || ((uParam1^)[I]._fU4 == 3)))
            {
                if ((uParam1^)[I]._fU0 == iParam0)
                {
                    iVar5 = sub_8276( GET_ID_OF_THIS_THREAD(), ref (uParam1^)[I]._fU8 );
                    if (iVar5 == -1)
                    {
                        (uParam1^)[I]._fU4 = 4;
                        return;
                    }
                    else
                    {
                        return;
                    }
                }
            }
        }
    }
    else
    {
        SCRIPT_ASSERT( "The eTempAssetName ISEQ is NOT valid!!!", 0 );
    }
    return;
}

int sub_8276(int iParam0, unknown uParam1)
{
    int I;
    int Result;

    Result = -1;
    for ( I = 0; I <= ((uParam1^) - 1); I++ )
    {
        if ((uParam1^)[I] == nil)
        {
            ;
        }
        else if ((uParam1^)[I] == iParam0)
        {
            (uParam1^)[I] = nil;
        }
        else if (IS_THREAD_ACTIVE( (uParam1^)[I] ))
        {
            Result = I;
        }
        else
        {
            (uParam1^)[I] = nil;
        };;;
    }
    if (NOT (Result == -1))
    {
        return Result;
    }
    return -1;
}

void sub_8678(unknown uParam0)
{
    if (DOES_OBJECT_EXIST( uParam0 ))
    {
        DELETE_OBJECT( ref uParam0 );
    }
    return;
}

void sub_8748()
{
    sub_597( "CCB", "P_STOP_SP_CHALLENGES", 0 );
    sub_597( "CCB", "Stopping the Bus_Depot_Offices context...", 0 );
    return;
}

void sub_8999(int iParam0, unknown uParam1)
{
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    int iVar9;
    int iVar10;
    int iVar11;
    unknown uVar12;
    unknown uVar13;

    sub_597( "GA", "Restoring the player to the checkpoint - Start", 0 );
    if (l_U0)
    {
        INCREMENT_CHECKPOINT_ATTEMPT();
    }
    g_U648 = 0;
    if (iParam0->_fU0 == 0)
    {
        SCRIPT_ASSERT( "ERROR: Trying to restore a checkpoint that hasn't been saved!!!", 0 );
    }
    sub_9183( iParam0->_fU52 );
    if (SCRIPT_VAR_EXISTS( "SV_LOAD_CNT" ))
    {
        SCRIPT_VAR_SET_INT( "SV_LOAD_CNT", (SCRIPT_VAR_GET_INT( "SV_LOAD_CNT" )) + 1 );
    }
    else
    {
        SCRIPT_VAR_ADD_INT( "SV_LOAD_CNT" );
        SCRIPT_VAR_SET_INT( "SV_LOAD_CNT", 1 );
    }
    CLEAR_KILL_STREAK_RECORDS();
    AUDIO_MUSIC_SUSPEND( 0 );
    DEACTIVATE_BULLET_TIME( 1, 0 );
    ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 1, 0 );
    REMOVE_ALL_ENVIRONMENT_BLOOD();
    RESET_BLOOD_EFFECTS();
    REMOVE_ALL_GLINTS();
    RESET_DESTROYED_COVER();
    RESET_ALL_PTFX();
    uVar4 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( uParam1 )};
    CLEAR_AREA( iParam0->_fU4, 10000.00000000, 1 );
    if (NOT (IS_PED_DEAD( uParam1 )))
    {
        SET_PED_COORDS( uParam1, iParam0->_fU4, 1 );
        sub_10260( uParam1 );
        SET_PED_HEADING( uParam1, iParam0->_fU16 );
    }
    CLEAR_AREA( uVar4, 3.00000000, 1 );
    LOAD_SCENE( iParam0->_fU4 );
    SET_GAMEPLAY_CAM_RELATIVE_HEADING( 0.00000000, 1065353216, 0 );
    iParam0->_fU28 = GET_PED_MAX_HEALTH( uParam1 );
    SET_PED_HEALTH( uParam1, iParam0->_fU28, 0 );
    RESET_PED_GORE( uParam1 );
    RESET_PED_VISIBLE_DAMAGE( uParam1 );
    REMOVE_ALL_PED_WEAPONS( uParam1 );
    if (NOT (iParam0->_fU56 == -1569615261))
    {
        uVar7 = sub_10552( uParam1, iParam0->_fU56, 0, iParam0->_fU76, 1 );
        sub_10899( uVar7, iParam0 + 96, iParam0 + 100 );
    }
    if (NOT (iParam0->_fU60 == -1569615261))
    {
        uVar7 = sub_10552( uParam1, iParam0->_fU60, 1, iParam0->_fU80, 1 );
        sub_10899( uVar7, iParam0 + 104, iParam0 + 108 );
    }
    if (NOT (iParam0->_fU64 == -1569615261))
    {
        uVar7 = sub_10552( uParam1, iParam0->_fU64, 2, iParam0->_fU84, 1 );
        sub_10899( uVar7, iParam0 + 112, iParam0 + 116 );
    }
    if (NOT (iParam0->_fU68 == -1569615261))
    {
        uVar7 = sub_4352( uParam1, iParam0->_fU68, iParam0->_fU88, 0, 1 );
        sub_10899( uVar7, iParam0 + 120, iParam0 + 124 );
    }
    if (NOT (iParam0->_fU72 == -1569615261))
    {
        uVar7 = sub_4352( uParam1, iParam0->_fU72, iParam0->_fU92, 1, 1 );
        sub_10899( uVar7, iParam0 + 128, iParam0 + 132 );
    }
    if (l_U0 == 1)
    {
        if ((IS_PED_DEAD( uParam1 )) == 0)
        {
            if (iParam0->_fU68 != -1569615261)
            {
                uVar7 = GET_WEAPON_FROM_HAND( uParam1, 0, 0 );
                if ((GET_DOES_WEAPON_EXIST( uVar7 )) == 1)
                {
                    uVar8 = GET_WEAPON_TYPE( uVar7 );
                    if ((sub_11361( uVar8 )) == 1)
                    {
                        iVar9 = GET_MAX_AMMO_IN_HAND_CLIP_MP( uParam1, 0 );
                        iVar10 = iParam0->_fU88;
                        if (iVar10 < iVar9)
                        {
                            iVar11 = iVar9 - iVar10;
                            ADD_AMMO_TO_PED( uParam1, uVar8, iVar11, 0 );
                            SET_WEAPON_AMMO_IN_CLIP( uVar7, iVar9 );
                        }
                    }
                }
            }
        }
    }
    sub_11522( iParam0->_fU52 );
    SET_ADRENALINE_AMT( iParam0->_fU32 );
    if (GET_ADRENALINE_AMT() < 0.20000000)
    {
        SET_ADRENALINE_AMT( 0.20000000 );
    }
    SET_PAYNEKILLER_AMT( iParam0->_fU36 );
    SET_PED_DUCKING( sub_1036(), 0 );
    GET_TIME_OF_DAY( ref uVar12, ref uVar13 );
    if (iParam0->_fU140 == 1)
    {
        FREEZE_TIME_OF_DAY( iParam0->_fU40, iParam0->_fU44 );
    }
    else
    {
        RELEASE_TIME_OF_DAY();
        SET_TIME_OF_DAY( iParam0->_fU40, iParam0->_fU44 );
    }
    SET_PED_SWEAT( uParam1, iParam0->_fU136, -1.00000000 );
    RESTORE_PICKUPS();
    SET_GAMEPLAY_CAM_RELATIVE_HEADING( iParam0->_fU20, 1065353216, 0 );
    SET_GAMEPLAY_CAM_RELATIVE_PITCH( iParam0->_fU24, 1065353216, 0 );
    HANDLE_CHECKPOINT_RESTART();
    if (l_U0)
    {
        ADJUST_AMMO_ATTEMPTS();
        ADJUST_PAIN_KILLERS_ATTEMPTS();
    }
    l_U0 = 1;
    DISPLAY_HUD( 1 );
    if (IS_DEATH_PANEL_WIPE_ALLOWED())
    {
        if (IS_BULLET_CAMERA_WIPE_STOPPED())
        {
            RESUME_BULLET_CAMERA_WIPE_ON_FADEIN();
        }
    }
    sub_597( "GA", "Restoring the player to the checkpoint - End", 0 );
    return;
}

void sub_9183(unknown uParam0)
{
    int iVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;
    unknown uVar20;
    unknown uVar21;
    unknown uVar22;
    unknown uVar23;
    unknown uVar24;
    unknown uVar25;
    unknown uVar26;
    unknown uVar27;
    unknown uVar28;
    unknown uVar29;
    unknown uVar30;
    unknown uVar31;
    unknown uVar32;
    unknown uVar33;
    unknown uVar34;
    unknown uVar35;

    iVar3 = 0;
    if (GET_NAME_OF_CURRENT_LEVEL( 64, ref uVar20 ))
    {
        iVar3 = sub_9215( ref uVar20 );
    }
    STRING_FORMAT( 64, ref uVar4, "M_{}_L_{}", 2, 513, iVar3, 513, uParam0 );
    END_CONTEXT( ref uVar4 );
    return;
}

int sub_9215(unknown uParam0)
{
    if (ARE_STRINGS_EQUAL( uParam0, "s_air" ))
    {
        return 21;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_beach" ))
    {
        return 22;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_boat" ))
    {
        return 10;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_booze" ))
    {
        return 0;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_busdep" ))
    {
        return 17;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_cemet" ))
    {
        return 15;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_club" ))
    {
        return 5;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_clubride" ))
    {
        return 4;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fashion" ))
    {
        return 3;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fav0" ))
    {
        return 13;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fav1" ))
    {
        return 14;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fav2" ))
    {
        return 16;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fire" ))
    {
        return 12;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_hotel" ))
    {
        return 19;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_intro" ))
    {
        return 1;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_marina" ))
    {
        return 9;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_nyc" ))
    {
        return 7;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_nyc2" ))
    {
        return 8;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_office" ))
    {
        return 11;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_pana" ))
    {
        return 18;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_police" ))
    {
        return 20;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_stad" ))
    {
        return 6;
    };;;;;;;;;;;;;;;;;;;;;;
    return 99;
}

void sub_10260(unknown uParam0)
{
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;

    if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
    {
        uVar3 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( uParam0 )};
        SET_LOAD_COLLISION_FOR_PED_FLAG( uParam0, 1 );
        SET_PED_COORDS_NO_OFFSET( uParam0, uVar3 );
        FREEZE_PED_POSITION( uParam0, 1 );
        REQUEST_COLLISION_AT_COORD( uVar3 );
        if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
        {
            FREEZE_PED_POSITION( uParam0, 0 );
        }
    }
    return;
}

void sub_10552(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, int iParam4)
{
    unknown Result;

    if ((HAS_WEAPON_LOADED( uParam1 )) == 0)
    {
        SCRIPT_ASSERT( "The weapon model you are giving to the ped's holster MUST BE PRELOADED!!!!", 0 );
    }
    Result = nil;
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        Result = GIVE_WEAPON_TO_PED_HOLSTER( uParam0, uParam1, uParam3, uParam2 );
        if (iParam4 == 1)
        {
            Result = GET_WEAPON_FROM_HOLSTER( uParam0, uParam2 );
            while (NOT (GET_DOES_WEAPON_EXIST( Result )))
            {
                WAIT( 0 );
                if ((IS_PED_DEAD( uParam0 )) == 0)
                {
                    Result = GET_WEAPON_FROM_HOLSTER( uParam0, uParam2 );
                }
            }
        }
    }
    else
    {
        sub_3438( "[SP]### (F_GivePedWeaponToHolster) Error: Trying to give a dead ped a weapon. ###" );
    }
    return Result;
}

void sub_10899(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int I;

    for ( I = 0; I < 26; I++ )
    {
        if (IS_BIT_SET( (uParam1^), I ))
        {
            ENABLE_WEAPON_ATTACHMENT( uParam0, I, 1 );
            TOGGLE_WEAPON_ATTACHMENT( uParam0, I, IS_BIT_SET( (uParam2^), I ) );
        }
        else
        {
            ENABLE_WEAPON_ATTACHMENT( uParam0, I, 0 );
            TOGGLE_WEAPON_ATTACHMENT( uParam0, I, 0 );
        }
    }
    return;
}

int sub_11361(unknown uParam0)
{
    int iVar3;

    iVar3 = GET_WEAPONTYPE_AMMO( uParam0 );
    if ((iVar3 == -1383321053) || ((iVar3 == -1295933220) || ((iVar3 == 1138793073) || (iVar3 == -1088031219))))
    {
        return 1;
    }
    return 0;
}

void sub_11522(unknown uParam0)
{
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;
    unknown uVar20;
    unknown uVar21;
    unknown uVar22;
    unknown uVar23;
    unknown uVar24;
    unknown uVar25;
    unknown uVar26;
    unknown uVar27;
    unknown uVar28;
    unknown uVar29;
    unknown uVar30;
    unknown uVar31;
    unknown uVar32;
    unknown uVar33;
    unknown uVar34;
    unknown uVar35;

    if (GET_NAME_OF_CURRENT_LEVEL( 64, ref uVar20 ))
    {
        uVar3 = sub_9215( ref uVar20 );
    }
    STRING_FORMAT( 64, ref uVar4, "M_{}_L_{}", 2, 513, uVar3, 513, uParam0 );
    sub_11594( uVar3 );
    START_CONTEXT( ref uVar4 );
    return;
}

void sub_11594(int iParam0)
{
    if (iParam0 != 3)
    {
        END_CONTEXT( "S_FAS_GG_PT" );
    }
    if (iParam0 != 5)
    {
        END_CONTEXT( "S_CLB_GG_M3" );
        END_CONTEXT( "S_CLB_MS" );
    }
    if (iParam0 != 6)
    {
        END_CONTEXT( "S_STA_GG_M1" );
        END_CONTEXT( "S_STA_GG_M81" );
    }
    if (iParam0 != 7)
    {
        END_CONTEXT( "S_NY1_GG_19" );
    }
    if (iParam0 != 8)
    {
        END_CONTEXT( "S_NY2_GG_40" );
        END_CONTEXT( "S_NY2_GG_M5" );
    }
    if (iParam0 != 9)
    {
        END_CONTEXT( "S_MAR_GG_LM" );
        END_CONTEXT( "S_MAR_GG_9M" );
    }
    if (iParam0 != 11)
    {
        END_CONTEXT( "S_OFF_GG_MD" );
    }
    if (iParam0 != 14)
    {
        END_CONTEXT( "S_FV1_GG_SP" );
        END_CONTEXT( "S_FV1_GG_SA" );
    }
    if (iParam0 != 15)
    {
        END_CONTEXT( "S_NYC_GG_6M" );
        END_CONTEXT( "S_NYC_GG_A9" );
    }
    if (iParam0 != 16)
    {
        END_CONTEXT( "S_FV2_GG_D5" );
        END_CONTEXT( "S_FV2_GG_97" );
    }
    if (iParam0 != 17)
    {
        END_CONTEXT( "S_BUS_GG_M4" );
        END_CONTEXT( "S_BUS_GG_FN" );
    }
    if (iParam0 != 18)
    {
        END_CONTEXT( "S_PAN_GG_AK" );
        END_CONTEXT( "S_PAN_GG_SS" );
    }
    if (iParam0 != 19)
    {
        END_CONTEXT( "S_HOT_GG_G3" );
        END_CONTEXT( "S_HOT_GG_LA" );
    }
    if (iParam0 != 20)
    {
        END_CONTEXT( "S_POL_GG_G6" );
        END_CONTEXT( "S_POL_GG_RP" );
        END_CONTEXT( "S_POL_GG_MP" );
    }
    if (iParam0 != 21)
    {
        END_CONTEXT( "S_AIR_GG_RG" );
        END_CONTEXT( "S_AIR_GG_PD" );
    }
    return;
}

void sub_12702()
{
    sub_597( "SP", "P_SETUP_PLAYER_RELATIONSHIPS", 0 );
    if ((IS_PED_DEAD( sub_1036() )) == 0)
    {
        SET_PED_RELATIONSHIP( sub_1036(), 0, 1 );
        SET_PED_RELATIONSHIP( sub_1036(), 0, 2 );
        SET_PED_RELATIONSHIP( sub_1036(), 0, 6 );
        SET_PED_RELATIONSHIP( sub_1036(), 0, 7 );
    }
    return;
}

void sub_13049()
{
    unknown uVar2;
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    vector vVar6;
    float fVar9;
    unknown uVar10;

    vVar6 = {-44.70000000, 72.45000000, 0.20000000};
    fVar9 = 180.00000000;
    switch (l_U68)
    {
        case 0: break;
        case 1:
        sub_597( "SP", "eCheckpointState = CP_INIT_SCRIPT_DATA", 0 );
        sub_13251();
        sub_14367();
        SET_SCRIPT_CONTROL_RESET_ON_PLAYER_DEATH( 1 );
        l_U68 = 2;
        sub_597( "SP", "eCheckpointState = CP_INITIAL_REQUEST_ASSETS", 0 );
        break;
        case 2:
        sub_597( "SP", "eCheckpointState = CP_INITIAL_REQUEST_ASSETS", 0 );
        if (g_U764 < 9)
        {
            if (((CUTSCENE_NAMED_IS_LOADING( "mid_10e_bus_concat" )) == 0) AND ((CUTSCENE_IS_LOADED( "mid_10e_bus_concat" )) == 0))
            {
                PRE_STREAM_SEAMLESS_CUTSCENE( "mid_10e_bus_concat" );
            }
        }
        sub_14788( -1204387800, ref g_U910 );
        sub_14788( g_U2104, ref g_U910 );
        sub_14788( g_U2129, ref g_U910 );
        sub_14788( g_U2130, ref g_U910 );
        sub_14788( g_U2132, ref g_U910 );
        sub_14788( g_U2133, ref g_U910 );
        sub_16213( g_U2854, ref g_U1211 );
        sub_16213( g_U2856, ref g_U1211 );
        sub_16213( g_U2855, ref g_U1211 );
        sub_16213( g_U2857, ref g_U1211 );
        sub_17201( ref g_U1928, ref g_U1369 );
        sub_18185( -1476959292, ref g_U1272 );
        sub_18185( 689789076, ref g_U1272 );
        sub_18185( 1106596692, ref g_U1272 );
        l_U68 = 3;
        sub_597( "SP", "eCheckpointState = CP_INITIAL_LOADING_ASSETS", 0 );
        break;
        case 3:
        if (sub_20236( ref g_U910, ref g_U1211, ref g_U1272, ref g_U1369, ref g_U1474, ref g_U1535, ref g_U1704, ref g_U1757 ))
        {
            l_U68 = 4;
            sub_597( "SP", "eCheckpointState = CP_CREATE_OBJECTS", 0 );
            break;
        }
        return;
        case 4:
        sub_597( "SP", "eCheckpointState = CP_CREATE_OBJECTS", 0 );
        sub_21457( 0 );
        l_U68 = 5;
        sub_597( "SP", "eCheckpointState = CP_HANDLE_CREATE_PEDS", 0 );
        break;
        case 5:
        sub_22074();
        sub_22833();
        l_U68 = 6;
        sub_597( "SP", "eCheckpointState = CP_SETUP_START_POINT", 0 );
        break;
        case 6:
        sub_597( "SP", "eCheckpointState = CP_SETUP_START_POINT", 0 );
        if (g_U764 < 9)
        {
            l_U70 = 1;
            l_U68 = 8;
            sub_597( "SP", "eCheckpointState = CP_HANDLE_MID_10E_CUTSCENE", 0 );
        }
        else if ((l_U110 == 0) AND (g_U763 == 9))
        {
            l_U110 = 1;
            REMOVE_ALL_PED_WEAPONS( sub_1036() );
            if ((sub_23286( ref l_U74 )) == 0)
            {
                sub_4352( sub_1036(), g_U2855, 200, 0, 0 );
            }
            l_U68 = 7;
            sub_597( "SP", "eCheckpointState = CP_WAIT_FOR_PLAYER_WEAPONS", 0 );
        }
        else
        {
            l_U72 = 1;
            l_U68 = 9;
            sub_597( "SP", "eCheckpointState = CP_HANDLE_MID_10E_BLENDOUT", 0 );
        }
        break;
        case 7:
        if ((IS_PED_DEAD( sub_1036() )) == 0)
        {
            if ((GET_DOES_WEAPON_EXIST( GET_WEAPON_FROM_HAND( sub_1036(), 0, 0 ) )) == 1)
            {
                l_U72 = 1;
                l_U68 = 9;
                sub_597( "SP", "eCheckpointState = CP_HANDLE_MID_10E_BLENDOUT", 0 );
            }
        }
        break;
        case 8:
        if (sub_23758() == 1)
        {
            l_U72 = 1;
            l_U68 = 9;
            sub_597( "SP", "eCheckpointState = CP_HANDLE_MID_10E_BLENDOUT", 0 );
            break;
        }
        return;
        case 9:
        if (sub_25950() == 1)
        {
            if (((IS_PED_DEAD( l_U218 )) == 0) AND ((DOES_PED_EXIST( l_U218 )) == 1))
            {
                SET_PED_CAN_TRIGGER_BULLET_CAM( l_U218, 1 );
                SET_BULLET_CAM_PREF( l_U218, "PIST_02_CUSTOM_BUS_GIOV", "PIST_02_CUSTOM_BUS_GIOV", "PIST_02_CUSTOM_BUS_GIOV", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                SET_PED_VALIDATE_BULLET_CAM_HIT( l_U218, 0 );
                ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 0, 0 );
                BULLET_CAMERA_TRACK_UNTIL_GROUNDED( 1 );
            }
            if (IS_ROBO_TESTING() == 1)
            {
                sub_32079( l_U218 );
            }
            l_U68 = 10;
            sub_597( "SP", "eCheckpointState = CP_HANDLE_OFFICE_MPM", 0 );
        }
        else
        {
            return;
        }
        break;
        case 10:
        if ((((IS_PED_DEAD( l_U218 )) == 1) AND ((DOES_PED_EXIST( l_U218 )) == 1)) || (((IS_BULLET_CAMERA_RUNNING( 0 )) == 1) AND (((IS_PED_DEAD( l_U218 )) == 0) AND ((DOES_PED_EXIST( l_U218 )) == 1))))
        {
            sub_7082( ref l_U276 );
        }
        if (((IS_BULLET_CAMERA_RUNNING( 0 )) == 0) AND ((IS_BULLET_CAMERA_ACTIVE() == 0) AND (((IS_PED_DEAD( l_U218 )) == 0) AND (((DOES_PED_EXIST( g_U2595 )) == 1) AND (((IS_PED_DEAD( g_U2595 )) == 0) AND (((DOES_PED_EXIST( l_U218 )) == 1) AND ((sub_2421( ref l_U276 )) == 1)))))))
        {
            DEACTIVATE_BULLET_TIME( 0, 0 );
            DEACTIVATE_BULLET_TIME( 1, 0 );
            DEACTIVATE_BULLET_TIME( 0, 1 );
            DEACTIVATE_BULLET_TIME( 1, 1 );
            ENABLE_MPM( 0 );
            ENABLE_ALL_ADRENALINE( 1 );
            DISPLAY_HUD( 0 );
            ENABLE_CROSSHAIR( 0 );
            sub_7082( ref l_U276 );
            sub_32498( "LBUS_13_DOOR_KICK", ref g_U1704 );
            sub_32827( "LBUS_13_DOOR_KICK", ref g_U1704 );
            if (((IS_PED_DEAD( l_U218 )) == 0) AND ((DOES_PED_EXIST( l_U218 )) == 1))
            {
                SET_PED_CAN_TRIGGER_BULLET_CAM( l_U218, 0 );
                SET_PED_PROOFS( l_U218, 1, 1, 1, 1, 1 );
                SET_PED_INVINCIBLE( l_U218, 1 );
            }
            if (((IS_PED_DEAD( g_U2595 )) == 0) AND ((DOES_PED_EXIST( g_U2595 )) == 1))
            {
                SET_PED_CAN_TRIGGER_BULLET_CAM( g_U2595, 0 );
                SET_PED_PROOFS( g_U2595, 1, 1, 1, 1, 1 );
                SET_PED_INVINCIBLE( g_U2595, 1 );
            }
            AUDIO_MUSIC_SUSPEND( 5000 );
            g_U2872 = 1;
            l_U71 = 1;
            l_U69 = 2;
            sub_597( "SP", "eFailState = FAIL_HANDLE_GIO_DEATH_MPM_FAIL", 0 );
            return;
        }
        if (l_U389 == 0)
        {
            if (((IS_PED_DEAD( l_U218 )) == 1) AND ((DOES_PED_EXIST( l_U218 )) == 1))
            {
                AUDIO_MUSIC_FORCE_TRACK( "BUSDEPOT_ACTION_SONG_03", "BUSDEPOT_03_2", "", 0.00000000, 2000, 5000, -1082130432, 0 );
                l_U389 = 1;
            }
        }
        if (((IS_BULLET_CAMERA_RUNNING( 0 )) == 1) AND ((IS_LAST_MAN_STANDING_ACTIVE() == 0) AND (((IS_PED_DEAD( g_U2595 )) == 0) AND (((DOES_PED_EXIST( g_U2595 )) == 1) AND (((IS_PED_DEAD( l_U218 )) == 1) AND ((DOES_PED_EXIST( l_U218 )) == 1))))))
        {
            sub_597( "SP", "Activate the Railshooter script...", 0 );
            DEACTIVATE_BULLET_TIME( 0, 0 );
            DEACTIVATE_BULLET_TIME( 1, 0 );
            DEACTIVATE_BULLET_TIME( 0, 1 );
            DEACTIVATE_BULLET_TIME( 1, 1 );
            ENABLE_MPM( 0 );
            ENABLE_ALL_ADRENALINE( 1 );
            g_U2871 = 1;
            if (((CUTSCENE_NAMED_IS_LOADING( "mid_10e_bus_concat" )) == 1) || ((CUTSCENE_IS_LOADED( "mid_10e_bus_concat" )) == 1))
            {
                CLEAR_NAMED_CUTSCENE( "mid_10e_bus_concat" );
            }
            l_U68 = 11;
            sub_597( "SP", "eCheckpointState = CP_FINISHED", 0 );
            break;
        }
        return;
        case 11:
        if (NOT (IS_BULLET_CAMERA_RUNNING( 0 )))
        {
            sub_597( "SP", "eCheckpointState = CP_FINISHED", 0 );
            SET_EXITFLAG_FOR_SCRIPT( GET_ID_OF_THIS_THREAD() );
            l_U68 = 0;
            sub_597( "SP", "eCheckpointState = CP_IDLE", 0 );
        }
        break;
    }
    return;
}

void sub_13251()
{
    sub_597( "SP", "P_INIT_GAMEPLAY_STRUCTS", 0 );
    sub_13333( ref l_U174, -71.61896000, 46.54910000, 0.40117700, 268.65510000, -1257669444, 26, 6, 0, 0, 1 );
    sub_13333( ref l_U205, -38.93200000, 90.61500000, 0.20000000, 163.00000000, 187757786, 7, 3, 2, 0, 0 );
    sub_13333( ref l_U221, -39.70406000, 82.69193000, 0.20012300, 0.00000000, -1257669444, 26, 6, 0, 0, 1 );
    sub_13333( ref l_U235, -40.01031000, 85.93464000, 0.20012300, 180.00000000, 187757786, 7, 3, 2, 0, 0 );
    sub_13641( ref l_U111, "TRIG_OFF_MPM_REMOVE_BODIES", -40.92000000, 83.90000000, -0.20000000, 12.00000000, 10.00000000, 4.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
    sub_13641( ref l_U132, "Robo Killing office peds", -39.00000000, 67.33000000, 3.60000000, 5.00000000, 5.00000000, 3.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
    sub_13641( ref l_U153, "Robo Killing security ped", -37.36000000, 71.52000000, 0.82000000, 5.00000000, 5.00000000, 3.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
    sub_13894( ref g_U2295, 1 );
    sub_14097( ref g_U2295, 0 );
    sub_13894( ref g_U2302, 1 );
    sub_13894( ref g_U2309, 1 );
    sub_14181( ref g_U2302, 1 );
    sub_14181( ref g_U2309, 1 );
    sub_13894( ref g_U2316, 1 );
    sub_13894( ref g_U2323, 1 );
    sub_14181( ref g_U2316, 1 );
    sub_14181( ref g_U2323, 1 );
    return;
}

void sub_13333(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10)
{
    iParam0->_fU0 = {uParam1};
    iParam0->_fU20 = uParam5;
    iParam0->_fU12 = uParam4;
    iParam0->_fU24 = uParam6;
    iParam0->_fU28 = uParam7;
    iParam0->_fU36 = uParam8;
    iParam0->_fU32 = uParam9;
    iParam0->_fU44 = 0;
    iParam0->_fU16 = GET_SCENE_PED_MODEL( uParam5 );
    iParam0->_fU48 = uParam10;
    return;
}

void sub_13641(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11)
{
    StrCopy( ref iParam0->_fU0, uParam1, 64 );
    iParam0->_fU64 = 0;
    iParam0->_fU68 = 0;
    iParam0->_fU72 = {uParam2};
    GAMEPLAY_HELPER_BOX_ANGLED_CREATE( 1, iParam0 + 0, uParam2, uParam5, uParam6, uParam7, uParam8, uParam11 );
    return;
}

void sub_13894(int iParam0, int iParam1)
{
    if ((sub_13906( iParam0 )) == 0)
    {
        sub_13972( iParam0 );
    }
    if (iParam1 == 1)
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 1, 0.00000000 );
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, 0.00000000 );
    }
    else
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, 0.00000000 );
    }
    return;
}

int sub_13906(int iParam0)
{
    int iVar3;

    iVar3 = DOES_OBJECT_OF_TYPE_EXIST_AT_COORDS( iParam0->_fU4, 1.00000000, iParam0->_fU0 );
    if (iVar3 == 1)
    {
        return 1;
    }
    return 0;
}

void sub_13972(unknown uParam0)
{
    (uParam0^) = {(uParam0^)};
    return;
}

void sub_14097(int iParam0, unknown uParam1)
{
    if ((sub_13906( iParam0 )) == 0)
    {
        sub_13972( iParam0 );
    }
    DOOR_FIND_CLOSEST_SET_AUTO_CLOSE( iParam0->_fU0, iParam0->_fU4, uParam1 );
    return;
}

void sub_14181(int iParam0, int iParam1)
{
    int iVar4;
    float fVar5;

    if ((sub_13906( iParam0 )) == 0)
    {
        sub_13972( iParam0 );
    }
    if (iParam1 == 1)
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 1, 0.00000000 );
    }
    else
    {
        iVar4 = 0;
        fVar5 = 0.00000000;
        GET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, ref iVar4, ref fVar5 );
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, fVar5 );
    }
    return;
}

void sub_14367()
{
    sub_597( "SP", "P_INIT_SCRIPT_DATA", 0 );
    l_U219 = 0;
    l_U220 = 0;
    l_U408 = 0;
    l_U388 = 0;
    l_U389 = 0;
    g_U2872 = 0;
    g_U2871 = 0;
    sub_7082( ref l_U249 );
    sub_7082( ref l_U258 );
    sub_7082( ref l_U267 );
    sub_7082( ref l_U394 );
    sub_7082( ref l_U411 );
    sub_7082( ref l_U276 );
    l_U70 = 0;
    l_U72 = 0;
    l_U73 = 0;
    l_U71 = 0;
    return;
}

void sub_14788(unknown uParam0, unknown uParam1)
{
    int iVar4;

    if (IS_MODEL_IN_CDIMAGE( uParam0 ))
    {
        iVar4 = sub_14823( uParam0, uParam1, GET_ID_OF_THIS_THREAD() );
        if (iVar4 >= 0)
        {
            (uParam1^)[iVar4]._fU0 = uParam0;
            (uParam1^)[iVar4]._fU4 = 1;
            sub_14954( iVar4, uParam1, GET_ID_OF_THIS_THREAD() );
        }
    }
    else
    {
        SCRIPT_ASSERT( "The asset is NOT in the image!!!", 0 );
    }
    return;
}

int sub_14823(int iParam0, unknown uParam1, unknown uParam2)
{
    int Result;
    int iVar6;

    iVar6 = -1;
    for ( Result = 0; Result <= ((uParam1^) - 1); Result++ )
    {
        if ((uParam1^)[Result]._fU4 == 1)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                SCRIPT_ASSERT( "The MODEL_NAME asset is currently being requested!!!", 0 );
                sub_14954( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 2)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                SCRIPT_ASSERT( "The MODEL_NAME asset is already loading!!!", 0 );
                sub_14954( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 3)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                if (HAS_MODEL_LOADED( iParam0 ))
                {
                    sub_14954( Result, uParam1, uParam2 );
                    return -1;
                }
                else
                {
                    SCRIPT_ASSERT( "The MODEL_NAME asset status is loaded, but the asset is currently NOT loaded!!!", 0 );
                    (uParam1^)[Result]._fU0 = 0;
                    (uParam1^)[Result]._fU4 = 0;
                    sub_15602( ref (uParam1^)[Result]._fU8 );
                    return Result;
                }
            }
        }
        else if ((uParam1^)[Result]._fU4 == 4)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                SCRIPT_ASSERT( "The MODEL_NAME asset is currently being removed!!!", 0 );
                sub_14954( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 0)
        {
            iVar6 = Result;
        };;;;;
    }
    if (NOT (iVar6 == -1))
    {
        if (HAS_MODEL_LOADED( iParam0 ))
        {
            SCRIPT_ASSERT( "The MODEL_NAME is already loaded, but the asset status flag was not set!!!", 0 );
            (uParam1^)[iVar6]._fU0 = iParam0;
            (uParam1^)[iVar6]._fU4 = 3;
            sub_14954( iVar6, uParam1, uParam2 );
            return -1;
        }
        else
        {
            return iVar6;
        }
    }
    SCRIPT_ASSERT( "The MODEL_NAMES - STREAMREQ array is full!!!", 0 );
    return -1;
}

void sub_14954(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int iVar5;

    iVar5 = sub_14974( uParam2, ref (uParam1^)[uParam0]._fU8 );
    if (iVar5 >= 0)
    {
        (uParam1^)[uParam0]._fU8[iVar5] = uParam2;
    }
    else
    {
        SCRIPT_ASSERT( "The MODEL_NAME asset thread indices are NOT available!!!", 0 );
    }
    return;
}

int sub_14974(int iParam0, unknown uParam1)
{
    int I;
    int Result;

    Result = -1;
    for ( I = 0; I <= ((uParam1^) - 1); I++ )
    {
        if ((uParam1^)[I] == nil)
        {
            Result = I;
        }
        else if (IS_THREAD_ACTIVE( (uParam1^)[I] ))
        {
            if ((uParam1^)[I] == iParam0)
            {
                (uParam1^)[I] = nil;
                Result = I;
            }
        }
        else
        {
            (uParam1^)[I] = nil;
            Result = I;
        }
    }
    if (NOT (Result == -1))
    {
        return Result;
    }
    SCRIPT_ASSERT( "There are no THREADID indices available for insert!!!", 0 );
    return -1;
}

void sub_15602(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        (uParam0^)[I] = nil;
    }
    return;
}

void sub_16213(unknown uParam0, unknown uParam1)
{
    int iVar4;

    iVar4 = sub_16234( uParam0, uParam1, GET_ID_OF_THIS_THREAD() );
    if (iVar4 >= 0)
    {
        (uParam1^)[iVar4]._fU0 = uParam0;
        (uParam1^)[iVar4]._fU4 = 1;
        sub_16366( iVar4, uParam1, GET_ID_OF_THIS_THREAD() );
    }
    return;
}

int sub_16234(int iParam0, unknown uParam1, unknown uParam2)
{
    int Result;
    int iVar6;

    iVar6 = -1;
    for ( Result = 0; Result <= ((uParam1^) - 1); Result++ )
    {
        if ((uParam1^)[Result]._fU4 == 1)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                SCRIPT_ASSERT( "The WEAPON_TYPE asset is currently being requested!!!", 0 );
                sub_16366( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 2)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                SCRIPT_ASSERT( "The WEAPON_TYPE asset is already loading!!!", 0 );
                sub_16366( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 3)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                if (HAS_WEAPON_LOADED( iParam0 ))
                {
                    sub_16366( Result, uParam1, uParam2 );
                    return -1;
                }
                else
                {
                    SCRIPT_ASSERT( "The WEAPON_TYPE asset status is loaded, but the asset is currently NOT loaded!!!", 0 );
                    (uParam1^)[Result]._fU0 = 0;
                    (uParam1^)[Result]._fU4 = 0;
                    sub_15602( ref (uParam1^)[Result]._fU8 );
                    return Result;
                }
            }
        }
        else if ((uParam1^)[Result]._fU4 == 4)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                SCRIPT_ASSERT( "The WEAPON_TYPE asset is currently being removed!!!", 0 );
                sub_16366( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 0)
        {
            iVar6 = Result;
        };;;;;
    }
    if (NOT (iVar6 == -1))
    {
        if (HAS_WEAPON_LOADED( iParam0 ))
        {
            (uParam1^)[iVar6]._fU0 = iParam0;
            (uParam1^)[iVar6]._fU4 = 3;
            sub_16366( iVar6, uParam1, uParam2 );
            return -1;
        }
        else
        {
            return iVar6;
        }
    }
    SCRIPT_ASSERT( "The WEAPON_TYPE - STREAMREQ array is full!!!", 0 );
    return -1;
}

void sub_16366(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int iVar5;

    iVar5 = sub_14974( uParam2, ref (uParam1^)[uParam0]._fU8 );
    if (iVar5 >= 0)
    {
        (uParam1^)[uParam0]._fU8[iVar5] = uParam2;
    }
    else
    {
        SCRIPT_ASSERT( "The WEAPON_TYPE asset thread indices are NOT available!!!", 0 );
    }
    return;
}

void sub_17201(unknown uParam0, unknown uParam1)
{
    int iVar4;

    iVar4 = sub_17222( uParam0, uParam1, GET_ID_OF_THIS_THREAD() );
    if (iVar4 >= 0)
    {
        StrCopy( ref (uParam1^)[iVar4]._fU0, uParam0, 32 );
        (uParam1^)[iVar4]._fU32 = 1;
        sub_17359( iVar4, uParam1, GET_ID_OF_THIS_THREAD() );
    }
    return;
}

int sub_17222(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int Result;
    int iVar6;

    iVar6 = -1;
    for ( Result = 0; Result <= ((uParam1^) - 1); Result++ )
    {
        if ((uParam1^)[Result]._fU32 == 1)
        {
            if (ARE_STRINGS_EQUAL( ref (uParam1^)[Result]._fU0, uParam0 ))
            {
                SCRIPT_ASSERT( "The ANIM_DICT asset is currently being requested!!!", 0 );
                sub_17359( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU32 == 2)
        {
            if (ARE_STRINGS_EQUAL( ref (uParam1^)[Result]._fU0, uParam0 ))
            {
                SCRIPT_ASSERT( "The ANIM_DICT asset is already loading!!!", 0 );
                sub_17359( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU32 == 3)
        {
            if (ARE_STRINGS_EQUAL( ref (uParam1^)[Result]._fU0, uParam0 ))
            {
                if (HAS_ANIM_DICT_LOADED( uParam0, 0 ))
                {
                    sub_17359( Result, uParam1, uParam2 );
                    return -1;
                }
                else
                {
                    SCRIPT_ASSERT( "The ANIM_DICT asset status is loaded, but the asset is currently NOT loaded!!!", 0 );
                    StrCopy( ref (uParam1^)[Result]._fU0, "", 32 );
                    (uParam1^)[Result]._fU32 = 0;
                    sub_15602( ref (uParam1^)[Result]._fU36 );
                    return Result;
                }
            }
        }
        else if ((uParam1^)[Result]._fU32 == 4)
        {
            if (ARE_STRINGS_EQUAL( ref (uParam1^)[Result]._fU0, uParam0 ))
            {
                SCRIPT_ASSERT( "The ANIM_DICT asset is currently being removed!!!", 0 );
                sub_17359( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU32 == 0)
        {
            iVar6 = Result;
        };;;;;
    }
    if (NOT (iVar6 == -1))
    {
        if (HAS_ANIM_DICT_LOADED( uParam0, 0 ))
        {
            StrCopy( ref (uParam1^)[iVar6]._fU0, uParam0, 32 );
            (uParam1^)[iVar6]._fU32 = 1;
            sub_17359( iVar6, uParam1, uParam2 );
            return -1;
        }
        else
        {
            return iVar6;
        }
    }
    SCRIPT_ASSERT( "The ANIM_DICT - STREAMREQ array is full!!!", 0 );
    return -1;
}

void sub_17359(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int iVar5;

    iVar5 = sub_14974( uParam2, ref (uParam1^)[uParam0]._fU36 );
    if (iVar5 >= 0)
    {
        (uParam1^)[uParam0]._fU36[iVar5] = uParam2;
    }
    else
    {
        SCRIPT_ASSERT( "The ANIM_DICT asset thread indices are NOT available!!!", 0 );
    }
    return;
}

void sub_18185(unknown uParam0, unknown uParam1)
{
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    int iVar12;

    if (ISEQ_DOES_EXIST( uParam0 ))
    {
        iVar12 = sub_18220( uParam0, uParam1, GET_ID_OF_THIS_THREAD() );
        if (iVar12 >= 0)
        {
            ISEQ_GET_NAME( 32, ref uVar4, uParam0 );
            (uParam1^)[iVar12]._fU0 = uParam0;
            (uParam1^)[iVar12]._fU4 = 1;
            sub_18372( iVar12, uParam1, GET_ID_OF_THIS_THREAD() );
        }
    }
    else
    {
        SCRIPT_ASSERT( "[CCB] ### The eTempAssetName ISEQ is NOT valid!!! ###", 0 );
    }
    return;
}

int sub_18220(int iParam0, unknown uParam1, unknown uParam2)
{
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    int Result;
    int iVar14;

    iVar14 = -1;
    for ( Result = 0; Result <= ((uParam1^) - 1); Result++ )
    {
        if ((uParam1^)[Result]._fU4 == 1)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                SCRIPT_ASSERT( "The ISEQ asset is currently being requested!!!", 0 );
                sub_18372( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 2)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                SCRIPT_ASSERT( "The ISEQ asset is already loading!!!", 0 );
                sub_18372( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 3)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                if ((uParam1^)[Result]._fU0 != 0)
                {
                    if ((ISEQ_QUERY_STATE( (uParam1^)[Result]._fU0, 3 )) || (ISEQ_QUERY_STATE( (uParam1^)[Result]._fU0, 2 )))
                    {
                        ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                        sub_18372( Result, uParam1, uParam2 );
                        return -1;
                    }
                    else if (ISEQ_QUERY_STATE( (uParam1^)[Result]._fU0, 1 ))
                    {
                        ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                        SCRIPT_ASSERT( "The ISEQ asset is currently loading!!!", 0 );
                        sub_18372( Result, uParam1, uParam2 );
                        return -1;
                    }
                    else if (ISEQ_QUERY_STATE( (uParam1^)[Result]._fU0, 6 ))
                    {
                        ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                        SCRIPT_ASSERT( "The ISEQ status is LOADED but the asset is already TERMINATED!!!", 0 );
                        (uParam1^)[Result]._fU0 = 0;
                        (uParam1^)[Result]._fU4 = 0;
                        return Result;
                    }
                    else if ((ISEQ_QUERY_STATE( (uParam1^)[Result]._fU0, 5 )) || (ISEQ_QUERY_STATE( (uParam1^)[Result]._fU0, 4 )))
                    {
                        ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                        SCRIPT_ASSERT( "The ISEQ status is LOADED but the asset is already interrupted or shutting down!!!", 0 );
                        (uParam1^)[Result]._fU0 = 0;
                        (uParam1^)[Result]._fU4 = 0;
                        sub_15602( ref (uParam1^)[Result]._fU8 );
                        return Result;
                    }
                    else
                    {
                        ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                        SCRIPT_ASSERT( "The ISEQ asset status is loaded, but the asset is currently NOT loaded!!!", 0 );
                        (uParam1^)[Result]._fU0 = 0;
                        (uParam1^)[Result]._fU4 = 0;
                        sub_15602( ref (uParam1^)[Result]._fU8 );
                        return Result;
                    };;;;
                }
                else
                {
                    SCRIPT_ASSERT( "Trying to update the state of a DUMMY_SEQUENCE!!!", 0 );
                }
            }
        }
        else if ((uParam1^)[Result]._fU4 == 4)
        {
            if ((uParam1^)[Result]._fU0 == iParam0)
            {
                ISEQ_GET_NAME( 32, ref uVar5, (uParam1^)[Result]._fU0 );
                SCRIPT_ASSERT( "The ISEQ asset is currently being removed!!!", 0 );
                sub_18372( Result, uParam1, uParam2 );
                return -1;
            }
        }
        else if ((uParam1^)[Result]._fU4 == 0)
        {
            iVar14 = Result;
        };;;;;
    }
    if (NOT (iVar14 == -1))
    {
        if (iParam0 != 0)
        {
            if ((ISEQ_QUERY_STATE( (uParam1^)[iVar14]._fU0, 3 )) || (ISEQ_QUERY_STATE( (uParam1^)[iVar14]._fU0, 2 )))
            {
                ISEQ_GET_NAME( 32, ref uVar5, iParam0 );
                SCRIPT_ASSERT( "The ISEQ asset is already loaded, but the asset status flag was not set!!!", 0 );
                (uParam1^)[iVar14]._fU0 = iParam0;
                (uParam1^)[iVar14]._fU4 = 3;
                sub_18372( iVar14, uParam1, uParam2 );
                return -1;
            }
            else
            {
                return iVar14;
            }
        }
        else
        {
            SCRIPT_ASSERT( "Trying to check if index is available for a DUMMY_SEQUENCE!!!", 0 );
        }
    }
    SCRIPT_ASSERT( "The ISEQ - STREAMREQ array is full!!!", 0 );
    return -1;
}

void sub_18372(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int iVar5;

    iVar5 = sub_14974( uParam2, ref (uParam1^)[uParam0]._fU8 );
    if (iVar5 >= 0)
    {
        (uParam1^)[uParam0]._fU8[iVar5] = uParam2;
    }
    else
    {
        SCRIPT_ASSERT( "The ISEQ asset thread indices are NOT available!!!", 0 );
    }
    return;
}

int sub_20236(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7)
{
    if (sub_20248( uParam0 ))
    {
        if (sub_20371( uParam1 ))
        {
            if (sub_20494( uParam2 ))
            {
                if (sub_20687( uParam3 ))
                {
                    if (sub_20816( uParam4 ))
                    {
                        if (sub_20939( uParam5 ))
                        {
                            if (sub_21068( uParam6 ))
                            {
                                if (sub_21197( uParam7 ))
                                {
                                    return 1;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    return 0;
}

int sub_20248(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU4 == 1)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 2)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 4)
        {
            return 0;
        };;;
    }
    return 1;
}

int sub_20371(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU4 == 1)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 2)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 4)
        {
            return 0;
        };;;
    }
    return 1;
}

int sub_20494(unknown uParam0)
{
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU4 == 1)
        {
            ISEQ_GET_NAME( 32, ref uVar3, (uParam0^)[I]._fU0 );
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 2)
        {
            ISEQ_GET_NAME( 32, ref uVar3, (uParam0^)[I]._fU0 );
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 4)
        {
            ISEQ_GET_NAME( 32, ref uVar3, (uParam0^)[I]._fU0 );
            return 0;
        };;;
    }
    return 1;
}

int sub_20687(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU32 == 1)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU32 == 2)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU32 == 4)
        {
            return 0;
        };;;
    }
    return 1;
}

int sub_20816(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU4 == 1)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 2)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU4 == 4)
        {
            return 0;
        };;;
    }
    return 1;
}

int sub_20939(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU64 == 1)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU64 == 2)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU64 == 4)
        {
            return 0;
        };;;
    }
    return 1;
}

int sub_21068(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU32 == 1)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU32 == 2)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU32 == 4)
        {
            return 0;
        };;;
    }
    return 1;
}

int sub_21197(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ((uParam0^)[I]._fU64 == 1)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU64 == 2)
        {
            return 0;
        }
        else if ((uParam0^)[I]._fU64 == 4)
        {
            return 0;
        };;;
    }
    return 1;
}

void sub_21457(int iParam0)
{
    vector vVar3;
    vector vVar6;
    unknown uVar9;
    vector vVar10;
    vector vVar13;

    sub_597( "SP", "P_SETUP_SEC_GATE_BUTTON", 0 );
    vVar3 = {-37.72700000, 76.33300000, 1.27300000};
    vVar6 = {0.00000000, 0.00000000, -90.00000000};
    if (iParam0 == 0)
    {
        uVar9 = g_U2130;
    }
    else
    {
        uVar9 = g_U2129;
    }
    sub_8678( g_U2852 );
    g_U2852 = sub_21594( uVar9, vVar3, vVar6, 0, 0, 0 );
    if ((DOES_OBJECT_EXIST( g_U2852 )) == 1)
    {
        ADD_OBJECT_TO_INTERIOR_ROOM_BY_NAME( g_U2852, ref g_U1848 );
        FREEZE_OBJECT_POSITION( g_U2852, 1 );
    }
    vVar10 = {-37.68800000, 76.55600000, 1.22100000};
    vVar13 = {0.00000000, -77.65000000, 0.00000000};
    sub_8678( g_U2853 );
    g_U2853 = sub_21594( g_U2131, vVar10, vVar13, 0, 0, 0 );
    if ((DOES_OBJECT_EXIST( g_U2853 )) == 1)
    {
        ADD_OBJECT_TO_INTERIOR_ROOM_BY_NAME( g_U2853, ref g_U1848 );
        FREEZE_OBJECT_POSITION( g_U2853, 1 );
        SET_OBJECT_VISIBLE( g_U2853, 0 );
    }
    return;
}

void sub_21594(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, boolean bParam7, int iParam8, unknown uParam9)
{
    unknown Result;

    if ((HAS_MODEL_LOADED( uParam0 )) == 0)
    {
        SCRIPT_ASSERT( "The model you are trying to create a object with MUST BE PRELOADED!!!!", 0 );
        sub_3333( uParam0, 1 );
    }
    Result = CREATE_OBJECT_NO_OFFSET( uParam0, uParam1, NOT bParam7, uParam9 );
    if (iParam8 == 1)
    {
        while ((DOES_OBJECT_EXIST( Result )) == 0)
        {
            WAIT( 0 );
        }
    }
    if ((DOES_OBJECT_EXIST( Result )) == 1)
    {
        SET_OBJECT_ROTATION( Result, uParam4 );
    }
    return Result;
}

void sub_22074()
{
    sub_597( "SP", "P_SETUP_GIOVANNA", 0 );
    if ((((IS_PED_DEAD( g_U2595 )) == 1) AND ((DOES_PED_EXIST( g_U2595 )) == 1)) || ((DOES_PED_EXIST( g_U2595 )) == 0))
    {
        sub_3085( g_U2595 );
        g_U2595 = sub_3163( ref l_U174 );
        sub_22187();
        sub_22601( g_U2595, 0 );
        SET_ROOM_FOR_PED_BY_NAME( g_U2595, ref g_U1832 );
    }
    return;
}

void sub_22187()
{
    sub_597( "SP", "P_SETUP_GIO_ATTRIBUTES", 0 );
    if (((IS_PED_DEAD( g_U2595 )) == 0) AND ((DOES_PED_EXIST( g_U2595 )) == 1))
    {
        SET_PED_NAME_DEBUG( g_U2595, "piGiovanna" );
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( g_U2595, 1 );
        SET_PED_CAN_RAGDOLL_FROM_PLAYER_IMPACT( g_U2595, 0 );
        SET_PED_ONLY_DAMAGED_BY_PLAYER( g_U2595, 1 );
        SET_PED_STAND_GROUND_ON_PLAYER_IMPACT( g_U2595, 1 );
        SET_PED_CAN_PUSH_PLAYER( g_U2595, 1 );
        SET_PED_GORE_FROM_PLAYER( g_U2595, 1 );
        SET_PED_GORE_FROM_NPC( g_U2595, 0 );
        SET_PED_CAN_BE_TARGETTED( g_U2595, 0 );
        SET_PED_AS_ONE_SHOT_KILL( g_U2595, 1 );
        SET_PED_CAN_TRIGGER_BULLET_CAM( g_U2595, 1 );
        SET_BULLET_CAM_PREF( g_U2595, "QUICKCUT_FAILSAFE_01", "QUICKCUT_FAILSAFE_01", "QUICKCUT_FAILSAFE_01", "QUICKCUT_FAILSAFE_01", 1, 0, 0, 0, 0, 0, 0, 0 );
        if ((IS_PED_DEAD( sub_1036() )) == 0)
        {
            SET_PED_PRIMARY_LOOKAT( g_U2595, sub_1036() );
            SET_PED_DEFAULT_AIM_AT_PED( g_U2595, sub_1036() );
        }
    }
    return;
}

void sub_22601(unknown uParam0, boolean bParam1)
{
    sub_597( "SP", "P_SET_PED_INACTIVE", 0 );
    if (bParam1)
    {
        if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
        {
            SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( uParam0, 1 );
            SET_PED_VISIBLE( uParam0, 0 );
            SET_PED_INVINCIBLE( uParam0, 1 );
            FREEZE_PED_POSITION( uParam0, 1 );
            SET_PED_COLLISION( uParam0, 0 );
        }
    }
    else if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
    {
        SET_PED_VISIBLE( uParam0, 1 );
        SET_PED_INVINCIBLE( uParam0, 0 );
        FREEZE_PED_POSITION( uParam0, 0 );
        SET_PED_COLLISION( uParam0, 1 );
    }
    return;
}

void sub_22833()
{
    sub_597( "SP", "P_CREATE_MPM_ENEMY", 0 );
    sub_3085( l_U218 );
    l_U218 = sub_3163( ref l_U205 );
    if (((IS_PED_DEAD( l_U218 )) == 0) AND ((DOES_PED_EXIST( l_U218 )) == 1))
    {
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( l_U218, 1 );
        SET_PED_PATH_CAN_DROP_FROM_HEIGHT( l_U218, 0 );
        SET_PED_PATH_CAN_USE_CLIMBOVERS( l_U218, 0 );
        SET_PED_AS_ONE_SHOT_KILL( l_U218, 1 );
        SET_PED_FREEZE_PROCESSING( l_U218, 1 );
        REGISTER_PED_SHOT_TUNING_SPECIAL01( l_U218 );
        sub_4352( l_U218, g_U2855, 25000, 0, 0 );
    }
    return;
}

int sub_23286(unknown uParam0)
{
    sub_597( "rw", "HAS_SAVEFILE_LOADED()", 0 );
    if (IS_ARCADE_MODE_ACTIVE())
    {
        return 0;
    }
    if (HAS_LOAD_JUST_OCCURRED())
    {
        if ((GET_CHECKPOINT_SELECTED() == 1) || (GET_CHECKPOINT_SELECTED() == 0))
        {
            return 0;
        }
        else
        {
            l_U0 = 0;
            CHECKPOINT_STORAGE_LOAD( uParam0, l_U1 );
            sub_8999( uParam0, sub_1036() );
        }
        if (IS_IN_STORY_MODE())
        {
            START_CONTEXT( "LEVEL" );
        }
        return 1;
    }
    return 0;
}

int sub_23758()
{
    unknown uVar2;
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    int iVar6;

    switch (l_U70)
    {
        case 0: break;
        case 1:
        sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_SETUP", 0 );
        if (((CUTSCENE_NAMED_IS_LOADING( "mid_10e_bus_concat" )) == 0) AND ((CUTSCENE_IS_LOADED( "mid_10e_bus_concat" )) == 0))
        {
            PRE_STREAM_SEAMLESS_CUTSCENE( "mid_10e_bus_concat" );
        }
        AUDIO_MUSIC_STOP_ONESHOT();
        AUDIO_MUSIC_REQUEST_ONESHOT( "BUSDEPOT_ONESHOT_11", 0 );
        l_U70 = 2;
        sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_LOADING", 0 );
        break;
        case 2:
        if ((CUTSCENE_IS_LOADED( "mid_10e_bus_concat" )) == 1)
        {
            l_U70 = 3;
            sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_WAIT_FOR_HANDOFF", 0 );
            break;
        }
        return 0;
        case 3:
        if (g_U2870 == 1)
        {
            l_U70 = 4;
            sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_START", 0 );
            break;
        }
        return 0;
        case 4:
        sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_START", 0 );
        if ((IS_PED_DEAD( sub_1036() )) == 0)
        {
            CUTSCENE_REGISTER_PED_TELEPORT( sub_1036(), l_U390, l_U393 );
            CUTSCENE_REGISTER_PED_ACTION_INTENTION( sub_1036(), 47, -1, 0.00000000, 0.00000000, 0.00000000 );
            ISEQ_REGISTER_ENTITY( 689789076, "player", sub_1036(), 0 );
        }
        if (((IS_PED_DEAD( g_U2595 )) == 0) AND ((DOES_PED_EXIST( g_U2595 )) == 1))
        {
            REGISTER_PED_PRE_SEAMLESS_CUTSCENE( g_U2595, "Giov_Bus", 0 );
            CUTSCENE_REGISTER_PED_TELEPORT( g_U2595, l_U423, l_U426 );
            ISEQ_REGISTER_ENTITY( -1476959292, "gio", g_U2595, 0 );
        }
        if (((IS_PED_DEAD( l_U218 )) == 0) AND ((DOES_PED_EXIST( l_U218 )) == 1))
        {
            SET_PED_FREEZE_PROCESSING( l_U218, 0 );
            REGISTER_PED_PRE_SEAMLESS_CUTSCENE( l_U218, "M_Crac_Sold_OF", 0 );
            CUTSCENE_REGISTER_PED_TELEPORT( l_U218, l_U427, l_U430 );
            uVar3 = GET_WEAPON_FROM_HAND( l_U218, 0, 0 );
            if ((GET_DOES_WEAPON_EXIST( uVar3 )) == 1)
            {
                REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( uVar3, "W_SB_Uzi_Aa_H", 0 );
            }
            ISEQ_REGISTER_ENTITY( -1476959292, "enemy", l_U218, 0 );
        }
        CUTSCENE_REGISTER_ISEQ( 689789076 );
        CUTSCENE_REGISTER_ISEQ( -1476959292 );
        REGISTER_HIDE_ENTITY_AT_POSITION( g_U2302._fU0, g_U2302._fU4 );
        REGISTER_HIDE_ENTITY_AT_POSITION( g_U2309._fU0, g_U2309._fU4 );
        START_SEAMLESS_CUTSCENE();
        l_U70 = 5;
        sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_FIRST_FRAME", 0 );
        break;
        case 5:
        sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_FIRST_FRAME", 0 );
        if ((IS_PED_DEAD( sub_1036() )) == 0)
        {
            uVar2 = sub_24940();
            if ((GET_DOES_WEAPON_EXIST( uVar2 )) == 1)
            {
                SET_WEAPON_AMMO_IN_CLIP( uVar2, 10 );
                SELECT_WEAPON_TO_HAND( sub_1036(), uVar2, 0, 1 );
            }
        }
        AUDIO_MUSIC_FORCE_TRACK( "BUSDEPOT_ACTION_SONG_03", "BUSDEPOT_03_2", "", 0.00000000, 5000, 5000, -1082130432, 0 );
        DO_SCREEN_FADE_IN( 0 );
        l_U70 = 6;
        sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_PLAYING", 0 );
        break;
        case 6:
        if (HAS_CUTSCENE_FINISHED() == 1)
        {
            if (((CUTSCENE_NAMED_IS_LOADING( "mid_10e_bus_concat" )) == 1) || ((CUTSCENE_IS_LOADED( "mid_10e_bus_concat" )) == 1))
            {
                CLEAR_NAMED_CUTSCENE( "mid_10e_bus_concat" );
            }
            l_U70 = 0;
            sub_597( "SP", "eMid10eCutsceneState = CUTSCENE_IDLE", 0 );
            return 1;
        }
        else
        {
            uVar4 = GET_CUTSCENE_SECTION_PLAYING();
            uVar5 = GET_CUTSCENE_TIME();
            iVar6 = GET_CUTSCENE_TIME_MS();
            if (l_U388 == 0)
            {
                if (iVar6 >= 9000)
                {
                    if ((AUDIO_MUSIC_IS_ONESHOT_PREPARED( "BUSDEPOT_ONESHOT_11" )) == 1)
                    {
                        AUDIO_MUSIC_PLAY_ONESHOT();
                        AUDIO_MUSIC_FORCE_TRACK( "BUSDEPOT_ACTION_SONG_03", "BUSDEPOT_03_2_4", "", 0.00000000, 1000, 6000, -1082130432, 0 );
                    }
                    l_U388 = 1;
                }
            }
        }
        break;
    }
    return 0;
}

int sub_24940()
{
    unknown Result;
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;

    if ((IS_PED_DEAD( sub_1036() )) == 0)
    {
        Result = GET_WEAPON_FROM_HAND( sub_1036(), 0, 0 );
        if ((GET_DOES_WEAPON_EXIST( Result )) == 1)
        {
            if ((sub_25003( Result )) == 1)
            {
                return Result;
            }
        }
        uVar3 = GET_WEAPON_FROM_HAND( sub_1036(), 1, 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar3 )) == 1)
        {
            return uVar3;
        }
        uVar4 = GET_WEAPON_FROM_HOLSTER( sub_1036(), 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar4 )) == 1)
        {
            return uVar4;
        }
        uVar5 = GET_WEAPON_FROM_HOLSTER( sub_1036(), 1 );
        if ((GET_DOES_WEAPON_EXIST( uVar5 )) == 1)
        {
            return uVar5;
        }
    }
    return 0;
}

int sub_25003(unknown uParam0)
{
    int iVar3;

    if ((GET_DOES_WEAPON_EXIST( uParam0 )) == 1)
    {
        iVar3 = GET_WEAPON_TYPE( uParam0 );
        if ((iVar3 == 1194438308) || ((iVar3 == -76667461) || ((iVar3 == -1404433099) || ((iVar3 == 1131969637) || ((iVar3 == -691403429) || ((iVar3 == 1845102363) || ((iVar3 == 150541352) || ((iVar3 == -820634585) || ((iVar3 == -612753081) || ((iVar3 == 811797242) || ((iVar3 == 68019059) || ((iVar3 == -1464892298) || ((iVar3 == 456708483) || ((iVar3 == -862236369) || (iVar3 == 406496141)))))))))))))))
        {
            return 1;
        }
    }
    return 0;
}

int sub_25950()
{
    unknown uVar2;
    unknown uVar3;

    switch (l_U72)
    {
        case 0: break;
        case 1:
        sub_597( "SP", "eMid10eBlendState = BLEND_SETUP", 0 );
        sub_1911( 1, 0, 0, 1 );
        sub_26074( ref g_U2295, 0, 1, 1065353216 );
        DOOR_FIND_CLOSEST_ACTIVATE_SPATIAL_DATA( g_U2302._fU0, g_U2302._fU4, 0 );
        DOOR_FIND_CLOSEST_ACTIVATE_SPATIAL_DATA( g_U2309._fU0, g_U2309._fU4, 0 );
        if ((IS_PED_DEAD( sub_1036() )) == 0)
        {
            uVar2 = sub_24940();
            if ((GET_DOES_WEAPON_EXIST( uVar2 )) == 1)
            {
                SET_WEAPON_AMMO_IN_CLIP( uVar2, 10 );
                SELECT_WEAPON_TO_HAND( sub_1036(), uVar2, 0, 1 );
            }
        }
        if ((IS_PED_DEAD( sub_1036() )) == 0)
        {
            uVar3 = GET_WEAPON_FROM_HOLSTER( sub_1036(), 2 );
            if ((GET_DOES_WEAPON_EXIST( uVar3 )) == 1)
            {
                SET_WEAPON_VISIBLE( uVar3, 1 );
            }
        }
        if (((IS_PED_DEAD( sub_1036() )) == 0) AND ((IS_PLAYER_DEAD( sub_1058() )) == 0))
        {
            PED_SET_ACTION_INTENTION( sub_1036(), 47, -1, 0.00000000, 0.00000000, 0.00000000 );
        }
        if ((ISEQ_QUERY_STATE( 689789076, 3 )) == 0)
        {
            sub_4684( sub_1036(), l_U390, l_U393 );
            ISEQ_REGISTER_ENTITY( 689789076, "player", sub_1036(), 0 );
            ISEQ_START( 689789076 );
        }
        if ((ISEQ_QUERY_STATE( -1476959292, 3 )) == 0)
        {
            sub_4684( g_U2595, l_U423, l_U426 );
            if (((IS_PED_DEAD( g_U2595 )) == 0) AND ((DOES_PED_EXIST( g_U2595 )) == 1))
            {
                SET_ROOM_FOR_PED_BY_NAME( g_U2595, ref g_U1848 );
            }
            sub_4684( l_U218, l_U427, l_U430 );
            if (((IS_PED_DEAD( l_U218 )) == 0) AND ((DOES_PED_EXIST( l_U218 )) == 1))
            {
                SET_ROOM_FOR_PED_BY_NAME( l_U218, ref g_U1848 );
                SET_PED_FREEZE_PROCESSING( l_U218, 0 );
            }
            ISEQ_REGISTER_ENTITY( -1476959292, "gio", g_U2595, 0 );
            ISEQ_REGISTER_ENTITY( -1476959292, "enemy", l_U218, 0 );
            ISEQ_START( -1476959292 );
        }
        RENDER_SCRIPT_CAMS( 0, 0, 3000, 0 );
        CAMERA_PLAY_ANIMATED( "LEVEL_S_BUS_CP_05", "BUS_OFFICE_MPM_PSTL_FWD_CAM", 1, l_U404, l_U407, 0, 0 );
        AUDIO_MUSIC_FORCE_TRACK( "BUSDEPOT_ACTION_SONG_03", "BUSDEPOT_03_2_4", "", 0.00000000, 1000, 6000, -1082130432, 0 );
        sub_26074( ref g_U2302, 1, 1, 1065353216 );
        sub_26074( ref g_U2309, 0, 1, 1065353216 );
        sub_13894( ref g_U2295, 1 );
        sub_26074( ref g_U2295, 0, 1, 1065353216 );
        sub_2085( ref l_U394, l_U403, 1, 0 );
        sub_2221( ref l_U394 );
        sub_2085( ref l_U276, l_U285, 1, 0 );
        sub_2221( ref l_U276 );
        l_U72 = 4;
        sub_597( "SP", "eMid10eBlendState = BLEND_FIRST_FRAME", 0 );
        break;
        case 4:
        sub_597( "SP", "eMid10eBlendState = BLEND_FIRST_FRAME", 0 );
        DO_SCREEN_FADE_IN( 0 );
        if ((l_U74._fU0 == 0) || (g_U764 < 9))
        {
            g_U764 = 9;
            sub_27239( ref l_U74, g_U764, sub_1036(), g_U2339[9], g_U2466[9], g_U2509[9], g_U2552[9], 1 );
        }
        sub_30860( ref g_U765[10] );
        l_U72 = 5;
        sub_597( "SP", "eMid10eBlendState = BLEND_PLAYING", 0 );
        break;
        case 5:
        SET_CAM_SIDE_LEFT( 0 );
        if ((sub_2421( ref l_U394 )) == 1)
        {
            if (((IS_PED_DEAD( sub_1036() )) == 0) AND ((IS_PLAYER_DEAD( sub_1058() )) == 0))
            {
                ENABLE_MPM( 1 );
                ENABLE_ALL_ADRENALINE( 0 );
                ENABLE_CROSSHAIR( 0 );
                DISPLAY_HUD( 1 );
                SET_CROSSHAIR_PULSE();
                if (GET_ADRENALINE_AMT() < 0.10000000)
                {
                    SET_ADRENALINE_AMT( 0.10000000 );
                }
                SET_PED_CONSUMING_AMMO( sub_1036(), 0 );
                ACTIVATE_BULLET_TIME( 0, 1065353216, 1 );
                sub_31098();
                SIMULATE_PLAYER_INPUT_GAIT( GET_PLAYER_ID(), 3, l_U422, 0 );
            }
        }
        if (l_U408 == 0)
        {
            if (IS_ANIMATED_CAMERA_PLAYING() == 1)
            {
                if (CAMERA_ANIMATED_CURRENT_TIME() >= l_U409)
                {
                    SET_GAMEPLAY_CAM_RELATIVE_HEADING( l_U420, 1065353216, 0 );
                    SET_GAMEPLAY_CAM_RELATIVE_PITCH( l_U421, 1065353216, 0 );
                    CAMERA_ANIMATED_STOP( l_U410, 1 );
                    sub_2085( ref l_U411, l_U410, 1, 0 );
                    sub_2221( ref l_U411 );
                    l_U408 = 1;
                }
            }
        }
        if ((sub_2421( ref l_U411 )) == 1)
        {
            sub_31455( 1, 1 );
            if (((IS_PED_DEAD( g_U2595 )) == 0) AND ((DOES_PED_EXIST( g_U2595 )) == 1))
            {
                PED_SET_ACTION_INTENTION( g_U2595, 47, 1000, 0.00000000, 0.00000000, 0.00000000 );
            }
            if (((IS_PED_DEAD( l_U218 )) == 0) AND ((DOES_PED_EXIST( l_U218 )) == 1))
            {
                PED_SET_ACTION_INTENTION( l_U218, 47, 1000, 0.00000000, 0.00000000, 0.00000000 );
            }
            l_U72 = 0;
            return 1;
        }
        break;
    }
    return 0;
}

void sub_26074(int iParam0, int iParam1, int iParam2, unknown uParam3)
{
    float fVar6;

    if ((sub_13906( iParam0 )) == 0)
    {
        sub_13972( iParam0 );
    }
    fVar6 = 0.00000000;
    if (iParam1 == 1)
    {
        fVar6 = uParam3;
    }
    else
    {
        fVar6 = -uParam3;
    }
    if (iParam2 == 1)
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 1, fVar6 );
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, fVar6 );
    }
    else
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, fVar6 );
    }
    return;
}

void sub_27239(int iParam0, int iParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, int iParam9)
{
    int iVar12;
    int iVar13;
    int iVar14;
    int iVar15;
    int iVar16;

    sub_597( "GA", "Saving the player data for checkpoint - Start", 0 );
    if ((IS_PED_DEAD( uParam2 )) == 0)
    {
        sub_597( "SP", "Saving to scripted data...", 0 );
        RESET_CHECKPOINT_ATTEMPTS();
        if (SCRIPT_VAR_EXISTS( "SV_SAVE_CNT" ))
        {
            SCRIPT_VAR_SET_INT( "SV_SAVE_CNT", (SCRIPT_VAR_GET_INT( "SV_SAVE_CNT" )) + 1 );
        }
        else
        {
            SCRIPT_VAR_ADD_INT( "SV_SAVE_CNT" );
            SCRIPT_VAR_SET_INT( "SV_SAVE_CNT", 1 );
        }
        sub_11522( iParam1 );
        sub_27498( iParam1 );
        iParam0->_fU52 = iParam1;
        iParam0->_fU4 = {uParam3};
        iParam0->_fU16 = uParam6;
        iParam0->_fU20 = uParam7;
        iParam0->_fU24 = uParam8;
        iParam0->_fU28 = GET_PED_HEALTH( uParam2 );
        iParam0->_fU56 = -1569615261;
        iParam0->_fU60 = -1569615261;
        iParam0->_fU64 = -1569615261;
        iParam0->_fU68 = -1569615261;
        iParam0->_fU72 = -1569615261;
        iParam0->_fU76 = 0;
        iParam0->_fU80 = 0;
        iParam0->_fU84 = 0;
        iParam0->_fU88 = 0;
        iParam0->_fU92 = 0;
        iVar12 = GET_WEAPON_FROM_HAND( uParam2, 0, 0 );
        iVar13 = GET_WEAPON_FROM_HAND( uParam2, 1, 0 );
        iVar14 = GET_WEAPON_FROM_HOLSTER( uParam2, 0 );
        iVar15 = GET_WEAPON_FROM_HOLSTER( uParam2, 1 );
        iVar16 = GET_WEAPON_FROM_HOLSTER( uParam2, 2 );
        if (GET_DOES_WEAPON_EXIST( iVar12 ))
        {
            iParam0->_fU68 = GET_WEAPON_TYPE( iVar12 );
            iParam0->_fU88 = (GET_WEAPON_AMMO( iVar12 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar12 ));
            sub_27949( iVar12, iParam0 + 120, iParam0 + 124 );
        }
        if (GET_DOES_WEAPON_EXIST( iVar13 ))
        {
            iParam0->_fU72 = GET_WEAPON_TYPE( iVar13 );
            iParam0->_fU92 = (GET_WEAPON_AMMO( iVar13 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar13 ));
            sub_27949( iVar13, iParam0 + 128, iParam0 + 132 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar13 ) ))
                {
                    iParam0->_fU92 = GET_WEAPON_AMMO_IN_CLIP( iVar12 );
                }
            }
        }
        if ((iVar14 != iVar13) AND ((iVar14 != iVar12) AND (GET_DOES_WEAPON_EXIST( iVar14 ))))
        {
            iParam0->_fU56 = GET_WEAPON_TYPE( iVar14 );
            iParam0->_fU76 = (GET_WEAPON_AMMO( iVar14 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar14 ));
            sub_27949( iVar14, iParam0 + 96, iParam0 + 100 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar14 ) ))
                {
                    iParam0->_fU76 = GET_WEAPON_AMMO_IN_CLIP( iVar14 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar13 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar13 ), GET_WEAPON_TYPE( iVar14 ) ))
                {
                    iParam0->_fU76 = GET_WEAPON_AMMO_IN_CLIP( iVar14 );
                }
            }
        }
        if ((iVar15 != iVar13) AND ((iVar15 != iVar12) AND (GET_DOES_WEAPON_EXIST( iVar15 ))))
        {
            iParam0->_fU60 = GET_WEAPON_TYPE( iVar15 );
            iParam0->_fU80 = (GET_WEAPON_AMMO( iVar15 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar15 ));
            sub_27949( iVar15, iParam0 + 104, iParam0 + 108 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar15 ) ))
                {
                    iParam0->_fU80 = GET_WEAPON_AMMO_IN_CLIP( iVar15 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar13 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar13 ), GET_WEAPON_TYPE( iVar15 ) ))
                {
                    iParam0->_fU80 = GET_WEAPON_AMMO_IN_CLIP( iVar15 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar14 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar14 ), GET_WEAPON_TYPE( iVar15 ) ))
                {
                    iParam0->_fU80 = GET_WEAPON_AMMO_IN_CLIP( iVar15 );
                }
            }
        }
        if ((iVar16 != iVar13) AND ((iVar16 != iVar12) AND (GET_DOES_WEAPON_EXIST( iVar16 ))))
        {
            iParam0->_fU64 = GET_WEAPON_TYPE( iVar16 );
            iParam0->_fU84 = (GET_WEAPON_AMMO( iVar16 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar16 ));
            sub_27949( iVar16, iParam0 + 112, iParam0 + 116 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar13 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar13 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar14 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar14 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar15 ))
            {
                if (sub_28181( GET_WEAPON_TYPE( iVar15 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
        }
        SAVE_PICKUPS();
        iParam0->_fU32 = GET_ADRENALINE_AMT();
        iParam0->_fU36 = GET_PAYNEKILLER_AMT();
        GET_TIME_OF_DAY( iParam0 + 40, iParam0 + 44 );
        iParam0->_fU140 = IS_TIME_OF_DAY_FROZEN();
        iParam0->_fU136 = GET_PED_SWEAT( uParam2 );
        if (iParam9 == 1)
        {
            if (IS_MAGDEMO() == 0)
            {
                ENABLE_CHECKPOINT_ICON();
            }
        }
        if (iParam1 >= 0)
        {
            sub_29739( iParam0 );
            iParam0->_fU0 = 1;
            if (IS_ARCADE_MODE_ACTIVE() == 0)
            {
                CHECKPOINT_STORAGE_SAVE( iParam0, l_U1, iParam0->_fU52 );
                REQUEST_SAVE();
            }
        }
        if (IS_ARCADE_MODE_ACTIVE())
        {
            UPDATE_ARCADE_CHECK_POINT( iParam0->_fU52 );
        }
    }
    else
    {
        SCRIPT_ASSERT( "Error: Player is dead while saving a checkpoint!!!", 0 );
    }
    sub_597( "GA", "Saving the player data for checkpoint - End", 0 );
    return;
}

void sub_27498(int iParam0)
{
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;
    unknown uVar20;
    unknown uVar21;
    unknown uVar22;
    unknown uVar23;
    unknown uVar24;
    unknown uVar25;
    unknown uVar26;
    unknown uVar27;
    unknown uVar28;
    unknown uVar29;
    unknown uVar30;
    unknown uVar31;
    unknown uVar32;
    unknown uVar33;
    unknown uVar34;
    unknown uVar35;

    if (iParam0 >= 0)
    {
        if (GET_NAME_OF_CURRENT_LEVEL( 64, ref uVar20 ))
        {
            uVar3 = sub_9215( ref uVar20 );
        }
        STRING_FORMAT( 64, ref uVar4, "M_{}_L_{}", 2, 513, uVar3, 513, iParam0 - 1 );
        sub_597( "TEH", "Ending context", 0 );
        sub_597( "TEH", "Ending context", 0 );
        END_CONTEXT( ref uVar4 );
    }
    return;
}

void sub_27949(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int I;

    for ( I = 0; I < 26; I++ )
    {
        CLEAR_BIT( uParam1, I );
        CLEAR_BIT( uParam2, I );
        if (IS_WEAPON_ATTACHMENT_ENABLED( uParam0, I ))
        {
            SET_BIT( uParam1, I );
            if (IS_WEAPON_ATTACHMENT_TOGGLED( uParam0, I ))
            {
                SET_BIT( uParam2, I );
            }
        }
    }
    return;
}

void sub_28181(int iParam0, int iParam1)
{
    int Result;

    Result = 0;
    if ((iParam0 == -612753081) || ((iParam0 == 68019059) || ((iParam0 == 456708483) || ((iParam0 == -862236369) || (iParam0 == 406496141)))))
    {
        if ((iParam1 == -612753081) || ((iParam1 == 68019059) || ((iParam1 == 456708483) || ((iParam1 == -862236369) || (iParam1 == 406496141)))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == 724901397) || ((iParam0 == 57534114) || ((iParam0 == 1308526797) || ((iParam0 == -1074756423) || (iParam0 == -1013714740)))))
    {
        if ((iParam1 == 724901397) || ((iParam1 == 57534114) || ((iParam1 == 1308526797) || ((iParam1 == -1074756423) || (iParam1 == -1013714740)))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == 514118749) || ((iParam0 == -184942895) || ((iParam0 == -168327769) || ((iParam0 == 1845102363) || (iParam0 == 434544317)))))
    {
        if ((iParam1 == 514118749) || ((iParam1 == -184942895) || ((iParam1 == -168327769) || ((iParam1 == 1845102363) || (iParam1 == 434544317)))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == -110877124) || (iParam0 == 319712764))
    {
        if ((iParam1 == -110877124) || (iParam1 == 319712764))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == -1464892298) || ((iParam0 == 1194438308) || ((iParam0 == -1404433099) || ((iParam0 == 1478009203) || ((iParam0 == -691403429) || (iParam0 == 1964270085))))))
    {
        if ((iParam1 == -1464892298) || ((iParam1 == 1194438308) || ((iParam1 == -1404433099) || ((iParam1 == 1478009203) || ((iParam1 == -691403429) || (iParam1 == 1964270085))))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == 10648147) || (iParam0 == 1224272620))
    {
        if ((iParam1 == 10648147) || (iParam1 == 1224272620))
        {
            Result = 1;
        }
    };;;;;;
    return Result;
}

void sub_29739(int iParam0)
{
    sub_3438( "CHECKPOINT DATA" );
    sub_29778( iParam0->_fU4 );
    sub_29801( iParam0->_fU16 );
    sub_29801( iParam0->_fU20 );
    sub_29801( iParam0->_fU24 );
    sub_29844( iParam0->_fU28 );
    sub_29844( iParam0->_fU56 );
    sub_29844( iParam0->_fU60 );
    sub_29844( iParam0->_fU64 );
    sub_29844( iParam0->_fU68 );
    sub_29844( iParam0->_fU72 );
    sub_29844( iParam0->_fU76 );
    sub_29844( iParam0->_fU80 );
    sub_29844( iParam0->_fU84 );
    sub_29844( iParam0->_fU88 );
    sub_29844( iParam0->_fU92 );
    sub_29801( iParam0->_fU32 );
    sub_29844( iParam0->_fU36 );
    sub_29844( iParam0->_fU40 );
    sub_29844( iParam0->_fU44 );
    sub_29801( iParam0->_fU136 );
    sub_30049( iParam0->_fU140 );
    sub_29844( iParam0->_fU52 );
    sub_3438( "---nRightHolsterAttachmentEnabled: " );
    sub_29844( iParam0->_fU96 );
    sub_3438( "---nRightHolsterAttachmentToggled: " );
    sub_29844( iParam0->_fU100 );
    sub_3438( "---nLeftHolsterAttachmentEnabled: " );
    sub_29844( iParam0->_fU104 );
    sub_3438( "---nLeftHolsterAttachmentToggled: " );
    sub_29844( iParam0->_fU108 );
    sub_3438( "---nRifleHolsterAttachmentEnabled: " );
    sub_29844( iParam0->_fU112 );
    sub_3438( "---nRifleHolsterAttachmentToggled: " );
    sub_29844( iParam0->_fU116 );
    sub_3438( "---nRightHandAttachmentEnabled: " );
    sub_29844( iParam0->_fU120 );
    sub_3438( "---nRightHandAttachmentToggled: " );
    sub_29844( iParam0->_fU124 );
    sub_3438( "---nLeftHandAttachmentEnabled: " );
    sub_29844( iParam0->_fU128 );
    sub_3438( "---nLeftHandAttachmentToggled: " );
    sub_29844( iParam0->_fU132 );
    sub_29844( l_U1 );
    sub_29844( 144 );
    return;
}

void sub_29778(unknown uParam0, unknown uParam1, unknown uParam2)
{
    return;
}

void sub_29801(unknown uParam0)
{
    return;
}

void sub_29844(unknown uParam0)
{
    return;
}

void sub_30049(boolean bParam0)
{
    if (bParam0)
    {
        ;
    }
    return;
}

void sub_30860(int iParam0)
{
    iParam0->_fU36 = 1;
    return;
}

void sub_31098()
{
    sub_597( "SP", "P_MPM_LIMIT_PLAYER_ACTIONS", 0 );
    if (((IS_PED_DEAD( sub_1036() )) == 0) AND ((IS_PLAYER_DEAD( sub_1058() )) == 0))
    {
        SET_PLAYER_CONTROL( sub_1058(), 0, 0 );
        REENABLE_PLAYER_INPUT( 4 );
        REENABLE_PLAYER_INPUT( 6 );
        REENABLE_PLAYER_INPUT( 14 );
        REENABLE_PLAYER_INPUT( 15 );
        REENABLE_PLAYER_INPUT( 16 );
        REENABLE_PLAYER_INPUT( 17 );
        REENABLE_PLAYER_INPUT( 10 );
        REENABLE_PLAYER_INPUT( 11 );
        REENABLE_PLAYER_INPUT( 12 );
        REENABLE_PLAYER_INPUT( 13 );
        REENABLE_PLAYER_INPUT( 13 );
    }
    return;
}

void sub_31455(boolean bParam0, boolean bParam1)
{
    SET_WIDESCREEN_BORDERS( 0, 500 );
    DISPLAY_HUD( 1 );
    if (NOT (IS_PED_DEAD( sub_1036() )))
    {
        SET_PLAYER_CONTROL( sub_1058(), 1, 0 );
        SET_PED_INVINCIBLE( sub_1036(), 0 );
        if (bParam0)
        {
            sub_31536();
        }
    }
    PULSE_CROSSHAIR( 1 );
    if (bParam1)
    {
        DESTROY_ALL_CAMS();
    }
    return;
}

void sub_31536()
{
    unknown uVar2;
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;

    if ((IS_PED_DEAD( sub_1036() )) == 0)
    {
        uVar2 = GET_WEAPON_FROM_HAND( sub_1036(), 0, 0 );
        uVar3 = GET_WEAPON_FROM_HAND( sub_1036(), 1, 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar2 )) == 1)
        {
            uVar4 = GET_MAX_AMMO_IN_HAND_CLIP_MP( sub_1036(), 0 );
            SET_WEAPON_AMMO_IN_CLIP( uVar2, uVar4 );
        }
        if ((GET_DOES_WEAPON_EXIST( uVar3 )) == 1)
        {
            uVar5 = GET_MAX_AMMO_IN_HAND_CLIP_MP( sub_1036(), 1 );
            SET_WEAPON_AMMO_IN_CLIP( uVar3, uVar5 );
        }
    }
    return;
}

void sub_32079(unknown uParam0)
{
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        STOP_PED_SPEAKING( uParam0, 1 );
        SET_PED_HEALTH( uParam0, 0, 0 );
        SET_PED_CORPSE( uParam0, 0 );
    }
    return;
}

void sub_32498(unknown uParam0, unknown uParam1)
{
    int iVar4;

    iVar4 = -1;
    if (sub_32515( uParam0, uParam1 ))
    {
        iVar4 = sub_32614( uParam0, uParam1 );
        if (NOT (iVar4 == -1))
        {
            STOP_SCRIPT_STREAM( iVar4 );
        }
        else
        {
            SCRIPT_ASSERT( "Attempting to stop a SCRIPT_STREAM asset slot that is NOT valid!!!", 0 );
        }
    }
    return;
}

int sub_32515(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam1^) - 1); I++ )
    {
        if ((uParam1^)[I]._fU32 == 3)
        {
            if (ARE_STRINGS_EQUAL( ref (uParam1^)[I]._fU0, uParam0 ))
            {
                return 1;
            }
        }
    }
    return 0;
}

int sub_32614(unknown uParam0, unknown uParam1)
{
    int Result;

    for ( Result = 0; Result <= ((uParam1^) - 1); Result++ )
    {
        if (ARE_STRINGS_EQUAL( ref (uParam1^)[Result]._fU0, uParam0 ))
        {
            return Result;
        }
    }
    return -1;
}

void sub_32827(unknown uParam0, unknown uParam1)
{
    int I;
    int iVar5;

    for ( I = 0; I <= ((uParam1^) - 1); I++ )
    {
        if (((uParam1^)[I]._fU32 == 1) || (((uParam1^)[I]._fU32 == 2) || ((uParam1^)[I]._fU32 == 3)))
        {
            if (ARE_STRINGS_EQUAL( ref (uParam1^)[I]._fU0, uParam0 ))
            {
                iVar5 = sub_8276( GET_ID_OF_THIS_THREAD(), ref (uParam1^)[I]._fU36 );
                if (iVar5 == -1)
                {
                    (uParam1^)[I]._fU32 = 4;
                    return;
                }
                else
                {
                    return;
                }
            }
        }
    }
    return;
}

void sub_33851()
{
    sub_597( "SP", "P_UNLOAD_ASSETS", 0 );
    sub_33899( g_U2129, ref g_U910 );
    sub_33899( g_U2130, ref g_U910 );
    sub_33899( g_U2132, ref g_U910 );
    sub_33899( g_U2133, ref g_U910 );
    sub_34165( ref g_U1928, ref g_U1369 );
    ISEQ_UNREGISTER_ENTITY( -1476959292, "gio" );
    ISEQ_UNREGISTER_ENTITY( -1476959292, "enemy" );
    ISEQ_TERMINATE( -1476959292 );
    sub_8164( -1476959292, ref g_U1272 );
    ISEQ_UNREGISTER_ENTITY( 689789076, "player" );
    ISEQ_TERMINATE( 689789076 );
    sub_8164( 689789076, ref g_U1272 );
    ISEQ_UNREGISTER_ENTITY( 1106596692, "gio" );
    ISEQ_UNREGISTER_ENTITY( 1106596692, "enemy" );
    ISEQ_TERMINATE( 1106596692 );
    sub_8164( 1106596692, ref g_U1272 );
    return;
}

void sub_33899(int iParam0, unknown uParam1)
{
    int I;
    int iVar5;

    if (IS_MODEL_IN_CDIMAGE( iParam0 ))
    {
        for ( I = 0; I <= ((uParam1^) - 1); I++ )
        {
            if (((uParam1^)[I]._fU4 == 1) || (((uParam1^)[I]._fU4 == 2) || ((uParam1^)[I]._fU4 == 3)))
            {
                if ((uParam1^)[I]._fU0 == iParam0)
                {
                    iVar5 = sub_8276( GET_ID_OF_THIS_THREAD(), ref (uParam1^)[I]._fU8 );
                    if (iVar5 == -1)
                    {
                        (uParam1^)[I]._fU4 = 4;
                        return;
                    }
                    else
                    {
                        return;
                    }
                }
            }
        }
    }
    else
    {
        SCRIPT_ASSERT( "The asset is NOT in the image!!!", 0 );
    }
    return;
}

void sub_34165(unknown uParam0, unknown uParam1)
{
    int I;
    int iVar5;

    for ( I = 0; I <= ((uParam1^) - 1); I++ )
    {
        if (((uParam1^)[I]._fU32 == 1) || (((uParam1^)[I]._fU32 == 2) || ((uParam1^)[I]._fU32 == 3)))
        {
            if (ARE_STRINGS_EQUAL( ref (uParam1^)[I]._fU0, uParam0 ))
            {
                iVar5 = sub_8276( GET_ID_OF_THIS_THREAD(), ref (uParam1^)[I]._fU36 );
                if (iVar5 == -1)
                {
                    (uParam1^)[I]._fU32 = 4;
                    return;
                }
                else
                {
                    return;
                }
            }
        }
    }
    return;
}

