void main()
{
    l_U0 = 1;
    l_U1 = 144;
    l_U2 = "PED_DEF";
    l_U44 = 1.00000000;
    l_U56 = 0;
    l_U97 = 0;
    l_U117 = 1;
    l_U118 = 1;
    l_U158 = 0;
    l_U170 = 0;
    l_U171 = 1;
    l_U172 = 0;
    l_U173 = 1.00000000;
    l_U174 = -5.00000000;
    l_U175 = 0;
    l_U176 = 0;
    l_U177 = 0;
    l_U181 = 42;
    l_U182 = 0;
    l_U183 = 0;
    l_U184 = 0;
    l_U185 = 0;
    l_U186 = 0;
    l_U187 = 90.00000000;
    l_U188 = {0.00000000, 0.00000000, 0.00000000};
    l_U191 = {0.00000000, 0.00000000, 0.00000000};
    l_U194 = 0;
    l_U195 = 0;
    l_U196 = 0;
    l_U197 = 0;
    l_U198 = 0;
    l_U199 = 0;
    l_U200 = nil;
    l_U201 = {0.00000000, 0.00000000, 0.00000000};
    l_U204 = 0;
    l_U205 = 0;
    l_U206 = 0;
    l_U258 = 0;
    l_U259 = 0;
    l_U260 = 1;
    l_U262 = 0;
    l_U263 = 0;
    l_U264 = 1500;
    l_U275 = 0;
    l_U279 = -1;
    l_U280 = {64536, 64536, 64536};
    l_U283 = {0, 0, 0};
    StrCopy( ref l_U286, "DUMMY", 32 );
    l_U294 = 1;
    l_U299 = 0;
    l_U300 = 0;
    l_U301 = 0;
    l_U304 = 0;
    l_U2107 = 1000;
    l_U2126 = 0;
    StrCopy( ref l_U2219, "SNYC_VIG14A", 64 );
    StrCopy( ref l_U2235, "SNYC_ABPB", 64 );
    StrCopy( ref l_U2251, "SNYC_VIG21A", 64 );
    StrCopy( ref l_U2267, "SNYC_VIG21B", 64 );
    l_U2595 = 1;
    l_U2596 = 0;
    l_U2597 = 1;
    l_U2598 = 0;
    l_U2600 = "mid_03_nybar_concat";
    l_U2633 = 0;
    StrCopy( ref l_U2704, "mid_03c_nybar_concat", 32 );
    l_U2744 = 0;
    l_U2855 = 0;
    l_U2856 = 0;
    l_U2857 = 0;
    l_U2870 = 0;
    l_U2871 = 0;
    l_U2872 = 0;
    l_U2882 = 0;
    l_U2883 = "LEVEL_S_NYBAR_CP_04";
    l_U2884 = "MID_03B_NYBAR_PT1_CAM";
    l_U2885 = "MID_03B_NYBAR_PT2_CAM";
    l_U2917 = 0;
     /* WRITESCRIPTLOG */ sub_803( "RJM", "Script s_nyc2_rooftops.sc is starting...", 0 );
    l_U275 = 0;
    if (g_U779 < 2)
    {
         /* LOAD_INITIAL_ROOFTOP_ASSETS */ sub_940( 0 );
    }
    else if ((g_U779 <= 3) AND (g_U779 >= 2))
    {
         /* LOAD_ALL_PRE_MPM_ROOFTOP_ASSETS */ sub_2196();
    }
    else if (g_U779 >= 4)
    {
         /* LOAD_POST_MPM_ASSETS */ sub_2576( 1 );
    };;;
    if (g_U779 <= 2)
    {
         /* P_LOAD_WEAPONS */ sub_2783( 2, 1 );
    }
    else
    {
         /* P_LOAD_WEAPONS */ sub_2783( 3, 1 );
    }
     /* DEBUG_ADD_WATERTOWER_WIDGETS */ sub_3185();
     /* SETUP_ROOFTOP_STATIC_DATA */ sub_3327();
     /* INITIALIZE_ROOFTOP_SCRIPT_DATA */ sub_9817();
     /* INITIALIZE_PLAYER_BY_DEBUG_MENU_CHECKPOINT */ sub_10650();
    START_WIDGET_GROUP( "PASSOS In-Flow Abandoned Building Run" );
     /* P_ADD_WIDGET_VECTOR_SLIDER */ sub_35891( ref g_U3425, "Vig 17 Start Position: ", 1036831949 );
    ADD_WIDGET_FLOAT_SLIDER( "Vig 17 Start Rotation: ", ref g_U3428, 65356, 180, 0.10000000 );
    STOP_WIDGET_GROUP();
    START_WIDGET_GROUP( "Tower Fall" );
     /* P_ADD_WIDGET_VECTOR_SLIDER */ sub_35891( ref g_U3425, "Vig 17 Start Position: ", 1036831949 );
    ADD_WIDGET_INT_SLIDER( "Tower Fall Cam Time", ref l_U2107, 0, 2000, l_U2107 );
    STOP_WIDGET_GROUP();
    while (NOT IS_EXITFLAG_SET())
    {
        if (g_U3437[9])
        {
            SET_EXITFLAG_FOR_SCRIPT( GET_ID_OF_THIS_THREAD() );
        }
        if ((g_U780 <= 6) AND (g_U780 >= 2))
        {
             /* P_HANDLE_MUSIC */ sub_36262();
        }
         /* HANDLE_CHECKPOINTS */ sub_39844();
         /* HANDLE_EVENTS */ sub_51417();
        WAIT( 0 );
    }
     /* WRITESCRIPTLOG */ sub_803( "RJM", "Script s_nyc2_rooftops.sc is starting to end", 0 );
     /* CLEANUP_ROOFTOP */ sub_48425();
     /* UNLOAD_SCRIPT_ASSETS */ sub_93855();
     /* P_UNLOAD_WEAPONS */ sub_94049( 2 );
    SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
     /* WRITESCRIPTLOG */ sub_803( "RJM", "Script s_nyc2_rooftops.sc is ending", 0 );
    SET_SCRIPT_AS_NO_LONGER_NEEDED( "s_nyc2_rooftops" );
    SET_EXITFLAG_RESPONSE();
    return;
}

/* WRITESCRIPTLOG */ void sub_803(unknown uParam0, unknown uParam1, string sParam2)
{
    unknown uVar5;

    if (IS_STRING_NULL( sParam2 ))
    {
        sParam2 = "###";
    }
    uVar5 = GET_REAL_GAME_TIMER();
    DISPLAYF( "[{0}][{1}]{3} {2} {3}", 4, 513, uVar5, 1537, uParam0, 1537, uParam1, 1537, sParam2 );
    return;
}

/* LOAD_INITIAL_ROOFTOP_ASSETS */ void sub_940(unknown uParam0)
{
     /* LOADMODEL */ sub_987( g_U3097, uParam0 );
     /* LOADMODEL */ sub_987( -859113524, uParam0 );
     /* LOADMODEL */ sub_987( 1740663406, 1 );
     /* LOADMODEL */ sub_987( g_U774, 1 );
     /* LOADMODEL */ sub_987( g_U777, 1 );
     /* LOADMODEL */ sub_987( g_U775, 1 );
     /* LOADANIMDICT */ sub_1344( "ny_anim", 0, 1 );
     /* LOADISEQ */ sub_1517( -329975025, uParam0 );
     /* LOADACTIONTREE */ sub_1836( "Vehicle/Vehicle_Car.act", 1 );
     /* SETUP_SCRIPTED_SPEECH */ sub_2000( "SNYCAUD" );
    return;
}

/* LOADMODEL */ void sub_987(unknown uParam0, boolean bParam1)
{
    if ((IS_MODEL_IN_CDIMAGE( uParam0 )) == 0)
    {
         /* WRITE_STRING */ sub_1104( "[SP]### ERROR! (LoadModel) Trying to load a model that isn't in the img! ###" );
    }
    REQUEST_MODEL( uParam0 );
    "[doubled result, dropped if not asigned]";
    if (bParam1)
    {
        while ((HAS_MODEL_LOADED( uParam0 )) == 0)
        {
            DISPLAYF( "[SP]### Waiting to load model: {!f1} : {1} ###", 2, 1, -874832622, 513, uParam0 );
            WAIT( 0 );
        }
    }
    return;
}

/* WRITE_STRING */ void sub_1104(unknown uParam0)
{
    PRINTSTRING( uParam0 );
    PRINTNL();
    return;
}

/* LOADANIMDICT */ void sub_1344(unknown uParam0, unknown uParam1, int iParam2)
{
    REQUEST_ANIM_DICT( uParam0, uParam1 );
    "[doubled result, dropped if not asigned]";
    if (iParam2 == 1)
    {
        while ((HAS_ANIM_DICT_LOADED( uParam0, uParam1 )) == 0)
        {
            DISPLAYF( "[SP]### Waiting for an animation dictionary to be loaded: {} ###", 1, 1537, uParam0 );
            WAIT( 0 );
        }
    }
    return;
}

/* LOADISEQ */ void sub_1517(unknown uParam0, int iParam1)
{
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;

    if ((ISEQ_DOES_EXIST( uParam0 )) == 0)
    {
        SCRIPT_ASSERT( "Error: The interactive sequence you are trying to load does not exist!!!!", 0 );
    }
    if ((ISEQ_IS_LOADED( uParam0 )) == 0)
    {
        ISEQ_REQUEST( uParam0 );
        ISEQ_GET_NAME( 32, ref uVar4, uParam0 );
        if (iParam1 == 1)
        {
            while ((ISEQ_QUERY_STATE( uParam0, 1 )) == 1)
            {
                DISPLAYF( "[SP]### Waiting for interactive sequence to be loaded: {0} {1} ###", 2, 1281, ref uVar4, 513, uParam0 );
                WAIT( 0 );
            }
        }
    }
    return;
}

/* LOADACTIONTREE */ void sub_1836(unknown uParam0, int iParam1)
{
    ACTION_TREE_LOAD( uParam0 );
    if (iParam1 == 1)
    {
        while ((IS_ACTION_TREE_LOADED( uParam0 )) == 0)
        {
            DISPLAYF( "[SP]### Waiting for an Action Tree to be loaded: {} ###", 1, 1537, uParam0 );
            WAIT( 0 );
        }
    }
    return;
}

/* SETUP_SCRIPTED_SPEECH */ void sub_2000(unknown uParam0)
{
    StrCopy( ref g_U157._fU0, uParam0, 16 );
     /* CLEARPEDCONVERSATIONDATA */ sub_2044();
    return;
}

/* CLEARPEDCONVERSATIONDATA */ void sub_2044()
{
    int I;

    for ( I = 0; I <= 8; I++ )
    {
        g_U157._fU16[I]._fU0 = nil;
        g_U157._fU16[I]._fU4 = 0;
        g_U157._fU92[I] = 0;
    }
    return;
}

/* LOAD_ALL_PRE_MPM_ROOFTOP_ASSETS */ void sub_2196()
{
     /* LOAD_INITIAL_ROOFTOP_ASSETS */ sub_940( 1 );
     /* LOAD_WATERTOWER_ASSETS */ sub_2247( 1 );
    return;
}

/* LOAD_WATERTOWER_ASSETS */ void sub_2247(unknown uParam0)
{
     /* LOADANIMDICT */ sub_1344( "ny_wtanim", 0, uParam0 );
     /* LOADMODEL */ sub_987( -1522991054, uParam0 );
     /* LOADMODEL */ sub_987( -1193498759, uParam0 );
     /* LOADMODEL */ sub_987( 588151771, uParam0 );
     /* LOADMODEL */ sub_987( 216303562, uParam0 );
     /* LOADMODEL */ sub_987( -946946919, uParam0 );
     /* LOADMODEL */ sub_987( -1915312722, uParam0 );
     /* LOADMODEL */ sub_987( -1549971141, uParam0 );
     /* LOADISEQ */ sub_1517( 1419096468, uParam0 );
     /* LOADISEQ */ sub_1517( 123489604, uParam0 );
     /* LOADISEQ */ sub_1517( -900483547, uParam0 );
     /* LOADISEQ */ sub_1517( -652127296, uParam0 );
     /* LOADISEQ */ sub_1517( 8102532, uParam0 );
     /* LOADISEQ */ sub_1517( -1131749617, uParam0 );
     /* LOADISEQ */ sub_1517( 2119011196, uParam0 );
     /* LOADISEQ */ sub_1517( -1930417983, uParam0 );
     /* LOADISEQ */ sub_1517( 361106065, uParam0 );
     /* LOADISEQ */ sub_1517( 1876730400, uParam0 );
     /* LOADISEQ */ sub_1517( 1423764005, uParam0 );
     /* LOADISEQ */ sub_1517( -361846818, uParam0 );
     /* LOADISEQ */ sub_1517( -787715329, uParam0 );
    return;
}

/* LOAD_POST_MPM_ASSETS */ void sub_2576(unknown uParam0)
{
     /* LOADMODEL */ sub_987( g_U3097, uParam0 );
     /* LOADMODEL */ sub_987( g_U3091, uParam0 );
     /* LOADMODEL */ sub_987( -1809963165, uParam0 );
     /* LOADANIMDICT */ sub_1344( "PAS_INT", 0, uParam0 );
     /* LOADISEQ */ sub_1517( -1202559929, uParam0 );
     /* LOADANIMDICT */ sub_1344( "FACE_PASNYB", 0, uParam0 );
     /* LOADACTIONTREE */ sub_1836( "LEVEL/S_NYBAR/S_NYBAR_PASSOS_FACIAL.act", uParam0 );
     /* SETUP_SCRIPTED_SPEECH */ sub_2000( "SNYCAUD" );
    return;
}

/* P_LOAD_WEAPONS */ void sub_2783(unknown uParam0, unknown uParam1)
{
     /* LOADWEAPON */ sub_2816( -862236369, 1 );
    switch (uParam0)
    {
        case 0:
        case 1:
        case 2:
         /* LOADWEAPON */ sub_2816( 434544317, uParam1 );
         /* LOADWEAPON */ sub_2816( -691403429, uParam1 );
        break;
        case 3:
        case 4:
        case 5:
        case 6:
         /* LOADWEAPON */ sub_2816( 434544317, uParam1 );
         /* LOADWEAPON */ sub_2816( -691403429, uParam1 );
         /* LOADWEAPON */ sub_2816( 1478009203, uParam1 );
         /* LOADWEAPON */ sub_2816( -1074756423, uParam1 );
        break;
        case 7:
        case 8:
         /* LOADWEAPON */ sub_2816( 434544317, uParam1 );
         /* LOADWEAPON */ sub_2816( -691403429, uParam1 );
         /* LOADWEAPON */ sub_2816( -1074756423, uParam1 );
        break;
    }
    return;
}

/* LOADWEAPON */ void sub_2816(unknown uParam0, boolean bParam1)
{
    REQUEST_WEAPON( uParam0 );
    if (bParam1)
    {
        while ((HAS_WEAPON_LOADED( uParam0 )) == 0)
        {
            DISPLAYF( "[SP]### Waiting to load weapon: {!f1} : {1} ###", 2, 1, 199730165, 513, uParam0 );
            WAIT( 0 );
        }
    }
    return;
}

/* DEBUG_ADD_WATERTOWER_WIDGETS */ void sub_3185()
{
    START_WIDGET_GROUP( "Water Tower tweaking" );
    ADD_WIDGET_FLOAT_SLIDER( "Water tower anim start phase", ref g_U3586, 0, 1.00000000, 0.00010000 );
    STOP_WIDGET_GROUP();
    return;
}

/* SETUP_ROOFTOP_STATIC_DATA */ void sub_3327()
{
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U529, "TRIG_WALK_MID02_AB", -365.70000000, -2.61000000, 6.09000000, 5.00000000, 5.00000000, 2.76000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U550, "TRIG_MID02_AB", -362.98000000, -2.65000000, 6.05000000, 1.75000000, 3.00000000, 3.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U571, "TRIG_LOCK_ROOF_DOOR", -365.62000000, 0.29000000, 2.61000000, 5.20000000, 10.10000000, 6.11000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U592, "TRIG_ROOF_REACTION", -361.59530000, -2.55377300, 6.25992800, 5.75000000, 3.25000000, 3.50000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U613, "TRIG_MIDSCENE_02C_DEATH", -288.58000000, -20.05000000, 1.32000000, 6.00000000, 14.44000000, 11.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U634, "TRIG_MIDSCENE_03", -292.89000000, -20.05000000, 1.32000000, 6.00000000, 14.44000000, 11.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U655, "TRIG_VIGNETTE_20", -243.94000000, -25.91000000, 5.04000000, 2.00000000, 3.50000000, 1.50000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U676, "TRIG_FLY_MY_PRETTIES_ROOF0", -335.86000000, -5.12000000, 3.71000000, 14.00000000, 16.50000000, 5.46000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U697, "TRIG_START_ROOF_TASKING", -324.05000000, -19.54000000, -4.16000000, 18.00000000, 10.00000000, 10.00000000, 0.00000000, 0.00000000, 90.16000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U718, "TRIG_UROOF1_CREATION", -324.05000000, -19.54000000, 2.26000000, 18.00000000, 10.00000000, 10.00000000, 0.00000000, 0.00000000, 90.16000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U739, "TRIG_END_WHOLE_APT_CONTEXT", -324.05000000, -19.54000000, 2.26000000, 18.00000000, 10.00000000, 10.00000000, 0.00000000, 0.00000000, 90.16000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U760, "TRIG_DISABLE_SHOOTDODGE", -296.06000000, -20.28000000, 6.94000000, 10.00000000, 15.00000000, 5.46000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1432, "TRIG_MAX_UP_STAIRS", -239.00000000, -26.33000000, 1.66000000, 3.00000000, 1.75000000, 5.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U781, "TRIG_ABANDON_FLOOR1_CREATION", -260.28000000, -9.79000000, -0.53000000, 25.00000000, 14.04000000, 7.00000000, 0.00000000, 0.00000000, -90.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U802, "TRIG_ABANDONED_CHECKPOINT", -251.86000000, -2.46000000, 2.00000000, 3.94000000, 4.03000000, 3.50000000, 0.00000000, 0.00000000, 15.01000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U823, "TRIG_PASSOS_FINISHED_VAULT", -255.86000000, -1.46000000, 0.00000000, 3.94000000, 12.00000000, 3.13000000, 0.00000000, 0.00000000, 0.01000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1012, "TRIG_MPM_FAILURE", -284.46000000, -1.74000000, 1.41000000, 9.46000000, 12.01000000, 1.70000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1033, "TRIG_MPM_FAILURE2", -290.78000000, -3.54000000, 2.97000000, 3.00000000, 13.00000000, 1.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1054, "TRIG_POST_MPM_LEDGE_UP", -277.73000000, -1.74000000, 1.43000000, 4.00000000, 18.00000000, 2.50000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1159, "PASSOS_MID_05A_DEATH", -239.74000000, -26.37000000, 3.99000000, 7.00000000, 1.80000000, 3.00000000, 0.00000000, 35.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1180, "PASSOS_MID_05B_DEATH", -240.58000000, -14.94000000, 1.24000000, 18.00000000, 14.00000000, 2.00000000, 0.00000000, 0.00000000, 90.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U844, "TRIG_ROOF_DEATHZONE1", -351.14000000, -12.55000000, -5.73000000, 65.65000000, 50.00000000, 10.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U865, "TRIG_ROOF_DEATHZONE2", -271.34000000, -12.55000000, -3.71000000, 94.59000000, 50.00000000, 5.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U886, "TRIG_ROOF_DEATHZONE3", -309.16000000, -6.15000000, -0.28000000, 40.00000000, 17.00000000, 6.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U907, "TRIG_ROOF_DEATHZONE4", -288.11000000, -19.58000000, -3.49000000, 40.00000000, 17.00000000, 6.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U928, "TRIG_ROOF_DEATHZONE5", -349.69000000, -12.48000000, -1.41000000, 40.00000000, 17.00000000, 6.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U949, "TRIG_ROOF_DEATHZONE6", -300.26000000, -7.16000000, 1.48000000, 20.00000000, 17.00000000, 6.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U970, "tbRoofDeathzone7", -351.59000000, -13.08000000, -0.03000000, 7.00000000, 20.00000000, 10.00000000, 0.00000000, 0.00000000, -90.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U991, "tbRoofDeathzone8", -349.39000000, -11.05000000, 3.96000000, 4.00000000, 4.00000000, 6.00000000, 0.00000000, 0.00000000, -90.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1453, "TRIG_PASSOS_ABNDN_YELL", -233.54000000, -19.88000000, 5.11000000, 1.75000000, 5.00000000, 1.40000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1474, "TRIG_ABDN_FLOOR2_TASK", -244.51000000, -25.91000000, 5.04000000, 2.00000000, 5.00000000, 2.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1495, "TRIG_ABDN_FLOOR2_TASK2", -239.57000000, -20.42000000, 4.90000000, 12.00000000, 6.00000000, 3.40000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1075, "PASSOS_MOVE_TO_ABDN", -260.28000000, -2.12000000, -0.53000000, 14.00000000, 20.00000000, 7.00000000, 0.00000000, 0.00000000, -90.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1096, "PASSOS_TASK_TOWARDS_ABDN", -282.14000000, -1.74000000, 1.41000000, 5.00000000, 12.01000000, 1.70000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1138, "TRIG_STREAMING_REQUEST", -365.94000000, -3.12000000, 2.60000000, 5.00000000, 5.00000000, 2.76000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1369, "PASSOS_ABANDON_FLOOR2_STAIRS_WARN", -236.98000000, -26.33000000, -1.80000000, 3.00000000, 1.75000000, 5.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1390, "PASSOS_ABANDON_FLOOR2_FE_WARN", -232.78000000, -17.80000000, 5.11000000, 2.60000000, 1.50000000, 2.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1411, "PASSOS_ABANDON_FLOOR2_FE_DEATH", -231.95000000, -21.98000000, 2.50000000, 1.50000000, 3.00000000, 3.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1117, "TRIG_TELEPORT_MAX_FLOOR2_MIDSCENE", -239.57000000, -24.48000000, 4.90000000, 12.00000000, 6.00000000, 3.40000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1201, "MID_06_FAILSAFE", -234.04000000, -20.20000000, 5.11000000, 1.75000000, 4.00000000, 1.40000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1222, "MID_06_FAILSAFE2", -221.14000000, -20.91000000, 4.95000000, 24.00000000, 30.00000000, 10.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1243, "MID_06_WalkTrigger", -233.15000000, -20.04000000, 5.11000000, 6.00000000, 6.50000000, 4.40000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1264, "MID_06_StartTrigger", -233.15000000, -20.04000000, 5.11000000, 1.00000000, 1.50000000, 1.40000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1327, "TRIG_ROOFTOP_COVER", -334.94000000, -14.70000000, 3.71000000, 12.00000000, 4.00000000, 5.46000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1348, "TASK_AB_FLOOR1_EXTRA", -240.58000000, -14.94000000, 1.24000000, 9.00000000, 14.00000000, 2.00000000, 0.00000000, 0.00000000, 90.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1516, "TRIG_FIRE_ESCAPE_DIVE_DEATH_1", -229.85000000, -19.23000000, 1.94000000, 3.00000000, 9.00000000, 5.01000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1537, "TRIG_FIRE_ESCAPE_DIVE_DEATH_2", -231.69000000, -25.23000000, 1.94000000, 4.00000000, 3.00000000, 5.01000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1285, "TRIG_CLEANUP_BY_ROOF_DOOR", -285.05000000, -3.60000000, 1.40000000, 1.50000000, 1.65000000, 2.50000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1306, "tbPreventHobokenDialogue", -300.28000000, -20.28000000, 6.58000000, 20.00000000, 15.00000000, 5.46000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1587, "TRIG_CHOPSHOP_SCRIPT_LOAD", -233.57000000, -20.12000000, 4.90000000, 5.50000000, 7.00000000, 3.40000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETRIGGERBOX */ sub_3438( ref l_U1566, "TRIG_CHOPSHOP_SCRIPT_PRELOAD", -239.95000000, -26.23000000, 1.99000000, 8.00000000, 3.00000000, 5.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1558, "TETH_MPM", -287.00420000, -1.05960100, 0.00000000, 6.00000000, 4.00000000, 6.00000000, 0.00000000, 0.00000000, -90.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1559, "TETH_APT_ROOF", -351.80000000, -13.08000000, 6.00000000, 30.00000000, 43.00000000, 4.00000000, 0.00000000, 0.00000000, -90.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1563, "TETH_ROOF_ADVANCE", -309.50000000, -21.37000000, 3.88000000, 17.50000000, 14.00000000, 5.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1564, "TETH_ROOF_ADVANCE2", -296.18000000, -21.36000000, 6.29000000, 8.82000000, 7.76000000, 5.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1565, "TETH_ROOF_IN_COVER", -321.35000000, -21.37000000, 3.28000000, 9.00000000, 12.00000000, 5.00000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1560, "TETH_ABANDON_FLOOR1_FRONT", -239.52000000, -12.72000000, 1.35000000, 5.00000000, 4.00000000, 1.50000000, 0.00000000, 0.00000000, -15.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1561, "TETH_ABANDON_FLOOR1_BACK", -239.46000000, -20.14000000, 1.34000000, 11.00000000, 8.00000000, 1.49000000, 0.00000000, 0.00000000, 0.00000000, 1 );
     /* P_CREATETETHERBOX */ sub_7705( ref l_U1562, "TETH_ABANDON_FLOOR2_GROUP3", -240.66000000, -12.01000000, 4.93000000, 15.00000000, 15.00000000, 1.40000000, 0.00000000, 0.00000000, 90.15000000, 1 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1609[0], -346.33600000, -6.72100000, 6.33000000, 65446, 1236259418, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1609[1], -345.53800000, -6.11800000, 6.33000000, 135, 1322463443, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1609[2], -344.90400000, -6.81100000, 6.33000000, 90, 2031544278, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1673[0], -333.45540000, -24.73068000, 6.32011800, 0, 951389475, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1809[0], -330.68000000, -15.50000000, 6.31000000, -90.78000000, 494399252, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1695[0], -302.48310000, -16.69737000, 6.51252000, 180, 732399117, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1695[1], -302.42990000, -17.61116000, 6.64468100, 180, 105659276, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1695[2], -302.36640000, -25.81591000, 6.77241500, 0, 1236259418, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1695[3], -302.37000000, -24.73000000, 6.77000000, 0, 1322463443, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1759[0], -319.70500000, -18.58575000, 4.79393600, 90, 951389475, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1759[1], -320.17010000, -24.16053000, 4.99139200, 90, -518261513, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1759[2], -312.62000000, -23.35000000, 5.70000000, 0.00000000, -842821795, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2127[0], -287.76710000, -2.73186000, 1.45000000, 176.36000000, -1969074258, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2127[1], -287.75360000, -0.79111000, 1.45000000, 176.77000000, 951389475, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2127[2], -287.75360000, -0.79111000, 1.45000000, 171.43000000, -1491110017, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2127[3], -285.46100000, -0.32396000, 1.45000000, -175.12000000, 11941526, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2127[4], -285.58760000, -2.71476000, 1.45000000, 177.93000000, 2031544278, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2127[5], -282.12000000, 3.13000000, 1.50000000, 90, 2104411633, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1831[0], -242.06000000, -17.65000000, 1.71000000, -17.81000000, 596270676, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1831[1], -241.31000000, -17.65000000, 1.71000000, -17.81000000, -363321782, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1867[0], -244.54000000, -17.52000000, 1.71000000, -157.89000000, -518261513, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1867[1], -244.89000000, -16.39000000, 1.71000000, -151.39000000, 357988079, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1903[0], -243.91000000, -25.61000000, 1.77000000, 0, 59494386, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1903[1], -240.01000000, -26.31000000, 4.52000000, 65446, 844547771, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1939[0], -235.50000000, -15.13000000, 5.11000000, -174.96000000, 629269026, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1939[1], -236.58000000, -15.12000000, 5.11000000, 171.93000000, -88915421, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1939[2], -243.30000000, -15.27000000, 5.11000000, 164.88000000, 293821277, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U1939[3], -244.04000000, -15.07000000, 5.11000000, 164.88000000, 1692162125, 7, 3, 2, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2005, g_U781[3]._fU0, g_U781[3]._fU12, -1756913695, 26, 6, 0, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2018, g_U781[5]._fU0, g_U781[5]._fU12, -1756913695, 26, 6, 0, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2031, g_U781[6]._fU0, g_U781[6]._fU12, -1756913695, 26, 6, 0, 0, 0 );
    return;
}

/* P_CREATETRIGGERBOX */ void sub_3438(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11)
{
    StrCopy( ref iParam0->_fU0, uParam1, 64 );
    iParam0->_fU64 = 0;
    iParam0->_fU68 = 0;
    iParam0->_fU72 = {uParam2};
    GAMEPLAY_HELPER_BOX_ANGLED_CREATE( 1, iParam0 + 0, uParam2, uParam5, uParam6, uParam7, uParam8, uParam11 );
    return;
}

/* P_CREATETETHERBOX */ void sub_7705(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11)
{
    iParam0->_fU0 = uParam1;
    GAMEPLAY_HELPER_BOX_ANGLED_CREATE( 2, iParam0->_fU0, uParam2, uParam5, uParam6, uParam7, uParam8, uParam11 );
    return;
}

/* P_CREATEPEDSTRUCTWITHNAME */ void sub_8380(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10)
{
    iParam0->_fU0 = {uParam1};
    iParam0->_fU20 = uParam5;
    iParam0->_fU12 = uParam4;
    iParam0->_fU24 = uParam6;
    iParam0->_fU28 = uParam7;
    iParam0->_fU36 = uParam8;
    iParam0->_fU32 = uParam9;
    iParam0->_fU44 = 0;
    iParam0->_fU16 = GET_SCENE_PED_MODEL( uParam5 );
    iParam0->_fU48 = uParam10;
    return;
}

/* INITIALIZE_ROOFTOP_SCRIPT_DATA */ void sub_9817()
{
    l_U2853 = 0;
    l_U2854 = 0;
    l_U2858 = 0;
    l_U2855 = 0;
    l_U2856 = 0;
    l_U2857 = 0;
    l_U2303 = 0;
    l_U2304 = 0;
    l_U2003 = 0;
    l_U2004 = 0;
    l_U1659[0] = 0;
    l_U1659[1] = 0;
    l_U1659[2] = 0;
    l_U1663 = 0;
    l_U2594 = 0;
    l_U2533 = 0;
    l_U2126 = 0;
    l_U2283 = 0;
    l_U2284 = 0;
    l_U2285 = 0;
    l_U2286 = 0;
    l_U2287 = 0;
    l_U2288 = 0;
    l_U2289 = 0;
    l_U2290 = 0;
    l_U2291 = 0;
    l_U2292 = 0;
    l_U2294 = 0;
    l_U2293 = 0;
    l_U2295 = 0;
    l_U2296 = 0;
    l_U2297 = 0;
    l_U2298 = 0;
    l_U2299 = 0;
    l_U2300 = 0;
    l_U2859 = 2;
    l_U2301 = 0;
    l_U2302 = 0;
    STOP_SCRIPT_STREAM( 0 );
     /* LOADSCRIPTSTREAM */ sub_10133( "S_NYC_TOWER_MPM_SUCCESS", 0, 1 );
     /* CREATETIMER */ sub_10316( ref l_U2305, 15000, 1, 0 );
     /* CREATETIMER */ sub_10316( ref l_U2314, 5000, 1, 0 );
    l_U2870 = 0;
    l_U2871 = 0;
    l_U2872 = 0;
    l_U2882 = 0;
     /* CREATETIMER */ sub_10316( ref l_U2873, 1000, 1, 0 );
     /* RESETTIMER */ sub_10518( ref l_U2350 );
    return;
}

/* LOADSCRIPTSTREAM */ void sub_10133(unknown uParam0, unknown uParam1, int iParam2)
{
    if (iParam2 == 0)
    {
        REQUEST_SCRIPT_STREAM( uParam0, uParam1 );
    }
    else
    {
        while ((LOAD_SCRIPT_STREAM( uParam0, uParam1 )) == 0)
        {
            DISPLAYF( "[SP]### Waiting for script stream to be loaded: {} : {} ###", 2, 1537, uParam0, 513, uParam1 );
            WAIT( 0 );
        }
    }
    return;
}

/* CREATETIMER */ void sub_10316(int iParam0, unknown uParam1, boolean bParam2, int iParam3)
{
    if (bParam2)
    {
        iParam0->_fU0 = TIMERA();
    }
    else
    {
        iParam0->_fU0 = TIMERB();
    }
    if (iParam3 == 1)
    {
        iParam0->_fU0 = TIMERSYSTEM();
    }
    iParam0->_fU4 = iParam0->_fU0;
    iParam0->_fU12 = uParam1;
    iParam0->_fU16 = 0;
    iParam0->_fU20 = 0;
    iParam0->_fU24 = 0;
    iParam0->_fU28 = bParam2;
    iParam0->_fU32 = iParam3;
    iParam0->_fU8 = 0;
    return;
}

/* RESETTIMER */ void sub_10518(int iParam0)
{
    if (iParam0->_fU28)
    {
        iParam0->_fU0 = TIMERA();
    }
    else
    {
        iParam0->_fU0 = TIMERB();
    }
    if (iParam0->_fU32 == 1)
    {
        iParam0->_fU0 = TIMERSYSTEM();
    }
    iParam0->_fU4 = iParam0->_fU0;
    iParam0->_fU16 = 0;
    iParam0->_fU20 = 0;
    iParam0->_fU24 = 0;
    return;
}

/* INITIALIZE_PLAYER_BY_DEBUG_MENU_CHECKPOINT */ void sub_10650()
{
    if ((g_U779 == 6) || ((g_U779 == 5) || ((g_U779 == 4) || ((g_U779 == 3) || (g_U779 == 2)))))
    {
         /* SET_WEATHER_AND_TIME_OF_DAY_FOR_NYBAR */ sub_10751( 2, 0 );
        SET_SCRIPT_CONTROL_RESET_ON_PLAYER_DEATH( 1 );
        if (NOT ( /* HAS_SAVEFILE_LOADED */ sub_11231( ref l_U349 )))
        {
             /* F_GIVEPEDWEAPON */ sub_13920(  /* PLAYER_PED_ID */ sub_11378(), -691403429, 200, 0, 1 );
        }
        g_U780 = g_U779;
    }
    if (g_U779 == 2)
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "INITIALIZE_PLAYER_BY_CHECKPOINT says we're in MCE_ROOFTOPS", 0 );
        l_U2595 = 2;
         /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U349, 2,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[2]._fU0, g_U3141[2]._fU12, g_U3141[2]._fU16, g_U3141[2]._fU20, 0 );
         /* CREATE_ROOFTOP_ENEMIES_AND_PASSOS */ sub_20738();
         /* P_CREATE_GRILL */ sub_26362();
         /* CREATE_TOWER_FOR_ROOFTOPS */ sub_27924( 1 );
        SET_TRAFFIC_SYSTEM( 1 );
         /* LOADSEAMLESSCUTSCENE */ sub_29445( l_U2600, 1 );
         /* P_CLOSEDOOR */ sub_29790( ref g_U2860, 1 );
         /* P_SETDOORLOCKED */ sub_30047( ref g_U2860, 1 );
        l_U2853 = 2;
    }
    else if (g_U779 == 3)
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "INITIALIZE_PLAYER_BY_CHECKPOINT says we're in MCE_ROOFTOPS_MPM", 0 );
         /* TELEPORTPED */ sub_30319(  /* PLAYER_PED_ID */ sub_11378(), g_U3141[3]._fU0, g_U3141[3]._fU12 );
        FREEZE_PED_POSITION(  /* PLAYER_PED_ID */ sub_11378(), 1 );
         /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U385, 3,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[3]._fU0, g_U3141[3]._fU12, g_U3141[3]._fU16, g_U3141[3]._fU20, 0 );
         /* CREATE_TOWER_FOR_ROOFTOPS */ sub_27924( 1 );
        SET_TRAFFIC_SYSTEM( 1 );
        WAIT( 1000 );
        l_U2595 = 3;
         /* LOADSEAMLESSCUTSCENE */ sub_29445( ref l_U2704, 1 );
        l_U2853 = 9;
        l_U2854 = 1;
    }
    else if (g_U779 == 4)
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "INITIALIZE_PLAYER_BY_CHECKPOINT says we're in MCE_ROOFTOPS_MPM", 0 );
         /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U421, 4,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[4]._fU0, g_U3141[4]._fU12, g_U3141[4]._fU16, g_U3141[4]._fU20, 0 );
         /* CREATE_PASSOS_ROOFTOP_MPM */ sub_30663();
         /* LOADISEQ */ sub_1517( -1236175571, 1 );
         /* CREATE_DESTROYED_TOWER */ sub_31193();
        l_U2595 = 4;
        SET_TRAFFIC_SYSTEM( 1 );
        WAIT( 1000 );
        l_U2595 = 4;
        l_U2853 = 10;
    }
    else if (g_U779 == 5)
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "INITIALIZE_PLAYER_BY_CHECKPOINT says we're in MCE_ABANDONED_BUILDING", 0 );
         /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U457, 5,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[5]._fU0, g_U3141[5]._fU12, g_U3141[5]._fU16, g_U3141[5]._fU20, 0 );
        START_CONTEXT( "NYBAR_ABANDONED_BUILDING" );
         /* CREATE_PASSOS_ABANDONED_BUILDING */ sub_31552();
         /* CREATE_ABANDONED_FLOOR1 */ sub_31828();
         /* LOADISEQ */ sub_1517( -223586764, 1 );
         /* LOADISEQ */ sub_1517( 1103749565, 1 );
         /* LOADISEQ */ sub_1517( -1222535398, 1 );
        SET_TRAFFIC_SYSTEM( 0 );
        l_U2853 = 12;
        SET_GAMEPLAY_CAM_RELATIVE_HEADING( g_U3141[5]._fU16, 1065353216, 0 );
        SET_GAMEPLAY_CAM_RELATIVE_PITCH( g_U3141[5]._fU20, 1065353216, 0 );
        l_U2291 = 1;
         /* CLEANUP_ROOFTOP_ASSETS_FOR_ABANDONED_BUILDING */ sub_33922();
         /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2561, 4000 );
        l_U2595 = 5;
         /* P_FADE_IN_AND_WAIT */ sub_34870( 1000 );
    }
    else if (g_U779 == 6)
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "INITIALIZE_PLAYER_BY_CHECKPOINT says we're in MCE_ABANDONED_BUILDING_2", 0 );
         /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U493, 6,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[6]._fU0, g_U3141[6]._fU12, g_U3141[6]._fU16, g_U3141[6]._fU20, 0 );
         /* CREATE_PASSOS_ABANDONED_BUILDING_2 */ sub_35183();
         /* LOADISEQ */ sub_1517( -223586764, 1 );
         /* LOADISEQ */ sub_1517( 637400269, 1 );
         /* LOADISEQ */ sub_1517( 1103749565, 1 );
        SET_TRAFFIC_SYSTEM( 0 );
         /* CLEANUP_ROOFTOP_ASSETS_FOR_ABANDONED_BUILDING */ sub_33922();
        l_U2595 = 6;
        if ((IS_SCREEN_FADING_OUT()) || (IS_SCREEN_FADED_OUT()))
        {
            DO_SCREEN_FADE_IN( 500 );
        }
        l_U2003 = 1;
        l_U2853 = 14;
        l_U2291 = 1;
    };;;;;
    return;
}

/* SET_WEATHER_AND_TIME_OF_DAY_FOR_NYBAR */ void sub_10751(unknown uParam0, unknown uParam1)
{
     /* WRITESCRIPTLOG */ sub_803( "BSW", "SET_WEATHER_AND_TIME_OF_DAY_FOR_NYBAR start...", 0 );
    PRINTSTRING( "Setting weather for checkpoint: " );
    PRINTINT( uParam0 );
    PRINTNL();
    SET_WEATHER_TRANSITION_IMMEDIATE( uParam1 );
    switch (uParam0)
    {
        case 0:
        case 1:
        case 20:
        case 30:
        SET_TIME_OF_DAY( 12, 0 );
        FREEZE_TIME_OF_DAY( 12, 0 );
        SET_WEATHER_TYPE_NOW_PERSIST( "CLOUDY" );
        break;
        case 7:
        SET_TIME_OF_DAY( 18, 0 );
        FREEZE_TIME_OF_DAY( 18, 0 );
        SET_WEATHER_TYPE_NOW_PERSIST( "CLOUDY" );
        break;
        case 2:
        case 3:
        case 4:
        case 5:
        case 6:
        case 8:
        case 21:
        case 22:
        case 24:
        SET_TIME_OF_DAY( 18, 0 );
        FREEZE_TIME_OF_DAY( 18, 0 );
        SET_WEATHER_TYPE_NOW_PERSIST( "SNOW_LIGHT" );
        break;
        default:
        SET_TIME_OF_DAY( 12, 0 );
        FREEZE_TIME_OF_DAY( 12, 0 );
        SET_WEATHER_TYPE_NOW_PERSIST( "CLOUDY" );
        break;
    }
    return;
}

/* HAS_SAVEFILE_LOADED */ int sub_11231(unknown uParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "rw", "HAS_SAVEFILE_LOADED()", 0 );
    if (IS_ARCADE_MODE_ACTIVE())
    {
        return 0;
    }
    if (HAS_LOAD_JUST_OCCURRED())
    {
        if ((GET_CHECKPOINT_SELECTED() == 1) || (GET_CHECKPOINT_SELECTED() == 0))
        {
            return 0;
        }
        else
        {
            l_U0 = 0;
            CHECKPOINT_STORAGE_LOAD( uParam0, l_U1 );
             /* P_RESTORE_PLAYER_DATA_CHECKPOINT */ sub_11472( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
        }
        if (IS_IN_STORY_MODE())
        {
            START_CONTEXT( "LEVEL" );
        }
        return 1;
    }
    return 0;
}

/* PLAYER_PED_ID */ int sub_11378()
{
    if (DOES_MAIN_PLAYER_EXIST())
    {
        return GET_PLAYER_PED(  /* PLAYER_ID */ sub_11416() );
    }
    return 0;
}

/* PLAYER_ID */ void sub_11416()
{
    return GET_PLAYER_ID();
}

/* P_RESTORE_PLAYER_DATA_CHECKPOINT */ void sub_11472(int iParam0, unknown uParam1)
{
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    int iVar9;
    int iVar10;
    int iVar11;
    unknown uVar12;
    unknown uVar13;

     /* WRITESCRIPTLOG */ sub_803( "GA", "Restoring the player to the checkpoint - Start", 0 );
    if (l_U0)
    {
        INCREMENT_CHECKPOINT_ATTEMPT();
    }
    g_U648 = 0;
    if (iParam0->_fU0 == 0)
    {
        SCRIPT_ASSERT( "ERROR: Trying to restore a checkpoint that hasn't been saved!!!", 0 );
    }
     /* CLOSE_CURRENT_LEVEL_CONTEXT */ sub_11691( iParam0->_fU52 );
    if (SCRIPT_VAR_EXISTS( "SV_LOAD_CNT" ))
    {
        SCRIPT_VAR_SET_INT( "SV_LOAD_CNT", (SCRIPT_VAR_GET_INT( "SV_LOAD_CNT" )) + 1 );
    }
    else
    {
        SCRIPT_VAR_ADD_INT( "SV_LOAD_CNT" );
        SCRIPT_VAR_SET_INT( "SV_LOAD_CNT", 1 );
    }
    CLEAR_KILL_STREAK_RECORDS();
    AUDIO_MUSIC_SUSPEND( 0 );
    DEACTIVATE_BULLET_TIME( 1, 0 );
    ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 1, 0 );
    REMOVE_ALL_ENVIRONMENT_BLOOD();
    RESET_BLOOD_EFFECTS();
    REMOVE_ALL_GLINTS();
    RESET_DESTROYED_COVER();
    RESET_ALL_PTFX();
    uVar4 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( uParam1 )};
    CLEAR_AREA( iParam0->_fU4, 10000.00000000, 1 );
    if (NOT (IS_PED_DEAD( uParam1 )))
    {
        SET_PED_COORDS( uParam1, iParam0->_fU4, 1 );
         /* LOADCOLLISIONFORPED */ sub_12855( uParam1 );
        SET_PED_HEADING( uParam1, iParam0->_fU16 );
    }
    CLEAR_AREA( uVar4, 3.00000000, 1 );
    LOAD_SCENE( iParam0->_fU4 );
    SET_GAMEPLAY_CAM_RELATIVE_HEADING( 0.00000000, 1065353216, 0 );
    iParam0->_fU28 = GET_PED_MAX_HEALTH( uParam1 );
    SET_PED_HEALTH( uParam1, iParam0->_fU28, 0 );
    RESET_PED_GORE( uParam1 );
    RESET_PED_VISIBLE_DAMAGE( uParam1 );
    REMOVE_ALL_PED_WEAPONS( uParam1 );
    if (NOT (iParam0->_fU56 == -1569615261))
    {
        uVar7 =  /* F_GIVEPEDWEAPONTOHOLSTER */ sub_13169( uParam1, iParam0->_fU56, 0, iParam0->_fU76, 1 );
         /* P_RESTORE_WEAPON_ATTACHMENTS */ sub_13604( uVar7, iParam0 + 96, iParam0 + 100 );
    }
    if (NOT (iParam0->_fU60 == -1569615261))
    {
        uVar7 =  /* F_GIVEPEDWEAPONTOHOLSTER */ sub_13169( uParam1, iParam0->_fU60, 1, iParam0->_fU80, 1 );
         /* P_RESTORE_WEAPON_ATTACHMENTS */ sub_13604( uVar7, iParam0 + 104, iParam0 + 108 );
    }
    if (NOT (iParam0->_fU64 == -1569615261))
    {
        uVar7 =  /* F_GIVEPEDWEAPONTOHOLSTER */ sub_13169( uParam1, iParam0->_fU64, 2, iParam0->_fU84, 1 );
         /* P_RESTORE_WEAPON_ATTACHMENTS */ sub_13604( uVar7, iParam0 + 112, iParam0 + 116 );
    }
    if (NOT (iParam0->_fU68 == -1569615261))
    {
        uVar7 =  /* F_GIVEPEDWEAPON */ sub_13920( uParam1, iParam0->_fU68, iParam0->_fU88, 0, 1 );
         /* P_RESTORE_WEAPON_ATTACHMENTS */ sub_13604( uVar7, iParam0 + 120, iParam0 + 124 );
    }
    if (NOT (iParam0->_fU72 == -1569615261))
    {
        uVar7 =  /* F_GIVEPEDWEAPON */ sub_13920( uParam1, iParam0->_fU72, iParam0->_fU92, 1, 1 );
         /* P_RESTORE_WEAPON_ATTACHMENTS */ sub_13604( uVar7, iParam0 + 128, iParam0 + 132 );
    }
    if (l_U0 == 1)
    {
        if ((IS_PED_DEAD( uParam1 )) == 0)
        {
            if (iParam0->_fU68 != -1569615261)
            {
                uVar7 = GET_WEAPON_FROM_HAND( uParam1, 0, 0 );
                if ((GET_DOES_WEAPON_EXIST( uVar7 )) == 1)
                {
                    uVar8 = GET_WEAPON_TYPE( uVar7 );
                    if (( /* F_CAN_GIVE_AMMO_TO_REGULAR_WEAPON_TYPE */ sub_14492( uVar8 )) == 1)
                    {
                        iVar9 = GET_MAX_AMMO_IN_HAND_CLIP_MP( uParam1, 0 );
                        iVar10 = iParam0->_fU88;
                        if (iVar10 < iVar9)
                        {
                            iVar11 = iVar9 - iVar10;
                            ADD_AMMO_TO_PED( uParam1, uVar8, iVar11, 0 );
                            SET_WEAPON_AMMO_IN_CLIP( uVar7, iVar9 );
                        }
                    }
                }
            }
        }
    }
     /* START_NEW_LEVEL_CONTEXT */ sub_14694( iParam0->_fU52 );
    SET_ADRENALINE_AMT( iParam0->_fU32 );
    if (GET_ADRENALINE_AMT() < 0.20000000)
    {
        SET_ADRENALINE_AMT( 0.20000000 );
    }
    SET_PAYNEKILLER_AMT( iParam0->_fU36 );
    SET_PED_DUCKING(  /* PLAYER_PED_ID */ sub_11378(), 0 );
    GET_TIME_OF_DAY( ref uVar12, ref uVar13 );
    if (iParam0->_fU140 == 1)
    {
        FREEZE_TIME_OF_DAY( iParam0->_fU40, iParam0->_fU44 );
    }
    else
    {
        RELEASE_TIME_OF_DAY();
        SET_TIME_OF_DAY( iParam0->_fU40, iParam0->_fU44 );
    }
    SET_PED_SWEAT( uParam1, iParam0->_fU136, -1.00000000 );
    RESTORE_PICKUPS();
    SET_GAMEPLAY_CAM_RELATIVE_HEADING( iParam0->_fU20, 1065353216, 0 );
    SET_GAMEPLAY_CAM_RELATIVE_PITCH( iParam0->_fU24, 1065353216, 0 );
    HANDLE_CHECKPOINT_RESTART();
    if (l_U0)
    {
        ADJUST_AMMO_ATTEMPTS();
        ADJUST_PAIN_KILLERS_ATTEMPTS();
    }
    l_U0 = 1;
    DISPLAY_HUD( 1 );
    if (IS_DEATH_PANEL_WIPE_ALLOWED())
    {
        if (IS_BULLET_CAMERA_WIPE_STOPPED())
        {
            RESUME_BULLET_CAMERA_WIPE_ON_FADEIN();
        }
    }
     /* WRITESCRIPTLOG */ sub_803( "GA", "Restoring the player to the checkpoint - End", 0 );
    return;
}

/* CLOSE_CURRENT_LEVEL_CONTEXT */ void sub_11691(unknown uParam0)
{
    int iVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;
    unknown uVar20;
    unknown uVar21;
    unknown uVar22;
    unknown uVar23;
    unknown uVar24;
    unknown uVar25;
    unknown uVar26;
    unknown uVar27;
    unknown uVar28;
    unknown uVar29;
    unknown uVar30;
    unknown uVar31;
    unknown uVar32;
    unknown uVar33;
    unknown uVar34;
    unknown uVar35;

    iVar3 = 0;
    if (GET_NAME_OF_CURRENT_LEVEL( 64, ref uVar20 ))
    {
        iVar3 =  /* GET_MISSION_INDEX_FROM_NAME */ sub_11753( ref uVar20 );
    }
    STRING_FORMAT( 64, ref uVar4, "M_{}_L_{}", 2, 513, iVar3, 513, uParam0 );
    END_CONTEXT( ref uVar4 );
    return;
}

/* GET_MISSION_INDEX_FROM_NAME */ int sub_11753(unknown uParam0)
{
    if (ARE_STRINGS_EQUAL( uParam0, "s_air" ))
    {
        return 21;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_beach" ))
    {
        return 22;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_boat" ))
    {
        return 10;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_booze" ))
    {
        return 0;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_busdep" ))
    {
        return 17;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_cemet" ))
    {
        return 15;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_club" ))
    {
        return 5;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_clubride" ))
    {
        return 4;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fashion" ))
    {
        return 3;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fav0" ))
    {
        return 13;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fav1" ))
    {
        return 14;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fav2" ))
    {
        return 16;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_fire" ))
    {
        return 12;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_hotel" ))
    {
        return 19;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_intro" ))
    {
        return 1;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_marina" ))
    {
        return 9;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_nyc" ))
    {
        return 7;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_nyc2" ))
    {
        return 8;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_office" ))
    {
        return 11;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_pana" ))
    {
        return 18;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_police" ))
    {
        return 20;
    }
    else if (ARE_STRINGS_EQUAL( uParam0, "s_stad" ))
    {
        return 6;
    }
    else
    {
        PRINTSTRING( uParam0 );
        PRINTSTRING( uParam0 );
        PRINTSTRING( uParam0 );
    };;;;;;;;;;;;;;;;;;;;;;
    return 99;
}

/* LOADCOLLISIONFORPED */ void sub_12855(unknown uParam0)
{
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;

    if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
    {
        uVar3 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( uParam0 )};
        SET_LOAD_COLLISION_FOR_PED_FLAG( uParam0, 1 );
        SET_PED_COORDS_NO_OFFSET( uParam0, uVar3 );
        FREEZE_PED_POSITION( uParam0, 1 );
        REQUEST_COLLISION_AT_COORD( uVar3 );
        if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
        {
            FREEZE_PED_POSITION( uParam0, 0 );
        }
    }
    return;
}

/* F_GIVEPEDWEAPONTOHOLSTER */ void sub_13169(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, int iParam4)
{
    unknown Result;

    if ((HAS_WEAPON_LOADED( uParam1 )) == 0)
    {
        SCRIPT_ASSERT( "The weapon model you are giving to the ped's holster MUST BE PRELOADED!!!!", 0 );
    }
    Result = nil;
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        Result = GIVE_WEAPON_TO_PED_HOLSTER( uParam0, uParam1, uParam3, uParam2 );
        if (iParam4 == 1)
        {
            Result = GET_WEAPON_FROM_HOLSTER( uParam0, uParam2 );
            while (NOT (GET_DOES_WEAPON_EXIST( Result )))
            {
                WAIT( 0 );
                if ((IS_PED_DEAD( uParam0 )) == 0)
                {
                    Result = GET_WEAPON_FROM_HOLSTER( uParam0, uParam2 );
                    DISPLAYF( "[SP]### Waiting for a weapon to exist: {} ###", 1, 513, uParam1 );
                }
            }
        }
    }
    else
    {
         /* WRITE_STRING */ sub_1104( "[SP]### (F_GivePedWeaponToHolster) Error: Trying to give a dead ped a weapon. ###" );
    }
    return Result;
}

/* P_RESTORE_WEAPON_ATTACHMENTS */ void sub_13604(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int I;

    for ( I = 0; I < 26; I++ )
    {
        if (IS_BIT_SET( (uParam1^), I ))
        {
            ENABLE_WEAPON_ATTACHMENT( uParam0, I, 1 );
            TOGGLE_WEAPON_ATTACHMENT( uParam0, I, IS_BIT_SET( (uParam2^), I ) );
        }
        else
        {
            ENABLE_WEAPON_ATTACHMENT( uParam0, I, 0 );
            TOGGLE_WEAPON_ATTACHMENT( uParam0, I, 0 );
        }
    }
    return;
}

/* F_GIVEPEDWEAPON */ void sub_13920(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, int iParam4)
{
    unknown Result;

    if ((HAS_WEAPON_LOADED( uParam1 )) == 0)
    {
        SCRIPT_ASSERT( "The weapon model you are giving to the ped's hand MUST BE PRELOADED!!!!", 0 );
    }
    Result = nil;
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        Result = GIVE_WEAPON_TO_PED_HAND( uParam0, uParam1, uParam2, uParam3 );
        if (iParam4 == 1)
        {
            Result = GET_WEAPON_FROM_HAND( uParam0, uParam3, 0 );
            while (NOT (GET_DOES_WEAPON_EXIST( Result )))
            {
                WAIT( 0 );
                if ((IS_PED_DEAD( uParam0 )) == 0)
                {
                    Result = GET_WEAPON_FROM_HAND( uParam0, uParam3, 0 );
                    DISPLAYF( "[SP]### Waiting for a weapon to exist: {} ###", 1, 513, uParam1 );
                }
            }
        }
    }
    else
    {
         /* WRITE_STRING */ sub_1104( "[SP]### (F_GivePedWeapon) Error: Trying to give a dead ped a weapon. ###" );
    }
    return Result;
}

/* F_CAN_GIVE_AMMO_TO_REGULAR_WEAPON_TYPE */ int sub_14492(unknown uParam0)
{
    int iVar3;

    iVar3 = GET_WEAPONTYPE_AMMO( uParam0 );
    if ((iVar3 == -1383321053) || ((iVar3 == -1295933220) || ((iVar3 == 1138793073) || (iVar3 == -1088031219))))
    {
        return 1;
    }
    return 0;
}

/* START_NEW_LEVEL_CONTEXT */ void sub_14694(unknown uParam0)
{
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;
    unknown uVar20;
    unknown uVar21;
    unknown uVar22;
    unknown uVar23;
    unknown uVar24;
    unknown uVar25;
    unknown uVar26;
    unknown uVar27;
    unknown uVar28;
    unknown uVar29;
    unknown uVar30;
    unknown uVar31;
    unknown uVar32;
    unknown uVar33;
    unknown uVar34;
    unknown uVar35;

    if (GET_NAME_OF_CURRENT_LEVEL( 64, ref uVar20 ))
    {
        uVar3 =  /* GET_MISSION_INDEX_FROM_NAME */ sub_11753( ref uVar20 );
    }
    STRING_FORMAT( 64, ref uVar4, "M_{}_L_{}", 2, 513, uVar3, 513, uParam0 );
     /* CLEAR_GG_CONTEXTS */ sub_14792( uVar3 );
    START_CONTEXT( ref uVar4 );
    return;
}

/* CLEAR_GG_CONTEXTS */ void sub_14792(int iParam0)
{
    if (iParam0 != 3)
    {
        END_CONTEXT( "S_FAS_GG_PT" );
    }
    if (iParam0 != 5)
    {
        END_CONTEXT( "S_CLB_GG_M3" );
        END_CONTEXT( "S_CLB_MS" );
    }
    if (iParam0 != 6)
    {
        END_CONTEXT( "S_STA_GG_M1" );
        END_CONTEXT( "S_STA_GG_M81" );
    }
    if (iParam0 != 7)
    {
        END_CONTEXT( "S_NY1_GG_19" );
    }
    if (iParam0 != 8)
    {
        END_CONTEXT( "S_NY2_GG_40" );
        END_CONTEXT( "S_NY2_GG_M5" );
    }
    if (iParam0 != 9)
    {
        END_CONTEXT( "S_MAR_GG_LM" );
        END_CONTEXT( "S_MAR_GG_9M" );
    }
    if (iParam0 != 11)
    {
        END_CONTEXT( "S_OFF_GG_MD" );
    }
    if (iParam0 != 14)
    {
        END_CONTEXT( "S_FV1_GG_SP" );
        END_CONTEXT( "S_FV1_GG_SA" );
    }
    if (iParam0 != 15)
    {
        END_CONTEXT( "S_NYC_GG_6M" );
        END_CONTEXT( "S_NYC_GG_A9" );
    }
    if (iParam0 != 16)
    {
        END_CONTEXT( "S_FV2_GG_D5" );
        END_CONTEXT( "S_FV2_GG_97" );
    }
    if (iParam0 != 17)
    {
        END_CONTEXT( "S_BUS_GG_M4" );
        END_CONTEXT( "S_BUS_GG_FN" );
    }
    if (iParam0 != 18)
    {
        END_CONTEXT( "S_PAN_GG_AK" );
        END_CONTEXT( "S_PAN_GG_SS" );
    }
    if (iParam0 != 19)
    {
        END_CONTEXT( "S_HOT_GG_G3" );
        END_CONTEXT( "S_HOT_GG_LA" );
    }
    if (iParam0 != 20)
    {
        END_CONTEXT( "S_POL_GG_G6" );
        END_CONTEXT( "S_POL_GG_RP" );
        END_CONTEXT( "S_POL_GG_MP" );
    }
    if (iParam0 != 21)
    {
        END_CONTEXT( "S_AIR_GG_RG" );
        END_CONTEXT( "S_AIR_GG_PD" );
    }
    return;
}

/* P_SAVE_PLAYER_DATA_CHECKPOINT */ void sub_16140(int iParam0, int iParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, int iParam9)
{
    int iVar12;
    int iVar13;
    int iVar14;
    int iVar15;
    int iVar16;

     /* WRITESCRIPTLOG */ sub_803( "GA", "Saving the player data for checkpoint - Start", 0 );
    if ((IS_PED_DEAD( uParam2 )) == 0)
    {
         /* WRITESCRIPTLOG */ sub_803( "SP", "Saving to scripted data...", 0 );
        RESET_CHECKPOINT_ATTEMPTS();
        if (SCRIPT_VAR_EXISTS( "SV_SAVE_CNT" ))
        {
            SCRIPT_VAR_SET_INT( "SV_SAVE_CNT", (SCRIPT_VAR_GET_INT( "SV_SAVE_CNT" )) + 1 );
        }
        else
        {
            SCRIPT_VAR_ADD_INT( "SV_SAVE_CNT" );
            SCRIPT_VAR_SET_INT( "SV_SAVE_CNT", 1 );
        }
         /* START_NEW_LEVEL_CONTEXT */ sub_14694( iParam1 );
         /* CLOSE_OLD_LEVEL_CONTEXT */ sub_16431( iParam1 );
        iParam0->_fU52 = iParam1;
        iParam0->_fU4 = {uParam3};
        iParam0->_fU16 = uParam6;
        iParam0->_fU20 = uParam7;
        iParam0->_fU24 = uParam8;
        iParam0->_fU28 = GET_PED_HEALTH( uParam2 );
        iParam0->_fU56 = -1569615261;
        iParam0->_fU60 = -1569615261;
        iParam0->_fU64 = -1569615261;
        iParam0->_fU68 = -1569615261;
        iParam0->_fU72 = -1569615261;
        iParam0->_fU76 = 0;
        iParam0->_fU80 = 0;
        iParam0->_fU84 = 0;
        iParam0->_fU88 = 0;
        iParam0->_fU92 = 0;
        iVar12 = GET_WEAPON_FROM_HAND( uParam2, 0, 0 );
        iVar13 = GET_WEAPON_FROM_HAND( uParam2, 1, 0 );
        iVar14 = GET_WEAPON_FROM_HOLSTER( uParam2, 0 );
        iVar15 = GET_WEAPON_FROM_HOLSTER( uParam2, 1 );
        iVar16 = GET_WEAPON_FROM_HOLSTER( uParam2, 2 );
        if (GET_DOES_WEAPON_EXIST( iVar12 ))
        {
            iParam0->_fU68 = GET_WEAPON_TYPE( iVar12 );
            iParam0->_fU88 = (GET_WEAPON_AMMO( iVar12 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar12 ));
             /* P_SAVE_WEAPON_ATTACHMENTS */ sub_16908( iVar12, iParam0 + 120, iParam0 + 124 );
        }
        if (GET_DOES_WEAPON_EXIST( iVar13 ))
        {
            iParam0->_fU72 = GET_WEAPON_TYPE( iVar13 );
            iParam0->_fU92 = (GET_WEAPON_AMMO( iVar13 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar13 ));
             /* P_SAVE_WEAPON_ATTACHMENTS */ sub_16908( iVar13, iParam0 + 128, iParam0 + 132 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar13 ) ))
                {
                    iParam0->_fU92 = GET_WEAPON_AMMO_IN_CLIP( iVar12 );
                }
            }
        }
        if ((iVar14 != iVar13) AND ((iVar14 != iVar12) AND (GET_DOES_WEAPON_EXIST( iVar14 ))))
        {
            iParam0->_fU56 = GET_WEAPON_TYPE( iVar14 );
            iParam0->_fU76 = (GET_WEAPON_AMMO( iVar14 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar14 ));
             /* P_SAVE_WEAPON_ATTACHMENTS */ sub_16908( iVar14, iParam0 + 96, iParam0 + 100 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar14 ) ))
                {
                    iParam0->_fU76 = GET_WEAPON_AMMO_IN_CLIP( iVar14 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar13 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar13 ), GET_WEAPON_TYPE( iVar14 ) ))
                {
                    iParam0->_fU76 = GET_WEAPON_AMMO_IN_CLIP( iVar14 );
                }
            }
        }
        if ((iVar15 != iVar13) AND ((iVar15 != iVar12) AND (GET_DOES_WEAPON_EXIST( iVar15 ))))
        {
            iParam0->_fU60 = GET_WEAPON_TYPE( iVar15 );
            iParam0->_fU80 = (GET_WEAPON_AMMO( iVar15 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar15 ));
             /* P_SAVE_WEAPON_ATTACHMENTS */ sub_16908( iVar15, iParam0 + 104, iParam0 + 108 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar15 ) ))
                {
                    iParam0->_fU80 = GET_WEAPON_AMMO_IN_CLIP( iVar15 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar13 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar13 ), GET_WEAPON_TYPE( iVar15 ) ))
                {
                    iParam0->_fU80 = GET_WEAPON_AMMO_IN_CLIP( iVar15 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar14 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar14 ), GET_WEAPON_TYPE( iVar15 ) ))
                {
                    iParam0->_fU80 = GET_WEAPON_AMMO_IN_CLIP( iVar15 );
                }
            }
        }
        if ((iVar16 != iVar13) AND ((iVar16 != iVar12) AND (GET_DOES_WEAPON_EXIST( iVar16 ))))
        {
            iParam0->_fU64 = GET_WEAPON_TYPE( iVar16 );
            iParam0->_fU84 = (GET_WEAPON_AMMO( iVar16 )) + (GET_WEAPON_AMMO_IN_CLIP( iVar16 ));
             /* P_SAVE_WEAPON_ATTACHMENTS */ sub_16908( iVar16, iParam0 + 112, iParam0 + 116 );
            if (GET_DOES_WEAPON_EXIST( iVar12 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar12 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar13 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar13 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar14 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar14 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
            if (GET_DOES_WEAPON_EXIST( iVar15 ))
            {
                if ( /* F_WEAPONS_SAME_AMMO */ sub_17168( GET_WEAPON_TYPE( iVar15 ), GET_WEAPON_TYPE( iVar16 ) ))
                {
                    iParam0->_fU84 = GET_WEAPON_AMMO_IN_CLIP( iVar16 );
                }
            }
        }
        SAVE_PICKUPS();
        iParam0->_fU32 = GET_ADRENALINE_AMT();
        iParam0->_fU36 = GET_PAYNEKILLER_AMT();
        GET_TIME_OF_DAY( iParam0 + 40, iParam0 + 44 );
        iParam0->_fU140 = IS_TIME_OF_DAY_FROZEN();
        iParam0->_fU136 = GET_PED_SWEAT( uParam2 );
        if (iParam9 == 1)
        {
            if (IS_MAGDEMO() == 0)
            {
                ENABLE_CHECKPOINT_ICON();
            }
        }
        if (iParam1 >= 0)
        {
             /* P_PRINT_CHECKPOINT_DATA */ sub_18748( iParam0 );
            iParam0->_fU0 = 1;
            if (IS_ARCADE_MODE_ACTIVE() == 0)
            {
                CHECKPOINT_STORAGE_SAVE( iParam0, l_U1, iParam0->_fU52 );
                REQUEST_SAVE();
            }
        }
        if (IS_ARCADE_MODE_ACTIVE())
        {
            UPDATE_ARCADE_CHECK_POINT( iParam0->_fU52 );
        }
    }
    else
    {
        SCRIPT_ASSERT( "Error: Player is dead while saving a checkpoint!!!", 0 );
    }
     /* WRITESCRIPTLOG */ sub_803( "GA", "Saving the player data for checkpoint - End", 0 );
    return;
}

/* CLOSE_OLD_LEVEL_CONTEXT */ void sub_16431(int iParam0)
{
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;
    unknown uVar20;
    unknown uVar21;
    unknown uVar22;
    unknown uVar23;
    unknown uVar24;
    unknown uVar25;
    unknown uVar26;
    unknown uVar27;
    unknown uVar28;
    unknown uVar29;
    unknown uVar30;
    unknown uVar31;
    unknown uVar32;
    unknown uVar33;
    unknown uVar34;
    unknown uVar35;

    if (iParam0 >= 0)
    {
        if (GET_NAME_OF_CURRENT_LEVEL( 64, ref uVar20 ))
        {
            uVar3 =  /* GET_MISSION_INDEX_FROM_NAME */ sub_11753( ref uVar20 );
        }
        STRING_FORMAT( 64, ref uVar4, "M_{}_L_{}", 2, 513, uVar3, 513, iParam0 - 1 );
         /* WRITESCRIPTLOG */ sub_803( "TEH", "Ending context", 0 );
         /* WRITESCRIPTLOG */ sub_803( "TEH", "Ending context", 0 );
        END_CONTEXT( ref uVar4 );
    }
    return;
}

/* P_SAVE_WEAPON_ATTACHMENTS */ void sub_16908(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int I;

    for ( I = 0; I < 26; I++ )
    {
        CLEAR_BIT( uParam1, I );
        CLEAR_BIT( uParam2, I );
        if (IS_WEAPON_ATTACHMENT_ENABLED( uParam0, I ))
        {
            SET_BIT( uParam1, I );
            if (IS_WEAPON_ATTACHMENT_TOGGLED( uParam0, I ))
            {
                SET_BIT( uParam2, I );
            }
        }
    }
    return;
}

/* F_WEAPONS_SAME_AMMO */ void sub_17168(int iParam0, int iParam1)
{
    int Result;

    Result = 0;
    if ((iParam0 == -612753081) || ((iParam0 == 68019059) || ((iParam0 == 456708483) || ((iParam0 == -862236369) || (iParam0 == 406496141)))))
    {
        if ((iParam1 == -612753081) || ((iParam1 == 68019059) || ((iParam1 == 456708483) || ((iParam1 == -862236369) || (iParam1 == 406496141)))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == 724901397) || ((iParam0 == 57534114) || ((iParam0 == 1308526797) || ((iParam0 == -1074756423) || (iParam0 == -1013714740)))))
    {
        if ((iParam1 == 724901397) || ((iParam1 == 57534114) || ((iParam1 == 1308526797) || ((iParam1 == -1074756423) || (iParam1 == -1013714740)))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == 514118749) || ((iParam0 == -184942895) || ((iParam0 == -168327769) || ((iParam0 == 1845102363) || (iParam0 == 434544317)))))
    {
        if ((iParam1 == 514118749) || ((iParam1 == -184942895) || ((iParam1 == -168327769) || ((iParam1 == 1845102363) || (iParam1 == 434544317)))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == -110877124) || (iParam0 == 319712764))
    {
        if ((iParam1 == -110877124) || (iParam1 == 319712764))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == -1464892298) || ((iParam0 == 1194438308) || ((iParam0 == -1404433099) || ((iParam0 == 1478009203) || ((iParam0 == -691403429) || (iParam0 == 1964270085))))))
    {
        if ((iParam1 == -1464892298) || ((iParam1 == 1194438308) || ((iParam1 == -1404433099) || ((iParam1 == 1478009203) || ((iParam1 == -691403429) || (iParam1 == 1964270085))))))
        {
            Result = 1;
        }
    }
    else if ((iParam0 == 10648147) || (iParam0 == 1224272620))
    {
        if ((iParam1 == 10648147) || (iParam1 == 1224272620))
        {
            Result = 1;
        }
    };;;;;;
    return Result;
}

/* P_PRINT_CHECKPOINT_DATA */ void sub_18748(int iParam0)
{
     /* WRITE_STRING */ sub_1104( "CHECKPOINT DATA" );
    PRINTSTRING( "---Position: " );
     /* WRITE_VECTOR */ sub_18836( iParam0->_fU4 );
    PRINTSTRING( "---Heading: " );
     /* WRITE_FLOAT */ sub_18913( iParam0->_fU16 );
    PRINTSTRING( "---fRelativeGameCamHeading: " );
     /* WRITE_FLOAT */ sub_18913( iParam0->_fU20 );
    PRINTSTRING( "---fRelativeGameCamPitch: " );
     /* WRITE_FLOAT */ sub_18913( iParam0->_fU24 );
    PRINTSTRING( "---nHealth: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU28 );
    PRINTSTRING( "---wtRightHolster: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU56 );
    PRINTSTRING( "---wtLeftHolster: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU60 );
    PRINTSTRING( "---wtRifleHolster: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU64 );
    PRINTSTRING( "---wtRightHand: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU68 );
    PRINTSTRING( "---wtLeftHand: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU72 );
    PRINTSTRING( "---nWeaponRightHolsterAmmo: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU76 );
    PRINTSTRING( "---nWeaponLeftHolsterAmmo: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU80 );
    PRINTSTRING( "---nWeaponRifleHolsterAmmo: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU84 );
    PRINTSTRING( "---nWeaponRightHandAmmo: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU88 );
    PRINTSTRING( "---nWeaponLeftHandAmmo: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU92 );
    PRINTSTRING( "---fAdrenaline: " );
     /* WRITE_FLOAT */ sub_18913( iParam0->_fU32 );
    PRINTSTRING( "---nPayneKillers: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU36 );
    PRINTSTRING( "---nHour: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU40 );
    PRINTSTRING( "---nMinute: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU44 );
    PRINTSTRING( "---fSweatAmount: " );
     /* WRITE_FLOAT */ sub_18913( iParam0->_fU136 );
    PRINTSTRING( "---bTimeFrozen: " );
     /* WRITE_BOOL */ sub_19783( iParam0->_fU140 );
    PRINTSTRING( "---checkpointIndex: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU52 );
     /* WRITE_STRING */ sub_1104( "---nRightHolsterAttachmentEnabled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU96 );
     /* WRITE_STRING */ sub_1104( "---nRightHolsterAttachmentToggled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU100 );
     /* WRITE_STRING */ sub_1104( "---nLeftHolsterAttachmentEnabled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU104 );
     /* WRITE_STRING */ sub_1104( "---nLeftHolsterAttachmentToggled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU108 );
     /* WRITE_STRING */ sub_1104( "---nRifleHolsterAttachmentEnabled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU112 );
     /* WRITE_STRING */ sub_1104( "---nRifleHolsterAttachmentToggled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU116 );
     /* WRITE_STRING */ sub_1104( "---nRightHandAttachmentEnabled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU120 );
     /* WRITE_STRING */ sub_1104( "---nRightHandAttachmentToggled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU124 );
     /* WRITE_STRING */ sub_1104( "---nLeftHandAttachmentEnabled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU128 );
     /* WRITE_STRING */ sub_1104( "---nLeftHandAttachmentToggled: " );
     /* WRITE_INT */ sub_19082( iParam0->_fU132 );
    PRINTSTRING( "[CHECKPOINT DATA SIZE]: " );
     /* WRITE_INT */ sub_19082( l_U1 );
    PRINTSTRING( "[CHECKPOINT DATA REF SIZE]: " );
     /* WRITE_INT */ sub_19082( 144 );
    return;
}

/* WRITE_VECTOR */ void sub_18836(unknown uParam0, unknown uParam1, unknown uParam2)
{
    PRINTVECTOR( uParam0 );
    PRINTNL();
    return;
}

/* WRITE_FLOAT */ void sub_18913(unknown uParam0)
{
    PRINTFLOAT( uParam0 );
    PRINTNL();
    return;
}

/* WRITE_INT */ void sub_19082(unknown uParam0)
{
    PRINTINT( uParam0 );
    PRINTNL();
    return;
}

/* WRITE_BOOL */ void sub_19783(boolean bParam0)
{
    if (bParam0)
    {
        PRINTSTRING( "TRUE" );
    }
    else
    {
        PRINTSTRING( "FALSE" );
    }
    PRINTNL();
    return;
}

/* CREATE_ROOFTOP_ENEMIES_AND_PASSOS */ void sub_20738()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_ROOFTOP_ENEMIES_AND_PASSOS - Start", 0 );
    SET_PED_MODEL_LOD_DISTANCES( 233534649, 25.00000000, 100.00000000 );
     /* CREATE_FIRST_ENCOUNTER_ROOF_GUYS */ sub_20862();
     /* PED_ARRAY_INITIALIZE */ sub_21317( ref l_U1809, ref l_U1823, ref l_U1825, -691403429, 0.50000000, "AIT_NORMAL", 0, 0, 25000, 2, 0, 25000, 0 );
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1823, l_U1559, 1 );
     /* P_DEACTIVATEPEDARRAY */ sub_24818( ref l_U1823 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1823, "APT_ROOF_" );
     /* CREATE_ROOFTOP_ADVANCE */ sub_25110();
     /* CREATE_COVER_ROOF_GUYS */ sub_25628();
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_ROOFTOP_ENEMIES_AND_PASSOS - end", 0 );
    return;
}

/* CREATE_FIRST_ENCOUNTER_ROOF_GUYS */ void sub_20862()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "CREATE_FIRST_ENCOUNTER_ROOF_GUYS", "***" );
     /* WRITESCRIPTLOG */ sub_803( "SBA", "CREATE_FIRST_ENCOUNTER_ROOF_GUYS: Creating patrolers", "***" );
     /* SETALLWEAPONPACKAGES */ sub_21043( -862236369, 0, 25000, 25000 );
     /* SETWEAPONPACKAGES */ sub_21164( 1, 434544317, 0, 25000, 25000 );
     /* PED_ARRAY_INITIALIZE */ sub_21317( ref l_U1609, ref l_U1649, ref l_U1653, 0, 1.00000000, "AIT_NORMAL", 0, 0, 25000, 4, 0, 25000, "ROOF_PATROL " );
     /* F_GIVEPEDWEAPON */ sub_13920( l_U1649[0], -862236369, 25000, 0, 0 );
     /* F_GIVEPEDWEAPON */ sub_13920( l_U1649[1], 434544317, 25000, 0, 0 );
     /* F_GIVEPEDWEAPON */ sub_13920( l_U1649[2], -862236369, 25000, 0, 0 );
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1649, l_U1559, 1 );
     /* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24346( ref l_U1649, 1 );
     /* LOADISEQ */ sub_1517( -329975025, 1 );
    ISEQ_REGISTER_ENTITY( -329975025, "thug0", l_U1649[0], 0 );
    ISEQ_REGISTER_ENTITY( -329975025, "thug1", l_U1649[1], 0 );
    ISEQ_REGISTER_ENTITY( -329975025, "thug2", l_U1649[2], 0 );
    ISEQ_START( -329975025 );
     /* WRITESCRIPTLOG */ sub_803( "SBA", "CREATE_FIRST_ENCOUNTER_ROOF_GUYS: Creating right side guys", "***" );
     /* PED_ARRAY_INITIALIZE */ sub_21317( ref l_U1673, ref l_U1687, ref l_U1689, -862236369, 0.50000000, "AIT_NORMAL", 0, 0, 25000, 2, 0, 25000, 0 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1687, "ROOF_RIGHT_" );
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1687, l_U1559, 1 );
     /* P_DEACTIVATEPEDARRAY */ sub_24818( ref l_U1687 );
    return;
}

/* SETALLWEAPONPACKAGES */ void sub_21043(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3)
{
    int I;

    for ( I = 0; I < 10; I++ )
    {
        l_U3[I]._fU0 = uParam0;
        l_U3[I]._fU4 = uParam2;
        l_U3[I]._fU8 = uParam1;
        l_U3[I]._fU12 = uParam3;
    }
    return;
}

/* SETWEAPONPACKAGES */ int sub_21164(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4)
{
    if (iParam0 < 10)
    {
        l_U3[iParam0]._fU0 = uParam1;
        l_U3[iParam0]._fU4 = uParam3;
        l_U3[iParam0]._fU8 = uParam2;
        l_U3[iParam0]._fU12 = uParam4;
        return 1;
    }
    return 0;
}

/* PED_ARRAY_INITIALIZE */ void sub_21317(unknown uParam0, unknown uParam1, unknown uParam2, int iParam3, unknown uParam4, unknown uParam5, boolean bParam6, unknown uParam7, unknown uParam8, unknown uParam9, int iParam10, unknown uParam11, unknown uParam12)
{
    int I;
    unknown uVar16;

    if ((uParam0^) != (uParam1^))
    {
        SCRIPT_ASSERT( "PED_ARRAY_INITIALIZE - Array sizes don't match!!", 0 );
        return;
    }
     /* P_SETUP_AI_GROUP */ sub_21429( uParam2, uParam4, 0 );
    if (IS_STRING_NULL( uParam12 ))
    {
        uParam12 = l_U2;
    }
    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* CLEANPED */ sub_21861( (uParam1^)[I] );
        (uParam1^)[I] =  /* CREATEPED */ sub_21953( ref (uParam0^)[I] );
        if ( /* IS_PED_VALID */ sub_22677( (uParam1^)[I] ))
        {
            SET_PED_AI_TEMPLATE( (uParam1^)[I], uParam5 );
            SET_PED_ALERTNESS( (uParam1^)[I], uParam9 );
            SET_PED_ALLOWED_TO_SURRENDER( (uParam1^)[I], 0 );
             /* P_QUICK_ADD_PED_TO_GROUP */ sub_22806( (uParam1^)[I], uParam2 );
            if (iParam3 != -1569615261)
            {
                uVar16 =  /* F_GIVEPEDWEAPON */ sub_13920( (uParam1^)[I], iParam3, uParam8, 0, 0 );
            }
            if (iParam10 != 0)
            {
                 /* F_GIVEPEDWEAPONTOHOLSTER */ sub_13169( (uParam1^)[I], iParam10, 0, uParam11, 0 );
            }
            if (bParam6)
            {
                 /* PED_SET_ENGAGEMENT_RANGES */ sub_23272( (uParam1^)[I], iParam3 );
            }
            switch (uParam7)
            {
                case 0: break;
                case 1:
                ENABLE_WEAPON_ATTACHMENT( uVar16, 13, 1 );
                TOGGLE_WEAPON_ATTACHMENT( uVar16, 13, 1 );
                break;
                case 2:
                ENABLE_WEAPON_ATTACHMENT( uVar16, 14, 1 );
                TOGGLE_WEAPON_ATTACHMENT( uVar16, 14, 1 );
                break;
                case 3:
                ENABLE_WEAPON_ATTACHMENT( uVar16, 12, 1 );
                TOGGLE_WEAPON_ATTACHMENT( uVar16, 12, 1 );
                break;
            }
        }
    }
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( uParam1, uParam12 );
    return;
}

/* P_SETUP_AI_GROUP */ void sub_21429(int iParam0, unknown uParam1, boolean bParam2)
{
    iParam0->_fU4 = uParam1;
    iParam0->_fU0 = CREATE_GROUP( 3, 1 );
    if (bParam2)
    {
        PRINTSTRING( "[MSWW]### P_SETUP_AI_GROUP TOLD TO WAIT FOR GROUP TO EXIST ###" );
        PRINTNL();
        while (NOT (DOES_GROUP_EXIST( iParam0->_fU0 )))
        {
            WAIT( 0 );
            PRINTSTRING( "[MSWW]### GROUP ###" );
            PRINTNL();
        }
        PRINTSTRING( "[MSWW]### P_SETUP_AI_GROUP created group with ID: " );
        PRINTINT( iParam0->_fU0 );
        PRINTNL();
    }
    SET_GROUP_RATIO_FIRING_AT_VISIBLE( iParam0->_fU0, iParam0->_fU4 );
    SET_GROUP_RATIO_FIRING_AT_INVISIBLE( iParam0->_fU0, iParam0->_fU4 );
    if (iParam0->_fU8)
    {
        SET_GROUP_FORMATION( iParam0->_fU0, iParam0->_fU12 );
        SET_GROUP_FORMATION_SPACING( iParam0->_fU0, iParam0->_fU16 );
        SET_GROUP_FORMATION_MAX_MOVE_SPEED( iParam0->_fU0, iParam0->_fU20 );
    }
    return;
}

/* CLEANPED */ void sub_21861(unknown uParam0)
{
    if (DOES_PED_EXIST( uParam0 ))
    {
        if ((NOT (IS_PED_DEAD( uParam0 ))) || (IS_PED_DEAD( uParam0 )))
        {
            REMOVE_ALL_PED_WEAPONS( uParam0 );
            DELETE_PED( ref uParam0 );
        }
    }
    return;
}

/* CREATEPED */ void sub_21953(int iParam0)
{
    int iVar3;

    iVar3 = 0;
    if (iParam0->_fU16 == 0)
    {
        if (iParam0->_fU20 != 0)
        {
            iVar3 = GET_SCENE_PED_MODEL( iParam0->_fU20 );
        }
    }
    else
    {
        iVar3 = iParam0->_fU16;
    }
    if ((HAS_MODEL_LOADED( iVar3 )) == 0)
    {
        SCRIPT_ASSERT( "Error: The model you are trying to create a ped with MUST BE PRELOADED!!!!", 0 );
         /* LOADMODEL */ sub_987( iParam0->_fU16, 1 );
    }
    iParam0->_fU40 = CREATE_PED( iParam0->_fU24, iParam0->_fU16, iParam0->_fU0, iParam0->_fU12, 1, iParam0->_fU48 );
    if (((IS_PED_DEAD( iParam0->_fU40 )) == 0) AND ((DOES_PED_EXIST( iParam0->_fU40 )) == 1))
    {
        if (iParam0->_fU20 != 0)
        {
            SET_PERSISTENT_PED_VARIATION_ENUM( iParam0->_fU40, iParam0->_fU20 );
        }
        SET_PED_RELATIONSHIP_GROUP( iParam0->_fU40, iParam0->_fU28 );
        SET_PED_RELATIONSHIP( iParam0->_fU40, iParam0->_fU36, iParam0->_fU32 );
        SET_LOAD_COLLISION_FOR_PED_FLAG( iParam0->_fU40, 1 );
        SET_PED_COORDS_NO_OFFSET( iParam0->_fU40, "[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( iParam0->_fU40 ) );
        SET_PED_HEADING( iParam0->_fU40, iParam0->_fU12 );
        iParam0->_fU44 = 1;
    }
    else
    {
        SCRIPT_ASSERT( "Error: The ped you created doesn't exist or is dead!", 0 );
    }
     /* SETPEDDEFAULTSTATS */ sub_22444( iParam0->_fU40 );
     /* SETPEDDEFAULTTEMPLATE */ sub_22545( iParam0->_fU40 );
    return iParam0->_fU40;
}

/* SETPEDDEFAULTSTATS */ void sub_22444(unknown uParam0)
{
    if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
    {
        SET_PED_HEALTH( uParam0, 200, 0 );
        SET_PED_ACCURACY( uParam0, -729479261 );
    }
    return;
}

/* SETPEDDEFAULTTEMPLATE */ void sub_22545(unknown uParam0)
{
    if (((IS_PED_DEAD( uParam0 )) == 0) AND ((DOES_PED_EXIST( uParam0 )) == 1))
    {
        SET_PED_AI_TEMPLATE( uParam0, "AIT_DEFAULT_GENERIC" );
    }
    return;
}

/* IS_PED_VALID */ int sub_22677(unknown uParam0)
{
    if ((NOT (IS_PED_DEAD( uParam0 ))) AND (DOES_PED_EXIST( uParam0 )))
    {
        return 1;
    }
    return 0;
}

/* P_QUICK_ADD_PED_TO_GROUP */ void sub_22806(unknown uParam0, int iParam1)
{
    int iVar4;
    unknown uVar5;

    if ((DOES_GROUP_EXIST( iParam1->_fU0 )) == 0)
    {
         /* WRITE_STRING */ sub_1104( "[SP]### Warning!!! Group does not exist. Creating new group specified attributes. ###" );
        if (iParam1->_fU4 > 0)
        {
             /* P_SETUP_AI_GROUP */ sub_21429( iParam1, iParam1->_fU4, 0 );
        }
        else
        {
             /* P_SETUP_AI_GROUP */ sub_21429( iParam1, 1056964608, 0 );
        }
    }
    else
    {
        PRINTSTRING( "[MSWW]### P_QUICK_ADD_PED_TO_GROUP adding ped to group with ID: " );
        PRINTINT( iParam1->_fU0 );
        PRINTNL();
    }
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        GET_GROUP_SIZE( iParam1->_fU0, ref iVar4, ref uVar5 );
        if (iVar4 == 0)
        {
            SET_PED_AS_GROUP_LEADER( uParam0, iParam1->_fU0 );
        }
        else
        {
            SET_PED_AS_GROUP_MEMBER( uParam0, iParam1->_fU0 );
        }
        SET_PED_NEVER_LEAVES_GROUP( uParam0, 1 );
    }
    return;
}

/* PED_SET_ENGAGEMENT_RANGES */ void sub_23272(unknown uParam0, unknown uParam1)
{
    switch (uParam1)
    {
        case -1569615261:
        case 406496141:
        case -862236369:
        case 456708483:
        case -1464892298:
        case 68019059:
        case -612753081:
        case -820634585:
        SET_PED_COMBAT_RANGE_MAX( uParam0, 10.00000000 );
        SET_PED_COMBAT_RANGE_MIN( uParam0, 1.00000000 );
        break;
        case 434544317:
        case 1845102363:
        case -168327769:
        case -184942895:
        case 514118749:
        case 1964270085:
        case -691403429:
        case 1478009203:
        case -1404433099:
        case 1194438308:
        SET_PED_COMBAT_RANGE( uParam0, 1 );
        SET_PED_COMBAT_RANGE_MAX( uParam0, 20.00000000 );
        SET_PED_COMBAT_RANGE_MIN( uParam0, 1.00000000 );
        break;
        case -1013714740:
        case -1074756423:
        case 1308526797:
        case 840671040:
        case 57534114:
        case 724901397:
        case 1992962408:
        SET_PED_COMBAT_RANGE( uParam0, 2 );
        SET_PED_COMBAT_RANGE_MAX( uParam0, 30.00000000 );
        SET_PED_COMBAT_RANGE_MIN( uParam0, 1.00000000 );
        break;
        case 1224272620:
        case 10648147:
        case 377623895:
        case 319712764:
        case -110877124:
        case -1659006841:
        SET_PED_COMBAT_RANGE( uParam0, 3 );
        SET_PED_COMBAT_RANGE_MAX( uParam0, 50.00000000 );
        SET_PED_COMBAT_RANGE_MIN( uParam0, 5.00000000 );
        break;
    }
    return;
}

/* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ void sub_23888(unknown uParam0, unknown uParam1)
{
    int I;
    char[32] cVar5;

    for ( I = 0; I < (uParam0^); I++ )
    {
        if (DOES_PED_EXIST( (uParam0^)[I] ))
        {
            StrCopy( ref cVar5, uParam1, 32 );
            ConcatString(ref cVar5, " ", 32);
            ConcatString(ref cVar5, I, 32);
            SET_PED_NAME_DEBUG( (uParam0^)[I], ref cVar5 );
        }
    }
    return;
}

/* PED_ARRAY_SET_TETHERBOX */ void sub_24108(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* PED_SET_TETHERBOX */ sub_24170( ref (uParam0^)[I], uParam1, uParam2 );
    }
    return;
}

/* PED_SET_TETHERBOX */ void sub_24170(unknown uParam0, unknown uParam1, unknown uParam2)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        RESET_PED_TETHERING( (uParam0^) );
         /* P_TETHERPED */ sub_24229( ref uParam1, (uParam0^), uParam2 );
    }
    return;
}

/* P_TETHERPED */ void sub_24229(int iParam0, unknown uParam1, unknown uParam2)
{
    if (((IS_PED_DEAD( uParam1 )) == 0) AND ((DOES_PED_EXIST( uParam1 )) == 1))
    {
        SET_PED_TETHERING_ADD_BOX( uParam1, iParam0->_fU0 );
        SET_PED_TETHERING_OPTION( uParam1, uParam2 );
    }
    return;
}

/* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ void sub_24346(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* PED_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24429( ref (uParam0^)[I], uParam1 );
    }
    return;
}

/* PED_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ void sub_24429(unknown uParam0, unknown uParam1)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( (uParam0^), uParam1 );
    }
    return;
}

/* P_DEACTIVATEPEDARRAY */ void sub_24818(unknown uParam0)
{
    int I;

    for ( I = 0; I < (uParam0^); I++ )
    {
         /* P_DEACTIVATEPED */ sub_24872( (uParam0^)[I] );
    }
    return;
}

/* P_DEACTIVATEPED */ void sub_24872(unknown uParam0)
{
    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        SET_PED_FREEZE_PROCESSING( uParam0, 1 );
        SET_PED_VISIBLE( uParam0, 0 );
        SET_PED_VISIBLE_DURING_SEQUENCE( uParam0, 0 );
        FREEZE_PED_POSITION( uParam0, 1 );
        SET_PED_COLLISION( uParam0, 0 );
        SET_PED_PROOFS( uParam0, 1, 1, 1, 1, 1 );
    }
    return;
}

/* CREATE_ROOFTOP_ADVANCE */ void sub_25110()
{
    int I;

     /* P_SETUP_AI_GROUP */ sub_21429( ref l_U1753, 1.00000000, 1 );
    for ( I = 0; I <= 3; I++ )
    {
         /* PED_INITIALIZE */ sub_25215( ref l_U1695[I], ref l_U1748[I], -691403429, "AIT_NORMAL", 0, 25000, 2, 0, 25000 );
        WAIT( 0 );
        if ( /* IS_PED_VALID */ sub_22677( l_U1748[I] ))
        {
             /* P_QUICK_ADD_PED_TO_GROUP */ sub_22806( l_U1748[I], ref l_U1753 );
             /* PED_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24429( ref l_U1748[I], 0 );
            SET_PED_VISIBLE( l_U1748[I], 0 );
             /* P_DEACTIVATEPED */ sub_24872( l_U1748[I] );
        }
    }
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1748, l_U1563, 1 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1748, "ROOF_ADVANCE" );
    return;
}

/* PED_INITIALIZE */ void sub_25215(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, int iParam7, unknown uParam8)
{
    unknown uVar11;

     /* CLEANPED */ sub_21861( (uParam1^) );
    (uParam1^) =  /* CREATEPED */ sub_21953( uParam0 );
    if ( /* IS_PED_VALID */ sub_22677( (uParam1^) ))
    {
        uVar11 =  /* F_GIVEPEDWEAPON */ sub_13920( (uParam1^), uParam2, uParam5, 0, 1 );
        if (iParam7 != 0)
        {
             /* F_GIVEPEDWEAPONTOHOLSTER */ sub_13169( (uParam1^), iParam7, 0, uParam8, 0 );
        }
        SET_PED_AI_TEMPLATE( (uParam1^), uParam3 );
        SET_PED_ALERTNESS( (uParam1^), uParam6 );
        switch (uParam4)
        {
            case 0: break;
            case 1:
            ENABLE_WEAPON_ATTACHMENT( uVar11, 13, 1 );
            TOGGLE_WEAPON_ATTACHMENT( uVar11, 13, 1 );
            break;
            case 2:
            ENABLE_WEAPON_ATTACHMENT( uVar11, 14, 1 );
            TOGGLE_WEAPON_ATTACHMENT( uVar11, 14, 1 );
            break;
            case 3:
            ENABLE_WEAPON_ATTACHMENT( uVar11, 12, 1 );
            TOGGLE_WEAPON_ATTACHMENT( uVar11, 12, 1 );
            break;
        }
    }
    return;
}

/* CREATE_COVER_ROOF_GUYS */ void sub_25628()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "CREATE_COVER_ROOF_GUYS", "***" );
     /* PED_ARRAY_INITIALIZE */ sub_21317( ref l_U1759, ref l_U1799, ref l_U1803, -862236369, 0.50000000, "AIT_NORMAL", 0, 0, 25000, 2, 0, 25000, 0 );
     /* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24346( ref l_U1799, 1 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1799, "ROOF_COVER_" );
     /* PED_TASK_COMBAT_SNAP_TO_COVER */ sub_25838( l_U1799[0], "GenCover", "F824CF1A_FAD87A44_Corner2", 0, 1 );
    if ( /* IS_PED_VALID */ sub_22677( l_U1799[1] ))
    {
        REMOVE_ALL_PED_WEAPONS( l_U1799[1] );
         /* F_GIVEPEDWEAPON */ sub_13920( l_U1799[1], -691403429, 25000, 0, 0 );
         /* PED_TASK_COMBAT_SNAP_TO_COVER */ sub_25838( l_U1799[1], "GenCover", "F824CF1A_ED4DB447_Corner2", 0, 1 );
    }
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1799, l_U1565, 1 );
     /* PED_ARRAY_ALWAYS_HIDE_IN_COVER */ sub_26125( ref l_U1799, 1 );
    return;
}

/* PED_TASK_COMBAT_SNAP_TO_COVER */ void sub_25838(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4)
{
    if ( /* IS_PED_VALID */ sub_22677( uParam0 ))
    {
        CLEAR_PED_TASKS_IMMEDIATELY( uParam0 );
         /* PED_SET_LOCK_TO_COVER */ sub_25904( ref uParam0, uParam4 );
        TASK_COMBAT_SNAP_TO_COVER( uParam0, uParam1, uParam2, uParam3 );
    }
    return;
}

/* PED_SET_LOCK_TO_COVER */ void sub_25904(unknown uParam0, unknown uParam1)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        SET_PED_FLAG_LOCK_TO_COVER( (uParam0^), uParam1 );
    }
    return;
}

/* PED_ARRAY_ALWAYS_HIDE_IN_COVER */ void sub_26125(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* PED_SET_ALWAYS_HIDE_IN_COVER */ sub_26192( ref (uParam0^)[I], uParam1 );
    }
    return;
}

/* PED_SET_ALWAYS_HIDE_IN_COVER */ void sub_26192(unknown uParam0, unknown uParam1)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
         /* WRITE_BOOL */ sub_19783( uParam1 );
        SET_PED_FLAG_ALWAYS_HIDE_WHEN_IN_COVER( (uParam0^), uParam1 );
    }
    return;
}

/* P_CREATE_GRILL */ void sub_26362()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_CREATE_GRILL", 0 );
     /* CLEANOBJECT */ sub_26423( l_U2044 );
    l_U2044 =  /* CREATEOBJECTNOOFFSET */ sub_26517( -859113524, -304.89000000, -22.45600000, 6.38500000, 0.00000000, 0.00000000, 0.00000000, 0, 1, 0 );
    if ((DOES_OBJECT_EXIST( l_U2044 )) == 1)
    {
        SET_OBJECT_ONLY_DAMAGED_BY_PLAYER( l_U2044, 1 );
        CAMERA_CAN_TARGET_OBJECT( 1, l_U2044 );
        SET_OBJECT_AS_PATH_OBSTACLE( l_U2044 );
    }
     /* P_CREATE_S_NY2_GG_M5_02 */ sub_26890();
    return;
}

/* CLEANOBJECT */ void sub_26423(unknown uParam0)
{
    if (DOES_OBJECT_EXIST( uParam0 ))
    {
        DELETE_OBJECT( ref uParam0 );
    }
    return;
}

/* CREATEOBJECTNOOFFSET */ void sub_26517(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, boolean bParam7, int iParam8, unknown uParam9)
{
    unknown Result;

    if ((HAS_MODEL_LOADED( uParam0 )) == 0)
    {
        SCRIPT_ASSERT( "The model you are trying to create a object with MUST BE PRELOADED!!!!", 0 );
         /* LOADMODEL */ sub_987( uParam0, 1 );
    }
    Result = CREATE_OBJECT_NO_OFFSET( uParam0, uParam1, NOT bParam7, uParam9 );
    if (iParam8 == 1)
    {
        while ((DOES_OBJECT_EXIST( Result )) == 0)
        {
            DISPLAYF( "[SP]### Waiting for an object to exist: {!f1} ###", 2, 1, -874832622, 513, uParam0 );
            WAIT( 0 );
        }
    }
    if ((DOES_OBJECT_EXIST( Result )) == 1)
    {
        SET_OBJECT_ROTATION( Result, uParam4 );
    }
    return Result;
}

/* P_CREATE_S_NY2_GG_M5_02 */ void sub_26890()
{
     /* WRITESCRIPTLOG */ sub_803( "CO", "P_CREATE_S_NY2_GG_M5_02", 0 );
     /* P_CREATECOLLECTIBLESTRUCT */ sub_27016( ref g_U683, g_U774, 658348797, 297855094, -370.43000000, 0.12000000, 6.33000000, 1.50000000, 0.00000000, 2.00000000, "" );
     /* P_CREATECOLLECTIBLE */ sub_27173( ref g_U683 );
    return;
}

/* P_CREATECOLLECTIBLESTRUCT */ void sub_27016(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10)
{
    if (NOT IS_ARCADE_MODE_ACTIVE())
    {
        iParam0->_fU4 = uParam1;
        iParam0->_fU8 = uParam2;
        iParam0->_fU12 = uParam3;
        iParam0->_fU16 = {uParam4};
        iParam0->_fU28 = {uParam7};
        StrCopy( ref iParam0->_fU40, uParam10, 32 );
    }
    else
    {
         /* WRITESCRIPTLOG */ sub_803( "CO", "NO GOLDEN GUNS FOR ARCADE", 0 );
    }
    return;
}

/* P_CREATECOLLECTIBLE */ void sub_27173(int iParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "CO", "P_CreateCollectible", 0 );
    if (NOT IS_ARCADE_MODE_ACTIVE())
    {
        if (( /* F_HAS_COLLECTIBLE_BEEN_COLLECTED */ sub_27256( iParam0->_fU12 )) == 1)
        {
             /* WRITESCRIPTLOG */ sub_803( "CO", "HAS BEEN COLLECTED.", 0 );
        }
        else
        {
             /* WRITESCRIPTLOG */ sub_803( "CO", "has never been collected.", 0 );
        }
        if (( /* F_HAS_COLLECTIBLE_BEEN_COLLECTED */ sub_27256( iParam0->_fU12 )) == 0)
        {
             /* CLEANPLACEMENT */ sub_27496( iParam0->_fU0 );
            iParam0->_fU0 =  /* CREATEPLACEMENT */ sub_27581( iParam0->_fU8, iParam0->_fU16, iParam0->_fU28, 1, 0, 0, 1119092736 );
            if (NOT (IS_STRING_NULL( iParam0 + 40 )))
            {
                if ((DOES_PLACEMENT_EXIST( iParam0->_fU0 )) == 1)
                {
                     /* WRITESCRIPTLOG */ sub_803( "CO", "Added collectible to interior", 0 );
                    ADD_PLACEMENT_TO_INTERIOR_ROOM_BY_NAME( iParam0->_fU0, iParam0 + 40 );
                }
            }
        }
    }
    else
    {
         /* WRITESCRIPTLOG */ sub_803( "CO", "NO GOLDEN GUNS FOR ARCADE", 0 );
    }
    return;
}

/* F_HAS_COLLECTIBLE_BEEN_COLLECTED */ int sub_27256(unknown uParam0)
{
    unknown uVar3;
    float fVar4;

    if (IS_COLLECTABLE_ENABLED() == 0)
    {
        return 1;
    }
    uVar3 = uParam0;
    fVar4 = STAT_HASH_GET_FLOAT( uVar3 );
    if (ARE_SP_STATS_LOADED() == 1)
    {
        if ((STAT_HASH_EXISTS( uVar3 )) == 1)
        {
            if (fVar4 > 0.00000000)
            {
                return 1;
            }
        }
    }
    return 0;
}

/* CLEANPLACEMENT */ void sub_27496(unknown uParam0)
{
    if ((DOES_PLACEMENT_EXIST( uParam0 )) == 1)
    {
        REMOVE_PLACEMENT( uParam0 );
    }
    return;
}

/* CREATEPLACEMENT */ void sub_27581(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, int iParam8, unknown uParam9, unknown uParam10)
{
    unknown Result;

    Result = CREATE_PLACEMENT_ROTATE( uParam0, uParam1, uParam4, uParam7, 0, uParam9, uParam10 );
    if (iParam8 == 1)
    {
        while ((DOES_PLACEMENT_EXIST( Result )) == 0)
        {
            DISPLAYF( "[SP]### Waiting for a placement to exist: {} ###", 1, 513, uParam0 );
            WAIT( 0 );
        }
    }
    return Result;
}

/* CREATE_TOWER_FOR_ROOFTOPS */ void sub_27924(unknown uParam0)
{
     /* UNREGISTER_TOWER_ENTITIES */ sub_27962();
     /* LOAD_WATERTOWER_ASSETS */ sub_2247( 1 );
     /* CREATE_TOWER */ sub_28826( uParam0 );
    return;
}

/* UNREGISTER_TOWER_ENTITIES */ void sub_27962()
{
    ISEQ_UNREGISTER_ENTITY( 123489604, "TOWER_AA" );
     /* TERMINATEISEQ */ sub_28029( 123489604, 1 );
    ISEQ_UNREGISTER_ENTITY( -900483547, "TOWER_ANM01" );
     /* TERMINATEISEQ */ sub_28029( -900483547, 1 );
    ISEQ_UNREGISTER_ENTITY( -652127296, "TOWER_ANM02" );
     /* TERMINATEISEQ */ sub_28029( -652127296, 1 );
    ISEQ_UNREGISTER_ENTITY( 8102532, "TOWER_ANM03" );
     /* TERMINATEISEQ */ sub_28029( 8102532, 1 );
    ISEQ_UNREGISTER_ENTITY( -1131749617, "TOWER_BASE" );
     /* TERMINATEISEQ */ sub_28029( -1131749617, 1 );
    ISEQ_UNREGISTER_ENTITY( 2119011196, "RF_WT_lid_01" );
     /* TERMINATEISEQ */ sub_28029( 2119011196, 1 );
    ISEQ_UNREGISTER_ENTITY( -1930417983, "RF_WT_lid_02" );
     /* TERMINATEISEQ */ sub_28029( -1930417983, 1 );
    ISEQ_UNREGISTER_ENTITY( 361106065, "TOWER_AA" );
     /* TERMINATEISEQ */ sub_28029( 361106065, 1 );
    ISEQ_UNREGISTER_ENTITY( 1876730400, "TOWER_ANM01" );
     /* TERMINATEISEQ */ sub_28029( 1876730400, 1 );
    ISEQ_UNREGISTER_ENTITY( 1423764005, "TOWER_ANM02" );
     /* TERMINATEISEQ */ sub_28029( 1423764005, 1 );
    ISEQ_UNREGISTER_ENTITY( -361846818, "TOWER_ANM03" );
     /* TERMINATEISEQ */ sub_28029( -361846818, 1 );
    ISEQ_UNREGISTER_ENTITY( -787715329, "TOWER_BASE" );
     /* TERMINATEISEQ */ sub_28029( -787715329, 1 );
    ISEQ_UNREGISTER_ENTITY( 247297794, "RF_WT_lid_01" );
     /* TERMINATEISEQ */ sub_28029( 247297794, 1 );
    ISEQ_UNREGISTER_ENTITY( -864087722, "RF_WT_lid_02" );
     /* TERMINATEISEQ */ sub_28029( -864087722, 1 );
    return;
}

/* TERMINATEISEQ */ void sub_28029(unknown uParam0, int iParam1)
{
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;

    if ((ISEQ_DOES_EXIST( uParam0 )) == 0)
    {
        SCRIPT_ASSERT( "Error: The interactive sequence you are trying to terminate does not exist!!!!", 0 );
    }
    if ((ISEQ_IS_LOADED( uParam0 )) == 1)
    {
        ISEQ_TERMINATE( uParam0 );
    }
    ISEQ_GET_NAME( 32, ref uVar4, uParam0 );
    if (iParam1 == 1)
    {
        while ((ISEQ_IS_LOADED( uParam0 )) == 1)
        {
            DISPLAYF( "[SP]### Waiting for interactive sequence to terminate: {0} {1} ###", 2, 1281, ref uVar4, 513, uParam0 );
            WAIT( 0 );
        }
    }
    return;
}

/* CREATE_TOWER */ void sub_28826(boolean bParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_TOWER", " " );
     /* DESTROY_TOWER */ sub_28881();
    g_U3112 =  /* CREATEOBJECTNOOFFSET */ sub_26517( -1522991054, g_U3119, g_U3122, 0, 1, 0 );
    g_U3113 =  /* CREATEOBJECTNOOFFSET */ sub_26517( -1193498759, g_U3119, g_U3122, 0, 1, 0 );
    g_U3114 =  /* CREATEOBJECTNOOFFSET */ sub_26517( -946946919, g_U3119, g_U3122, 0, 1, 0 );
    g_U3115 =  /* CREATEOBJECTNOOFFSET */ sub_26517( 588151771, g_U3119, g_U3122, 0, 1, 0 );
    g_U3116 =  /* CREATEOBJECTNOOFFSET */ sub_26517( 216303562, g_U3119, g_U3122, 0, 1, 0 );
    g_U3117 =  /* CREATEOBJECTNOOFFSET */ sub_26517( -1915312722, g_U3119, g_U3122, 0, 1, 0 );
    g_U3118 =  /* CREATEOBJECTNOOFFSET */ sub_26517( -1549971141, g_U3119, g_U3122, 0, 1, 0 );
    FREEZE_OBJECT_POSITION( g_U3112, 1 );
    FREEZE_OBJECT_POSITION( g_U3113, 1 );
    FREEZE_OBJECT_POSITION( g_U3114, 1 );
    FREEZE_OBJECT_POSITION( g_U3115, 1 );
    FREEZE_OBJECT_POSITION( g_U3116, 1 );
    FREEZE_OBJECT_POSITION( g_U3117, 1 );
    FREEZE_OBJECT_POSITION( g_U3118, 1 );
    SET_OBJECT_COLLISION( g_U3112, 0 );
    SET_OBJECT_COLLISION( g_U3113, 0 );
    SET_OBJECT_COLLISION( g_U3114, 0 );
    SET_OBJECT_COLLISION( g_U3115, 0 );
    SET_OBJECT_COLLISION( g_U3116, 0 );
    SET_OBJECT_COLLISION( g_U3117, 0 );
    SET_OBJECT_COLLISION( g_U3118, 0 );
    if (bParam0)
    {
        SET_OBJECT_VISIBLE( g_U3118, 0 );
    }
    else
    {
        SET_OBJECT_VISIBLE( g_U3117, 0 );
    }
    return;
}

/* DESTROY_TOWER */ void sub_28881()
{
     /* CLEANOBJECT */ sub_26423( g_U3112 );
     /* CLEANOBJECT */ sub_26423( g_U3113 );
     /* CLEANOBJECT */ sub_26423( g_U3114 );
     /* CLEANOBJECT */ sub_26423( g_U3115 );
     /* CLEANOBJECT */ sub_26423( g_U3116 );
     /* CLEANOBJECT */ sub_26423( g_U3117 );
     /* CLEANOBJECT */ sub_26423( g_U3118 );
    return;
}

/* LOADSEAMLESSCUTSCENE */ void sub_29445(unknown uParam0, int iParam1)
{
    if (HAS_CUTSCENE_LOADED())
    {
        if (NOT (CUTSCENE_IS_LOADED( uParam0 )))
        {
            SCRIPT_ASSERT( "Another cutscene is already loaded.  You can only load one cutscene into memory.  Your current cutscene will not load into memory.", 0 );
        }
    }
    if (NOT (CUTSCENE_IS_LOADED( uParam0 )))
    {
        PRE_STREAM_SEAMLESS_CUTSCENE( uParam0 );
        if (iParam1 == 1)
        {
            while ((CUTSCENE_IS_LOADED( uParam0 )) == 0)
            {
                DISPLAYF( "[SP]### Waiting for seamless cutscene to load: {} ###", 1, 1537, uParam0 );
                WAIT( 0 );
            }
        }
    }
    return;
}

/* P_CLOSEDOOR */ void sub_29790(int iParam0, int iParam1)
{
    if (( /* F_DOESDOOREXIST */ sub_29816( iParam0 )) == 0)
    {
         /* P_PRINTDOORNOTEXIST */ sub_29900( iParam0 );
    }
    if (iParam1 == 1)
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 1, 0.00000000 );
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, 0.00000000 );
    }
    else
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, 0.00000000 );
    }
    return;
}

/* F_DOESDOOREXIST */ int sub_29816(int iParam0)
{
    int iVar3;

    iVar3 = DOES_OBJECT_OF_TYPE_EXIST_AT_COORDS( iParam0->_fU4, 1.00000000, iParam0->_fU0 );
    if (iVar3 == 1)
    {
        return 1;
    }
    return 0;
}

/* P_PRINTDOORNOTEXIST */ void sub_29900(unknown uParam0)
{
    (uParam0^) = {(uParam0^)};
    return;
}

/* P_SETDOORLOCKED */ void sub_30047(int iParam0, int iParam1)
{
    int iVar4;
    float fVar5;

    if (( /* F_DOESDOOREXIST */ sub_29816( iParam0 )) == 0)
    {
         /* P_PRINTDOORNOTEXIST */ sub_29900( iParam0 );
    }
    if (iParam1 == 1)
    {
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 1, 0.00000000 );
    }
    else
    {
        iVar4 = 0;
        fVar5 = 0.00000000;
        GET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, ref iVar4, ref fVar5 );
        SET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, 0, fVar5 );
    }
    return;
}

/* TELEPORTPED */ void sub_30319(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4)
{
    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        SET_PED_COORDS( uParam0, uParam1, 1 );
        SET_PED_HEADING( uParam0, uParam4 );
    }
    return;
}

/* CREATE_PASSOS_ROOFTOP_MPM */ void sub_30663()
{
     /* CLEANPED */ sub_21861( g_U818 );
    g_U818 =  /* CREATEPED */ sub_21953( ref l_U2005 );
    if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( g_U818, -862236369, 25000, 0, 0 );
         /* P_SETUP_PASSOS_GENERAL_ATTRIBUTES */ sub_30765( ref g_U818 );
        SET_PED_NAME_DEBUG( g_U818, "PASSOS_ROOFTOPS_MPM" );
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( g_U818, 0 );
    }
    return;
}

/* P_SETUP_PASSOS_GENERAL_ATTRIBUTES */ void sub_30765(unknown uParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_SETUP_PASSOS_GENERAL_ATTRIBUTES", "***" );
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( (uParam0^), 1 );
        SET_PED_CAN_TRIGGER_BULLET_CAM( (uParam0^), 1 );
        SET_PED_VALIDATE_BULLET_CAM_HIT( (uParam0^), 0 );
        SET_AI_SHOULD_ALWAYS_MISS_PED( (uParam0^), 1 );
        SET_CAN_AI_KICK_THROUGH_CORPSES( (uParam0^), 1 );
        "[doubled result, dropped if not asigned]";
        "[doubled result, dropped if not asigned]";
        SET_PED_AI_TEMPLATE( (uParam0^), "AIT_NORMAL" );
        SET_PED_ONLY_DAMAGED_BY_PLAYER( (uParam0^), 1 );
        SET_PED_AS_ONE_SHOT_KILL( (uParam0^), 1 );
        SET_PED_GORE( (uParam0^), 0 );
        SET_PED_CAN_RAGDOLL_FROM_PLAYER_IMPACT( (uParam0^), 0 );
        SET_PED_PROOFS( (uParam0^), 0, 1, 1, 1, 1 );
        SET_PED_ALLOWED_TO_SURRENDER( (uParam0^), 0 );
        SET_PED_CAN_AVOID_DEATH_ZONES( (uParam0^), 0 );
        SET_PED_STAND_GROUND_ON_PLAYER_IMPACT( (uParam0^), 1 );
        SET_PED_CAN_PUSH_PLAYER( (uParam0^), 1 );
        SET_PED_RESIST_TO_OBJECT_COLLISION( (uParam0^), 1 );
        "[doubled result, dropped if not asigned]";
        "[doubled result, dropped if not asigned]";
        SET_PED_CAN_BE_TARGETTED( (uParam0^), 0 );
        SET_PED_CONSUMING_AMMO( (uParam0^), 0 );
        SET_PED_PATH_CAN_USE_CLIMBOVERS( (uParam0^), 1 );
        SET_PED_PATH_CAN_DROP_FROM_HEIGHT( (uParam0^), 1 );
    }
    return;
}

/* CREATE_DESTROYED_TOWER */ void sub_31193()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_DESTROYED_TOWER", 0 );
     /* CLEANOBJECT */ sub_26423( l_U2048 );
    l_U2048 =  /* CREATEOBJECTNOOFFSET */ sub_26517( -1809963165, -288.13200000, -11.19400000, -9.00700000, 0, 0, 0, 0, 0, 0 );
    return;
}

/* CREATE_PASSOS_ABANDONED_BUILDING */ void sub_31552()
{
     /* CLEANPED */ sub_21861( g_U818 );
    g_U818 =  /* CREATEPED */ sub_21953( ref l_U2005 );
    if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( g_U818, -862236369, 25000, 0, 0 );
         /* P_SETUP_PASSOS_GENERAL_ATTRIBUTES */ sub_30765( ref g_U818 );
        SET_PED_NAME_DEBUG( g_U818, "PASSOS_ROOFTOPS_ABDN" );
         /* LOADISEQ */ sub_1517( -1202559929, 1 );
         /* TELEPORTPED */ sub_30319( g_U818, -251.40000000, -1.70000000, 1.57000000, 65446 );
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( g_U818, 0 );
        ISEQ_REGISTER_ENTITY( -1202559929, "passos", g_U818, 0 );
        ISEQ_START( -1202559929 );
        PED_SET_ACTION_INTENTION( g_U818, 58, 1000, 0, 0, 0 );
    }
    return;
}

/* CREATE_ABANDONED_FLOOR1 */ void sub_31828()
{
    int I;

     /* PED_ARRAY_INITIALIZE_SAD */ sub_31914( ref l_U1831, ref l_U1858, ref l_U1861, -691403429, 0.50000000, "AIT_NORMAL", 0, 0, 25000, 2, -862236369, 25000, 0 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1858, "ABDN_FLOOR1_FRONT_" );
     /* PED_ARRAY_SET_ROOM_BY_NAME */ sub_32645( ref l_U1894, g_U3553 );
    for ( I = 0; I <= 1; I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1858[I] ))
        {
            SET_PED_ONLY_DAMAGED_BY_PLAYER( l_U1858[I], 1 );
        }
    }
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1858, l_U1560, 1 );
     /* PED_ARRAY_INITIALIZE_SAD */ sub_31914( ref l_U1867, ref l_U1894, ref l_U1897, -1074756423, 0.50000000, "AIT_NORMAL", 0, 0, 25000, 2, -862236369, 25000, 0 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1894, "ABDN_FLOOR1_BACK_" );
     /* PED_ARRAY_SET_ROOM_BY_NAME */ sub_32645( ref l_U1858, g_U3553 );
    for ( I = 0; I <= 1; I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1894[I] ))
        {
            SET_PED_ONLY_DAMAGED_BY_PLAYER( l_U1894[I], 1 );
            SET_PED_WEAPON_OBSTRUCTION_CHECK_DISTANCE( l_U1894[I], 1.00000000 );
        }
    }
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1894, l_U1561, 1 );
    if ( /* IS_PASSOS_VALID */ sub_33084())
    {
         /* PED_TASK_COMBAT_MOVE_TO_COVER */ sub_33214( l_U1858[0], "GenCover", "F824CF1A_9ED3037F_Corner1", g_U818, 0 );
         /* PED_TASK_COMBAT_MOVE_TO_COVER */ sub_33214( l_U1858[1], "GenCover", "F824CF1A_9ED3037F_Popover2", g_U818, 0 );
         /* PED_TASK_COMBAT_MOVE_TO_COVER */ sub_33214( l_U1894[0], "GenCover", "F824CF1A_B2BB12C2_Popover1", g_U818, 0 );
    }
     /* PED_ARRAY_INITIALIZE */ sub_21317( ref l_U1903, ref l_U1930, ref l_U1933, -1074756423, 0.50000000, "AIT_NORMAL", 0, 0, 25000, 2, 0, 25000, 0 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1930, "ABDN_FLOOR1_EXTRA" );
     /* PED_ARRAY_SET_ROOM_BY_NAME */ sub_32645( ref l_U1930, g_U3553 );
     /* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24346( ref l_U1930, 1 );
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U1930, l_U1561, 1 );
    for ( I = 0; I <= 1; I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1930[I] ))
        {
            SET_PED_WEAPON_OBSTRUCTION_CHECK_DISTANCE( l_U1930[I], 1.00000000 );
        }
    }
     /* P_ACTIVATEPEDARRAY */ sub_33613( ref l_U1930 );
     /* P_ACTIVATEPEDARRAY */ sub_33613( ref l_U1858 );
     /* P_ACTIVATEPEDARRAY */ sub_33613( ref l_U1894 );
    return;
}

/* PED_ARRAY_INITIALIZE_SAD */ void sub_31914(unknown uParam0, unknown uParam1, unknown uParam2, int iParam3, unknown uParam4, unknown uParam5, boolean bParam6, unknown uParam7, unknown uParam8, unknown uParam9, int iParam10, unknown uParam11, unknown uParam12)
{
    int I;
    unknown uVar16;
    int iVar17;

    if ((uParam0^) != (uParam1^))
    {
        SCRIPT_ASSERT( "PED_ARRAY_INITIALIZE - Array sizes don't match!!", 0 );
        return;
    }
     /* P_SETUP_AI_GROUP */ sub_21429( uParam2, uParam4, 0 );
    if (IS_STRING_NULL( uParam12 ))
    {
        uParam12 = l_U2;
    }
    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* CLEANPED */ sub_21861( (uParam1^)[I] );
        (uParam1^)[I] =  /* CREATEPED */ sub_21953( ref (uParam0^)[I] );
        if ( /* IS_PED_VALID */ sub_22677( (uParam1^)[I] ))
        {
             /* P_DEACTIVATEPED */ sub_24872( (uParam1^)[I] );
            SET_PED_AI_TEMPLATE( (uParam1^)[I], uParam5 );
            SET_PED_ALERTNESS( (uParam1^)[I], uParam9 );
            SET_PED_ALLOWED_TO_SURRENDER( (uParam1^)[I], 0 );
             /* P_QUICK_ADD_PED_TO_GROUP */ sub_22806( (uParam1^)[I], uParam2 );
            if (iParam3 != 0)
            {
                if (iParam3 != -1569615261)
                {
                    uVar16 =  /* F_GIVEPEDWEAPON */ sub_13920( (uParam1^)[I], iParam3, uParam8, 0, 0 );
                }
                if (iParam10 != 0)
                {
                     /* F_GIVEPEDWEAPONTOHOLSTER */ sub_13169( (uParam1^)[I], iParam10, 0, uParam11, 0 );
                }
            }
            else if (I < 10)
            {
                iVar17 = l_U3[I]._fU0;
                if ((iVar17 != -1569615261) AND (iVar17 != 0))
                {
                     /* F_GIVEPEDWEAPON */ sub_13920( (uParam1^)[I], iVar17, l_U3[I]._fU4, 0, 0 );
                }
                if (l_U3[I]._fU8 != 0)
                {
                     /* F_GIVEPEDWEAPONTOHOLSTER */ sub_13169( (uParam1^)[I], l_U3[I]._fU8, 0, l_U3[I]._fU12, 0 );
                }
            }
            if (bParam6)
            {
                 /* PED_SET_ENGAGEMENT_RANGES */ sub_23272( (uParam1^)[I], iParam3 );
            }
            switch (uParam7)
            {
                case 0: break;
                case 1:
                ENABLE_WEAPON_ATTACHMENT( uVar16, 13, 1 );
                TOGGLE_WEAPON_ATTACHMENT( uVar16, 13, 1 );
                break;
                case 2:
                ENABLE_WEAPON_ATTACHMENT( uVar16, 14, 1 );
                TOGGLE_WEAPON_ATTACHMENT( uVar16, 14, 1 );
                break;
                case 3:
                ENABLE_WEAPON_ATTACHMENT( uVar16, 12, 1 );
                TOGGLE_WEAPON_ATTACHMENT( uVar16, 12, 1 );
                break;
            }
        }
        WAIT( 1 );
    }
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( uParam1, uParam12 );
    return;
}

/* PED_ARRAY_SET_ROOM_BY_NAME */ void sub_32645(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( (uParam0^)[I] ))
        {
             /* PED_SET_ROOM_BY_NAME */ sub_32730( ref (uParam0^)[I], uParam1 );
        }
    }
    return;
}

/* PED_SET_ROOM_BY_NAME */ void sub_32730(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        SET_ROOM_FOR_PED_BY_NAME( (uParam0^), ref uParam1 );
    }
    return;
}

/* IS_PASSOS_VALID */ int sub_33084()
{
    if ((NOT (IS_PED_DEAD( g_U818 ))) AND (DOES_PED_EXIST( g_U818 )))
    {
        return 1;
    }
    return 0;
}

/* PED_TASK_COMBAT_MOVE_TO_COVER */ void sub_33214(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4)
{
    if ( /* IS_PED_VALID */ sub_22677( uParam0 ))
    {
        CLEAR_PED_TASKS_IMMEDIATELY( uParam0 );
         /* PED_SET_LOCK_TO_COVER */ sub_25904( ref uParam0, uParam4 );
        TASK_COMBAT_MOVE_TO_COVER( uParam0, uParam1, uParam2, uParam3 );
    }
    return;
}

/* P_ACTIVATEPEDARRAY */ void sub_33613(unknown uParam0)
{
    int I;

    for ( I = 0; I < (uParam0^); I++ )
    {
         /* P_ACTIVATEPED */ sub_33665( (uParam0^)[I] );
    }
    return;
}

/* P_ACTIVATEPED */ void sub_33665(unknown uParam0)
{
    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        SET_PED_FREEZE_PROCESSING( uParam0, 0 );
        SET_PED_VISIBLE( uParam0, 1 );
        SET_PED_VISIBLE_DURING_SEQUENCE( uParam0, 1 );
        FREEZE_PED_POSITION( uParam0, 0 );
        SET_PED_COLLISION( uParam0, 1 );
        SET_PED_PROOFS( uParam0, 0, 0, 0, 0, 0 );
    }
    return;
}

/* CLEANUP_ROOFTOP_ASSETS_FOR_ABANDONED_BUILDING */ void sub_33922()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CLEANUP_ROOFTOP_ASSETS_FOR_ABANDONED_BUILDING", 0 );
     /* DESTROY_TOWER */ sub_28881();
     /* CLEANOBJECT */ sub_26423( l_U2048 );
     /* CLEANOBJECT */ sub_26423( l_U2047 );
     /* CLEANOBJECT */ sub_26423( l_U2044 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U2206 );
     /* TERMINATEISEQ */ sub_28029( 1419096468, 0 );
     /* TERMINATEISEQ */ sub_28029( 123489604, 0 );
     /* TERMINATEISEQ */ sub_28029( -900483547, 0 );
     /* TERMINATEISEQ */ sub_28029( -652127296, 0 );
     /* TERMINATEISEQ */ sub_28029( 8102532, 0 );
     /* TERMINATEISEQ */ sub_28029( -1131749617, 0 );
     /* TERMINATEISEQ */ sub_28029( 2119011196, 0 );
     /* TERMINATEISEQ */ sub_28029( -1930417983, 0 );
     /* TERMINATEISEQ */ sub_28029( 361106065, 0 );
     /* TERMINATEISEQ */ sub_28029( 1876730400, 0 );
     /* TERMINATEISEQ */ sub_28029( 1423764005, 0 );
     /* TERMINATEISEQ */ sub_28029( -361846818, 0 );
     /* TERMINATEISEQ */ sub_28029( -787715329, 0 );
     /* TERMINATEISEQ */ sub_28029( 247297794, 0 );
     /* TERMINATEISEQ */ sub_28029( -864087722, 0 );
     /* CLEANPLACEMENT */ sub_27496( g_U683._fU0 );
     /* CLEANPLACEMENT */ sub_27496( g_U737._fU0 );
     /* UNLOADMODEL */ sub_34347( -1522991054 );
     /* UNLOADMODEL */ sub_34347( -1193498759 );
     /* UNLOADMODEL */ sub_34347( 588151771 );
     /* UNLOADMODEL */ sub_34347( 216303562 );
     /* UNLOADMODEL */ sub_34347( -946946919 );
     /* UNLOADMODEL */ sub_34347( -1915312722 );
     /* UNLOADMODEL */ sub_34347( -1549971141 );
     /* UNLOADMODEL */ sub_34347( 1740663406 );
     /* UNLOADMODEL */ sub_34347( g_U774 );
     /* UNLOADMODEL */ sub_34347( g_U777 );
     /* UNLOADANIMDICT */ sub_34599( "ny_wtanim" );
     /* UNLOADANIMDICT */ sub_34599( "ny_anim" );
    return;
}

/* CLEANPEDARRAY */ void sub_34079(unknown uParam0)
{
    int I;

    I = 0;
    for ( I = 0; I < (uParam0^); I++ )
    {
         /* CLEANPED */ sub_21861( (uParam0^)[I] );
    }
    return;
}

/* UNLOADMODEL */ void sub_34347(unknown uParam0)
{
    if ((IS_MODEL_IN_CDIMAGE( uParam0 )) == 1)
    {
        SET_MODEL_AS_NO_LONGER_NEEDED( uParam0 );
    }
    else
    {
         /* WRITE_STRING */ sub_1104( "[SP]### ERROR! (UnloadModel) Trying to unload a model that isn't in the img! ###" );
    }
    return;
}

/* UNLOADANIMDICT */ void sub_34599(unknown uParam0)
{
    REMOVE_ANIM_DICT( uParam0, 0 );
    return;
}

/* P_CREATE_AND_START_TIMER */ void sub_34674(unknown uParam0, unknown uParam1)
{
     /* CREATETIMER */ sub_10316( uParam0, uParam1, 1, 0 );
     /* STARTTIMER */ sub_34724( uParam0 );
    return;
}

/* STARTTIMER */ void sub_34724(int iParam0)
{
    if (NOT iParam0->_fU20)
    {
        iParam0->_fU20 = 1;
        iParam0->_fU16 = 0;
        if (iParam0->_fU28)
        {
            iParam0->_fU0 = TIMERA();
        }
        else
        {
            iParam0->_fU0 = TIMERB();
        }
        if (iParam0->_fU32 == 1)
        {
            iParam0->_fU0 = TIMERSYSTEM();
        }
        iParam0->_fU4 = iParam0->_fU0;
    }
    return;
}

/* P_FADE_IN_AND_WAIT */ void sub_34870(unknown uParam0)
{
    if ((IS_SCREEN_FADING_IN() == 0) AND (IS_SCREEN_FADED_IN() == 0))
    {
        DO_SCREEN_FADE_IN( uParam0 );
        while (IS_SCREEN_FADED_IN() == 0)
        {
            DISPLAYF( "[SP]### Waiting for screen to fade in... ###", 0 );
            WAIT( 0 );
        }
    }
    return;
}

/* CREATE_PASSOS_ABANDONED_BUILDING_2 */ void sub_35183()
{
     /* CLEANPED */ sub_21861( g_U818 );
    g_U818 =  /* CREATEPED */ sub_21953( ref l_U2031 );
    if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( g_U818, -862236369, 25000, 0, 0 );
         /* P_SETUP_PASSOS_GENERAL_ATTRIBUTES */ sub_30765( ref g_U818 );
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( g_U818, 0 );
        SET_PED_NAME_DEBUG( g_U818, "PASSOS_ABDN_BLDG_2" );
         /* PED_SET_ROOM_BY_NAME */ sub_32730( ref g_U818, g_U3553 );
         /* LOADISEQ */ sub_1517( -1202559929, 1 );
        ISEQ_REGISTER_ENTITY( -1202559929, "passos", g_U818, 0 );
        ISEQ_START( -1202559929 );
        l_U2298 = 1;
        CLEAR_PED_PRIMARY_LOOKAT( g_U818 );
        if ( /* IS_MAX_VALID */ sub_35429())
        {
            SET_PED_PRIMARY_LOOKAT( g_U818,  /* PLAYER_PED_ID */ sub_11378() );
        }
        PED_SET_ACTION_INTENTION( g_U818, 56, 1000, 0, 0, 0 );
         /* INIT_HANDLE_PASSOS_WAITING_SPEECH */ sub_35528();
         /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2579, 21000 );
        l_U2296 = 1;
    }
    return;
}

/* IS_MAX_VALID */ int sub_35429()
{
    if ( /* IS_PED_VALID */ sub_22677(  /* PLAYER_PED_ID */ sub_11378() ))
    {
        return 1;
    }
    return 0;
}

/* INIT_HANDLE_PASSOS_WAITING_SPEECH */ void sub_35528()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "INIT_HANDLE_PASSOS_WAITING_SPEECH: Setting ePWS_State = ePWS_SetupState", 0 );
    l_U117 = 1;
    return;
}

/* P_ADD_WIDGET_VECTOR_SLIDER */ void sub_35891(int iParam0, unknown uParam1, unknown uParam2)
{
    START_WIDGET_GROUP( uParam1 );
    ADD_WIDGET_FLOAT_SLIDER( "x", iParam0 + 0, 60536, 5000, uParam2 );
    ADD_WIDGET_FLOAT_SLIDER( "y", iParam0 + 4, 60536, 5000, uParam2 );
    ADD_WIDGET_FLOAT_SLIDER( "z", iParam0 + 8, 60536, 5000, uParam2 );
    STOP_WIDGET_GROUP();
    return;
}

/* P_HANDLE_MUSIC */ void sub_36262()
{
    if (l_U2597 != l_U2595)
    {
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music:changed CUR FLAG", 0 );
         /* WRITE_INT */ sub_19082( l_U2595 );
         /* WRITE_INT */ sub_19082( l_U2596 );
        l_U2597 = l_U2595;
    }
    else if (l_U2598 != l_U2596)
    {
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music:changed NEW FLAG", 0 );
         /* WRITE_INT */ sub_19082( l_U2595 );
         /* WRITE_INT */ sub_19082( l_U2596 );
        l_U2598 = l_U2596;
    }
    switch (l_U2595)
    {
        case 1:
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_STARTUP ", 0 );
        l_U2599 = 0;
        l_U2595 = 7;
        l_U2596 = 7;
        break;
        case 2:
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_CHECKPOINT_RESTART_ROOFTOPS ", 0 );
        AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1", "", 0, 1000, 5000, -1082130432, 0 );
        l_U2599 = 0;
        l_U2595 = 7;
        l_U2596 = 7;
        break;
        case 7:
        if (l_U2596 == 7)
        {
            if (l_U2599 == 0)
            {
                AUDIO_MUSIC_PRELOAD_ONESHOT( "NYBAR_OS_2", 0 );
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( "NYBAR_OS_2" ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully preloaded NYBAR_OS_2 ", 0 );
                    l_U2599 = 1;
                }
            }
            else
            {
                l_U2595 = 8;
                l_U2596 = 8;
            }
        }
        break;
        case 8:
        if (l_U2596 == 8)
        {
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1_2", "", 0, 1000, -1, -1082130432, 0 );
            l_U2595 = 9;
        }
        break;
        case 9:
        if (l_U2596 == 9)
        {
            if (l_U2599 == 1)
            {
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( "NYBAR_OS_2" ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully played oneshot_20 ", 0 );
                    AUDIO_MUSIC_PLAY_ONESHOT();
                }
            }
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1_2_4_6", "", 0, 1000, 5000, -1082130432, 0 );
            l_U2595 = 10;
        }
        break;
        case 10:
        if (l_U2596 == 10)
        {
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1_2_5_6", "", 0, 5000, 5000, -1082130432, 0 );
            l_U2595 = 11;
        }
        break;
        case 11:
        if (l_U2596 == 11)
        {
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1_3", "", 0, 6000, 5000, -1082130432, 0 );
            l_U2595 = 13;
        }
        break;
        case 13:
        if (l_U2596 == 13)
        {
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1_2_3", "", 0, 7000, -1, -1082130432, 0 );
            l_U2595 = 12;
        }
        break;
        case 3:
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_CHECKPOINT_RESTART_PRE_MPM ", 0 );
        AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1_3", "", 0, 1000, -1, -1082130432, 0 );
        l_U2599 = 0;
        l_U2595 = 14;
        l_U2596 = 14;
        break;
        case 12:
        if (l_U2596 == 12)
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_STARTING_MPM", 0 );
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_1_3", "", 0, 1000, -1, -1082130432, 0 );
            l_U2599 = 0;
            l_U2595 = 14;
            l_U2596 = 14;
        }
        break;
        case 14:
        if (l_U2596 == 14)
        {
            if (l_U2599 == 0)
            {
                AUDIO_MUSIC_PRELOAD_ONESHOT( "NYBAR_ONESHOT_13", 0 );
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( 0 ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully preloaded oneshot_13 ", 0 );
                    l_U2599 = 1;
                }
            }
            else
            {
                l_U2595 = 15;
            }
        }
        break;
        case 15:
        if (l_U2596 == 15)
        {
            if (l_U2599 == 1)
            {
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( 0 ))
                {
                    AUDIO_MUSIC_SUSPEND( 6000 );
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully played oneshot_13 ", 0 );
                    AUDIO_MUSIC_PLAY_ONESHOT();
                }
            }
            l_U2599 = 0;
            l_U2595 = 16;
        }
        break;
        case 16:
        if (l_U2596 == 16)
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_POST_MPM", 0 );
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_3", "", 0, 5000, 5000, -1082130432, 0 );
            l_U2595 = 17;
        }
        break;
        case 4:
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_CHECKPOINT_RESTART_POST_MPM ", 0 );
        AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_3", "", 0, 5000, 5000, -1082130432, 0 );
        l_U2599 = 0;
        l_U2595 = 17;
        break;
        case 17:
        if (l_U2596 == 17)
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_LEDGE_UP ", 0 );
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_3_6", "", 0, 3000, 5000, -1082130432, 0 );
            l_U2595 = 18;
        }
        break;
        case 5:
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_CHECKPOINT_RESTART_ABANDONED_BUILDING_1 ", 0 );
        l_U2599 = 0;
        AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_3_5_6", "", 0, 5000, 5000, -1082130432, 0 );
        l_U2595 = 19;
        l_U2596 = 19;
        break;
        case 18:
        if (l_U2596 == 18)
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_ENTER_AB_BLD ", 0 );
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_3_5_6", "", 0, 2000, 5000, -1082130432, 0 );
            l_U2595 = 19;
            l_U2596 = 19;
        }
        break;
        case 19:
        if (l_U2596 == 19)
        {
            if (l_U2599 == 0)
            {
                AUDIO_MUSIC_PRELOAD_ONESHOT( "NYBAR_OS_1", 0 );
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( "NYBAR_OS_1" ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully preloaded NYBAR_OS_1 ", 0 );
                    l_U2599 = 1;
                }
            }
            else
            {
                l_U2595 = 20;
            }
        }
        break;
        case 20:
        if (l_U2596 == 20)
        {
            if (l_U2599 == 1)
            {
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( 0 ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully played NYBAR_OS_1 ", 0 );
                    AUDIO_MUSIC_PLAY_ONESHOT();
                }
            }
            l_U2599 = 0;
            l_U2595 = 21;
        }
        break;
        case 21:
        if (l_U2596 == 21)
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: first floor all dead", 0 );
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_3", "", 0, 6000, 6000, -1082130432, 0 );
            l_U2595 = 22;
            l_U2596 = 22;
        }
        break;
        case 6:
         /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: MC_CHECKPOINT_RESTART_ABANDONED_BUILDING_2 ", 0 );
        AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_3", "", 0, 3000, 5000, -1082130432, 0 );
        l_U2599 = 0;
        l_U2595 = 22;
        l_U2596 = 22;
        break;
        case 22:
        if (l_U2596 == 22)
        {
            if (l_U2599 == 0)
            {
                AUDIO_MUSIC_PRELOAD_ONESHOT( "NYBAR_RAND_OS", 0 );
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( "NYBAR_RAND_OS" ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully preloaded NYBAR_RAND_OS ", 0 );
                    l_U2599 = 1;
                }
            }
            else
            {
                l_U2595 = 23;
            }
        }
        break;
        case 23:
        if (l_U2596 == 23)
        {
            if (l_U2599 == 1)
            {
                if (AUDIO_MUSIC_IS_ONESHOT_PREPARED( "NYBAR_RAND_OS" ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: Sussesfully played NYBAR_RAND_OS ", 0 );
                    AUDIO_MUSIC_PLAY_ONESHOT();
                }
            }
            l_U2599 = 0;
            l_U2595 = 24;
            l_U2596 = 24;
        }
        break;
        case 24:
        if (l_U2596 == 24)
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: moving to floor 2", 0 );
            AUDIO_MUSIC_FORCE_TRACK( "NYBAR_SONG_2ND", "NYBAR_02_2_3_5", "", 0, 2000, 2000, -1082130432, 0 );
            l_U2595 = 25;
        }
        break;
        case 25:
        if (l_U2596 == 25)
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "playing music: all dead", 0 );
            AUDIO_MUSIC_SUSPEND( 8000 );
            l_U2595 = 28;
        }
        break;
    }
    return;
}

/* HANDLE_CHECKPOINTS */ void sub_39844()
{
    if ((g_U780 == 6) || ((g_U780 == 5) || ((g_U780 == 4) || ((g_U780 == 3) || (g_U780 == 2)))))
    {
        if (l_U2860 == 0)
        {
            if ((l_U2126) || (NOT ( /* IS_PED_VALID */ sub_22677(  /* PLAYER_PED_ID */ sub_11378() ))))
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_CHECKPOINTS - Player's died on Rooftops, setting eFailure = STATE_FAIL_WAITING", 0 );
                l_U2126 = 0;
                l_U2860 = 2;
                if (g_U780 != 3)
                {
                    ;
                }
            }
            else if ( /* RESTARTING_CHECKPOINT */ sub_40082())
            {
                 /* WRITESCRIPTLOG */ sub_803( "SBA", "HANDLE_CHECKPOINTS - Restart, setting eFailure = STATE_FAIL_WAITING", 0 );
                l_U2860 = 2;
            }
            else if (l_U2291)
            {
                if ((NOT IS_LAST_MAN_STANDING_ACTIVE()) AND ((g_U3040) || (IS_PED_DEAD( g_U818 ))))
                {
                     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_CHECKPOINTS: Passos killed, setting eFailure = STATE_FAIL_DEATH_CAM_PASSOS", "***" );
                    SET_PED_GORE( g_U818, 1 );
                    l_U2860 = 1;
                }
            };;;
        }
         /* P_HANDLE_FAILURE */ sub_40795();
    }
    return;
}

/* RESTARTING_CHECKPOINT */ int sub_40082()
{
    if (HAS_SELECTED_RETRY_CHECKPOINT())
    {
        if (IS_IN_NYMINUTE_MODE())
        {
            SWITCH_TO_LEVEL( GET_INDEX_OF_CURRENT_LEVEL() );
        }
        if (HAS_CUTSCENE_FINISHED() == 0)
        {
            return 0;
        }
        l_U0 = 0;
        g_U648 = 1;
        DO_SCREEN_FADE_OUT( 0 );
        ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 1, 1 );
        TERMINATE_GAME_BULLET_CAMERA();
        if (IS_ANIMATED_CAMERA_PLAYING())
        {
            CAMERA_ANIMATED_STOP( 0, 0 );
        }
        STOP_ALL_SCRIPTED_CONVERSATIONS( 0 );
        DEACTIVATE_BULLET_TIME( 1, 0 );
        END_POSTFX_BLENDER( 0, 0 );
        END_POSTFX_BLENDER( 2, 0 );
        END_POSTFX_BLENDER( 3, 0 );
        END_POSTFX_BLENDER( 4, 0 );
        END_POSTFX_BLENDER( 5, 0 );
        END_POSTFX_BLENDER( 7, 0 );
        END_POSTFX_BLENDER( 9, 0 );
        END_POSTFX_BLENDER( 10, 0 );
        END_POSTFX_BLENDER( 11, 0 );
        END_POSTFX_BLENDER( 12, 0 );
        END_POSTFX_BLENDER( 13, 0 );
        END_POSTFX_BLENDER( 14, 0 );
        END_POSTFX_BLENDER( 15, 0 );
        END_POSTFX_BLENDER( 16, 0 );
        STOP_ALL_IMAGEFX( 0 );
        if (NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
        {
            SET_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378(), 0 );
            SET_PLAYER_FORCED_AIM(  /* PLAYER_ID */ sub_11416(), 0, 0 );
            SET_PLAYER_CAN_USE_SHOOTDODGE(  /* PLAYER_ID */ sub_11416(), 1 );
            if ((IS_PED_VISIBLE(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
            {
                SET_PED_VISIBLE(  /* PLAYER_PED_ID */ sub_11378(), 1 );
            }
        }
        CLEAR_PRINTS();
        CLEAR_HELP();
        SET_INTERACTIONTEXT_VISIBLE( 0 );
        RENDER_SCRIPT_CAMS( 0, 0, 3000, 0 );
        DESTROY_ALL_CAMS();
        AUDIO_MUSIC_SUSPEND( 500 );
        return 1;
    }
    return 0;
}

/* P_HANDLE_FAILURE */ void sub_40795()
{
    switch (l_U2860)
    {
        case 0: break;
        case 1:
        if ( /* IS_MAX_VALID */ sub_35429())
        {
            SET_PED_INVINCIBLE(  /* PLAYER_PED_ID */ sub_11378(), 1 );
        }
        if (l_U2859 == 2)
        {
            l_U2860 = 2;
             /* WRITESCRIPTLOG */ sub_803( "SBA", "Disabling ALLOW_BULLET_CAMERA_TO_GAMEPLAY...", 0 );
            ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 0, 1 );
             /* P_SETUP_PASSOS_DEATH */ sub_41007( 0 );
             /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathState = PE_MOVING; eFailure - STATE_FAIL_WAITING", 0 );
        }
        else if (l_U2859 == 0)
        {
            if ( /* PLAY_MIDSCENE_05A_PASSOS_DEATH */ sub_41972( l_U2422 ))
            {
                l_U2860 = 2;
                 /* WRITESCRIPTLOG */ sub_803( "CCB", "eFailure - STATE_FAIL_WAITING", 0 );
            }
        }
        else if (l_U2859 == 1)
        {
            if ( /* PLAY_MIDSCENE_05B_PASSOS_DEATH */ sub_44860( l_U2422 ))
            {
                l_U2860 = 2;
                 /* WRITESCRIPTLOG */ sub_803( "CCB", "eFailure - STATE_FAIL_WAITING", 0 );
            }
        };;;
        break;
        case 2:
        if ( /* IS_RESTART_ACTIVE */ sub_46239())
        {
            if ((g_U819[7]._fU40 != 4) AND (g_U819[7]._fU40 != 0))
            {
                 /* WRITESCRIPTLOG */ sub_803( "GA", "Shutting down script for Chopshop.", 0 );
                g_U3041 = 1;
                 /* P_RESET_CHECKPOINT_THREAD */ sub_46382( ref g_U819[7] );
                SET_EXITFLAG_FOR_SCRIPT( g_U819[7]._fU32 );
                g_U3437[7] = 0;
                g_U3437[8] = 1;
            }
            l_U2860 = 3;
        }
        else if (( /* F_CHECK_QUIT_RETRY */ sub_46493( 0 )) == 1)
        {
            if ((g_U819[7]._fU40 != 4) AND (g_U819[7]._fU40 != 0))
            {
                 /* WRITESCRIPTLOG */ sub_803( "GA", "Shutting down script for Chopshop.", 0 );
                g_U3041 = 1;
                 /* P_RESET_CHECKPOINT_THREAD */ sub_46382( ref g_U819[7] );
                SET_EXITFLAG_FOR_SCRIPT( g_U819[7]._fU32 );
                g_U3437[7] = 0;
                g_U3437[8] = 1;
            }
            l_U2860 = 3;
        }
        break;
        case 3:
        if (NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
        {
             /* WRITESCRIPTLOG */ sub_803( "CCB", "Deactivating bullettime...", 0 );
            DEACTIVATE_BULLET_TIME( 1, 0 );
            END_POSTFX_BLENDER( 3, 0 );
            l_U2860 = 4;
             /* WRITESCRIPTLOG */ sub_803( "CCB", "eFailure - STATE_FAIL_CLEANUP", 0 );
        }
        break;
        case 4:
        if (NOT (IS_PLAYER_DEAD(  /* PLAYER_ID */ sub_11416() )))
        {
            if (NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
            {
                SET_PLAYER_CONTROL(  /* PLAYER_ID */ sub_11416(), 0, 0 );
            }
        }
        END_CONTEXT( "NYBAR_MPM" );
         /* P_IMAGEFX_STOP_BULLETCAM */ sub_47765( "NY_PASSOS4_SCRIPTED_FAIL_FX" );
         /* P_IMAGEFX_STOP_BULLETCAM */ sub_47765( "NY_PASSOS5_SCRIPTED_FAIL_FX" );
         /* P_IMAGEFX_STOP_BULLETCAM */ sub_47765( "NY_MPM_SCRIPTED_FAIL_FX" );
        DESTROY_ALL_CAMS();
        RENDER_SCRIPT_CAMS( 0, 0, 3000, 0 );
        SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
         /* UNREGISTER_TOWER_ENTITIES */ sub_27962();
        ISEQ_UNREGISTER_ENTITY( 1419096468, "ny_mpm_max" );
         /* TERMINATEISEQ */ sub_28029( 1419096468, 1 );
         /* WRITESCRIPTLOG */ sub_803( "CCB", "Destroying Passos...", 0 );
        ISEQ_UNREGISTER_ENTITY( -1202559929, "passos" );
         /* TERMINATEISEQ */ sub_28029( -1202559929, 1 );
        ISEQ_UNREGISTER_ENTITY( -223586764, "passos" );
         /* TERMINATEISEQ */ sub_28029( -223586764, 1 );
        ISEQ_UNREGISTER_ENTITY( 1103749565, "max" );
         /* TERMINATEISEQ */ sub_28029( 1103749565, 1 );
        ISEQ_UNREGISTER_ENTITY( -1222535398, "passos" );
         /* TERMINATEISEQ */ sub_28029( -1222535398, 1 );
        ISEQ_UNREGISTER_ENTITY( 637400269, "passos" );
         /* TERMINATEISEQ */ sub_28029( 637400269, 1 );
         /* CLEANPED */ sub_21861( g_U818 );
         /* UNLOADANIMDICT */ sub_34599( "FACE_PASNYB" );
         /* UNLOADACTIONTREE */ sub_48314( "LEVEL/S_NYBAR/S_NYBAR_PASSOS_FACIAL.act" );
        if (g_U780 == 4)
        {
             /* WRITESCRIPTLOG */ sub_803( "BSW", "MCE_ROOFTOPS_2, skipping cleanup", 0 );
        }
        else
        {
             /* CLEANUP_ROOFTOP */ sub_48425();
        }
        l_U2860 = 5;
         /* WRITESCRIPTLOG */ sub_803( "CCB", "eFailure - STATE_FAIL_RESTORE", 0 );
        break;
        case 5:
         /* SETUP_ROOFTOP_STATIC_DATA */ sub_3327();
         /* INITIALIZE_ROOFTOP_SCRIPT_DATA */ sub_9817();
        SET_SCRIPT_CONTROL_RESET_ON_PLAYER_DEATH( 1 );
        if (NOT IS_BULLET_CAMERA_TO_GAMEPLAY_ALLOWED())
        {
            ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 1, 0 );
        }
         /* P_SETUP_PLAYER_RELATIONSHIPS */ sub_49030();
         /* CREATETIMER */ sub_10316( ref l_U2861, 20000, 1, 0 );
         /* STARTTIMER */ sub_34724( ref l_U2861 );
        l_U2860 = 6;
         /* WRITESCRIPTLOG */ sub_803( "CCB", "eFailure - STATE_FAIL_RESTART", 0 );
        break;
        case 6:
        if (GET_NUMBER_OF_STREAMING_REQUESTS() == 0)
        {
             /* WRITESCRIPTLOG */ sub_803( "CCB", "eFailure - STATE_FAIL_IDLE", 0 );
            if (g_U780 == 2)
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "Restoring player to ROOFTOP Checkpoint", 0 );
                 /* P_RESTORE_PLAYER_DATA_CHECKPOINT */ sub_11472( ref l_U349,  /* PLAYER_PED_ID */ sub_11378() );
                 /* LOADSEAMLESSCUTSCENE */ sub_29445( l_U2600, 1 );
                while ((NOT ( /* ISTIMERDONE */ sub_44221( ref l_U2861 ))) AND ((GET_STABLE_NUM_OF_STREAMING_REQUESTS() > 0) || (GET_NUMBER_OF_STREAMING_REQUESTS() > 0)))
                {
                     /* WRITESCRIPTLOG */ sub_803( "bsw", "waiting for streaming on respawn", 0 );
                    WAIT( 0 );
                }
                 /* CREATE_ROOFTOP_ENEMIES_AND_PASSOS */ sub_20738();
                 /* P_CREATE_GRILL */ sub_26362();
                SET_TRAFFIC_SYSTEM( 1 );
                 /* P_CLOSEDOOR */ sub_29790( ref g_U2860, 1 );
                 /* P_SETDOORLOCKED */ sub_30047( ref g_U2860, 1 );
                l_U2595 = 2;
                l_U2596 = 2;
                l_U2853 = 2;
            }
            if (g_U780 == 3)
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "Restoring player to ROOFTOP MPM Checkpoint", 0 );
                 /* P_RESTORE_PLAYER_DATA_CHECKPOINT */ sub_11472( ref l_U385,  /* PLAYER_PED_ID */ sub_11378() );
                while ((NOT ( /* ISTIMERDONE */ sub_44221( ref l_U2861 ))) AND ((GET_STABLE_NUM_OF_STREAMING_REQUESTS() > 0) || (GET_NUMBER_OF_STREAMING_REQUESTS() > 0)))
                {
                     /* WRITESCRIPTLOG */ sub_803( "bsw", "waiting for streaming on respawn", 0 );
                    WAIT( 0 );
                }
                SET_TRAFFIC_SYSTEM( 1 );
                l_U2291 = 0;
                 /* CREATE_TOWER_FOR_ROOFTOPS */ sub_27924( 1 );
                 /* LOADSEAMLESSCUTSCENE */ sub_29445( ref l_U2704, 1 );
                l_U2595 = 3;
                l_U2596 = 3;
                l_U2853 = 9;
                l_U2854 = 1;
            }
            if (g_U780 == 4)
            {
                 /* WRITESCRIPTLOG */ sub_803( "BSW", "Restoring player to MCE_ROOFTOPS_2 Checkpoint", 0 );
                 /* P_RESTORE_PLAYER_DATA_CHECKPOINT */ sub_11472( ref l_U421,  /* PLAYER_PED_ID */ sub_11378() );
                 /* CREATE_PASSOS_ROOFTOP_MPM */ sub_30663();
                SET_TRAFFIC_SYSTEM( 1 );
                 /* LOADISEQ */ sub_1517( -1236175571, 1 );
                l_U2291 = 1;
                if (IS_SCREEN_FADED_OUT())
                {
                    DO_SCREEN_FADE_IN( 500 );
                }
                if (NOT (DOES_OBJECT_EXIST( l_U2048 )))
                {
                     /* CREATE_DESTROYED_TOWER */ sub_31193();
                }
                l_U2595 = 4;
                l_U2596 = 4;
                l_U2853 = 10;
            }
            if (g_U780 == 5)
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "Restoring player to ABANDONED Checkpoint", 0 );
                 /* P_RESTORE_PLAYER_DATA_CHECKPOINT */ sub_11472( ref l_U457,  /* PLAYER_PED_ID */ sub_11378() );
                 /* LOADISEQ */ sub_1517( -223586764, 1 );
                 /* LOADISEQ */ sub_1517( 1103749565, 1 );
                 /* LOADISEQ */ sub_1517( -1222535398, 1 );
                 /* LOADANIMDICT */ sub_1344( "FACE_PASNYB", 0, 1 );
                 /* LOADACTIONTREE */ sub_1836( "LEVEL/S_NYBAR/S_NYBAR_PASSOS_FACIAL.act", 1 );
                while ((NOT ( /* ISTIMERDONE */ sub_44221( ref l_U2861 ))) AND ((GET_STABLE_NUM_OF_STREAMING_REQUESTS() > 0) || (GET_NUMBER_OF_STREAMING_REQUESTS() > 0)))
                {
                     /* WRITESCRIPTLOG */ sub_803( "bsw", "waiting for streaming on respawn", 0 );
                    WAIT( 0 );
                }
                SET_TRAFFIC_SYSTEM( 0 );
                 /* CREATE_PASSOS_ABANDONED_BUILDING */ sub_31552();
                 /* CREATE_ABANDONED_FLOOR1 */ sub_31828();
                SET_GAMEPLAY_CAM_RELATIVE_HEADING( g_U3141[5]._fU16, 1065353216, 0 );
                SET_GAMEPLAY_CAM_RELATIVE_PITCH( g_U3141[5]._fU20, 1065353216, 0 );
                if (NOT ( /* F_IMAGEFX_FADE_IN */ sub_50328()))
                {
                     /* P_FADE_IN_AND_WAIT */ sub_34870( 0 );
                    if (IS_DEATH_PANEL_WIPE_ALLOWED())
                    {
                        DO_SCREEN_FADE_IN( 0 );
                    }
                }
                l_U2291 = 1;
                l_U2595 = 5;
                l_U2596 = 5;
                 /* CLEANUP_ROOFTOP_ASSETS_FOR_ABANDONED_BUILDING */ sub_33922();
                 /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2561, 4000 );
                l_U2853 = 12;
            }
            if (g_U780 == 6)
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "INITIALIZE_PLAYER_BY_CHECKPOINT says we're in MCE_ABANDONED_BUILDING_2", 0 );
                 /* P_RESTORE_PLAYER_DATA_CHECKPOINT */ sub_11472( ref l_U493,  /* PLAYER_PED_ID */ sub_11378() );
                ENABLE_STATIC_EMITTER( "S_NYC2_SE_CHOP_SHOP_TOOLS", 0 );
                 /* LOADISEQ */ sub_1517( -1202559929, 1 );
                 /* LOADISEQ */ sub_1517( -223586764, 1 );
                 /* LOADISEQ */ sub_1517( 637400269, 1 );
                 /* LOADISEQ */ sub_1517( 1103749565, 1 );
                 /* LOADANIMDICT */ sub_1344( "FACE_PASNYB", 0, 1 );
                 /* LOADACTIONTREE */ sub_1836( "LEVEL/S_NYBAR/S_NYBAR_PASSOS_FACIAL.act", 1 );
                DISPLAYF( "GET_NUMBER_OF_STREAMING_REQUESTS: {}", 1, 513, GET_NUMBER_OF_STREAMING_REQUESTS() );
                DISPLAYF( "GET_STABLE_NUM_OF_STREAMING_REQUESTS: {}", 1, 513, GET_STABLE_NUM_OF_STREAMING_REQUESTS() );
                while ((NOT ( /* ISTIMERDONE */ sub_44221( ref l_U2861 ))) AND ((GET_STABLE_NUM_OF_STREAMING_REQUESTS() > 0) || (GET_NUMBER_OF_STREAMING_REQUESTS() > 0)))
                {
                     /* WRITESCRIPTLOG */ sub_803( "bsw", "waiting for streaming on respawn", 0 );
                    WAIT( 0 );
                }
                 /* CREATE_PASSOS_ABANDONED_BUILDING_2 */ sub_35183();
                SET_TRAFFIC_SYSTEM( 0 );
                 /* CLEANUP_ROOFTOP_ASSETS_FOR_ABANDONED_BUILDING */ sub_33922();
                if (NOT ( /* F_IMAGEFX_FADE_IN */ sub_50328()))
                {
                    if ((IS_DEATH_PANEL_WIPE_ALLOWED()) || ((IS_SCREEN_FADING_OUT()) || (IS_SCREEN_FADED_OUT())))
                    {
                        DO_SCREEN_FADE_IN( 500 );
                    }
                }
                l_U2003 = 1;
                l_U2595 = 6;
                l_U2596 = 6;
                l_U2853 = 14;
                l_U2291 = 1;
            }
            if ( /* IS_MAX_VALID */ sub_35429())
            {
                SET_PED_INVINCIBLE(  /* PLAYER_PED_ID */ sub_11378(), 0 );
                SET_PLAYER_CONTROL(  /* PLAYER_ID */ sub_11416(), 1, 0 );
                SET_PED_VISIBLE(  /* PLAYER_PED_ID */ sub_11378(), 1 );
                SET_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378(), 0 );
            }
            l_U2359 = 0;
            g_U3040 = 0;
            g_U3437[8] = 0;
            l_U2860 = 0;
             /* WRITESCRIPTLOG */ sub_803( "CCB", "eCheckpoint - STATE_CHECKPOINT_INIT", 0 );
        }
        else
        {
             /* WRITESCRIPTLOG */ sub_803( "CCB", "Waiting for stream requests...", 0 );
        }
        break;
    }
    return;
}

/* P_SETUP_PASSOS_DEATH */ void sub_41007(unknown uParam0)
{
    string sVar3;
    string sVar4;
    string sVar5;
    string sVar6;
    string sVar7;

     /* WRITESCRIPTLOG */ sub_803( "NS", "P_SETUP_PASSOS_DEATH()", 0 );
    sVar3 = "";
    sVar4 = "";
    sVar5 = "";
    sVar6 = "";
    sVar7 = "";
    switch (l_U278)
    {
        case 0:
        sVar4 = "S_NYB_FAIL_09A";
        sVar5 = "S_NYB_FAIL_09B";
        sVar6 = "S_NYB_FAIL_09C";
        sVar7 = "S_NYB_FAIL_09D";
        sVar3 = "MISS_FAIL_04";
        break;
        case 1:
        sVar4 = "S_NYB_FAIL_10A";
        sVar5 = "S_NYB_FAIL_10B";
        sVar3 = "MISS_FAIL_08";
        break;
        case 2:
        sVar4 = "S_NYB_FAIL_11A";
        sVar5 = "S_NYB_FAIL_11B";
        sVar6 = "S_NYB_FAIL_11C";
        sVar7 = "S_NYB_FAIL_11D";
        sVar3 = "MISS_FAIL_04";
        break;
        case 3:
        sVar4 = "S_NYB_FAIL_12A";
        sVar5 = "S_NYB_FAIL_12B";
        sVar6 = "S_NYB_FAIL_12C";
        sVar7 = "S_NYB_FAIL_12D";
        sVar3 = "MISS_FAIL_04";
        break;
        case 4:
        sVar4 = "S_NYB_FAIL_13A";
        sVar5 = "S_NYB_FAIL_13B";
        sVar6 = "S_NYB_FAIL_13C";
        sVar7 = "S_NYB_FAIL_13D";
        sVar3 = "MISS_FAIL_05";
        break;
    }
    ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 0, 1 );
     /* P_RUN_AND_PLAY_DEATH_CAM */ sub_41626( sVar3, sVar4, sVar5, sVar6, sVar7, uParam0 );
    l_U278++;
    if (l_U278 == 5)
    {
        l_U278 = 0;
    }
    return;
}

/* P_RUN_AND_PLAY_DEATH_CAM */ void sub_41626(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5)
{
     /* WRITESCRIPTLOG */ sub_803( "NS", "P_SETUP_AND_PLAY_DEATH_CAM()", 0 );
    uParam5 = uParam5;
    if (NOT (IS_STRING_NULL( uParam1 )))
    {
        SET_PRESET_TEXT( uParam0, 0, 0, "" );
    }
    if (NOT (IS_STRING_NULL( uParam2 )))
    {
        SET_PRESET_TEXT( uParam0, 0, 1, "" );
    }
    if (NOT (IS_STRING_NULL( uParam3 )))
    {
        SET_PRESET_TEXT( uParam0, 0, 2, "" );
    }
    if (NOT (IS_STRING_NULL( uParam4 )))
    {
        SET_PRESET_TEXT( uParam0, 0, 3, "" );
    }
    return;
}

/* PLAY_MIDSCENE_05A_PASSOS_DEATH */ int sub_41972(unknown uParam0)
{
    switch (l_U2359)
    {
        case 0:
         /* WRITESCRIPTLOG */ sub_803( "CCB", "PLAY_MIDSCENE_05A_PASSOS_DEATH: ePassosDeathCamState - STATE_DEATHCAM_INIT", 0 );
         /* NIS_PRE_SETUP */ sub_42160( 1, 0, 0, 1 );
         /* LOADISEQ */ sub_1517( -1222535398, 1 );
        if ( /* IS_MAX_VALID */ sub_35429())
        {
             /* TELEPORTPED */ sub_30319(  /* PLAYER_PED_ID */ sub_11378(), -240.57000000, 0.44000000, 1.73000000, 0 );
            SET_PED_VISIBLE(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        }
        if (ISEQ_QUERY_ENTITY_STATE( -1202559929, "passos", 3 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "Vig 17 was playing, kill it.  KILL IT NAOW!!!", 0 );
            ISEQ_UNREGISTER_ENTITY( -1202559929, "passos" );
             /* TERMINATEISEQ */ sub_28029( -1202559929, 1 );
        }
        if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
        {
            CLEAR_PED_TASKS_IMMEDIATELY( g_U818 );
             /* SETUP_PASSOS_FOR_FAILURE_SCENE */ sub_42546( ref g_U818 );
            ISEQ_REGISTER_ENTITY( -1222535398, "passos", g_U818, 0 );
            ISEQ_START( -1222535398 );
        }
         /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2785, -237.80000000, -6.89000000, 1.73000000, 30, uParam0, 7, 3, 2, 0, 0 );
         /* CLEANPED */ sub_21861( l_U2798 );
        l_U2798 =  /* CREATEPED */ sub_21953( ref l_U2785 );
        if ( /* IS_PED_VALID */ sub_22677( l_U2798 ))
        {
             /* SETUP_KILLER_FOR_FAILURE_CUTSCENES */ sub_42989( ref l_U2798 );
             /* F_GIVEPEDWEAPON */ sub_13920( l_U2798, -862236369, 25000, 0, 0 );
            SET_ROOM_FOR_PED_BY_NAME( l_U2798, ref g_U3553 );
            REGISTER_TARGET( l_U2798, g_U818 );
            SET_PED_DEFAULT_AIM_AT_PED( l_U2798, g_U818 );
            TASK_AIM_GUN_AT_PED( l_U2798, g_U818, -1, 0 );
        }
         /* NIS_CREATE_STATIC_CAM */ sub_43223( ref l_U2745, -243.57520000, 0.20469900, 2.07655300, 9.14803700, -0.00000300, -140.61300000, 45, 7000 );
         /* P_IMAGEFX_START_BULLETCAM */ sub_43485( "NY_PASSOS4_SCRIPTED_FAIL_FX", 0 );
        l_U2359 = 3;
         /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_START", 0 );
        case 3:
         /* NIS_PLAY_STATIC_CAMERA */ sub_43941( ref l_U2745 );
        SHAKE_CAM( l_U2745._fU0,  /* F_CAM_SHAKE_WOBBLY */ sub_44057(), 0.25000000 );
         /* CREATETIMER */ sub_10316( ref l_U2776, 500, 1, 0 );
         /* STARTTIMER */ sub_34724( ref l_U2776 );
        l_U2359 = 2;
         /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_WAITING", 0 );
        break;
        case 2:
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2776 ))
        {
            if (( /* IS_PED_VALID */ sub_22677( g_U818 )) AND ( /* IS_PED_VALID */ sub_22677( l_U2798 )))
            {
                SET_PED_SHOOTS_AT_COORD( l_U2798, "[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_BONE_COORDS( g_U818, 65488, 0, 0, 0 ) );
                SHAKE_CAM( l_U2745._fU0, "SMALL_EXPLOSION_SHAKE", 1 );
                 /* P_KILL_PED */ sub_44507( g_U818 );
                 /* CREATETIMER */ sub_10316( ref l_U2776, 500, 1, 0 );
                 /* STARTTIMER */ sub_34724( ref l_U2776 );
                l_U2359 = 5;
                 /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_PLAYING", 0 );
            }
        }
        break;
        case 5:
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2776 ))
        {
            l_U2359 = 6;
             /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_FINISHED", 0 );
        }
        break;
        case 6:
        return 1;
        break;
    }
    return 0;
}

/* NIS_PRE_SETUP */ void sub_42160(int iParam0, int iParam1, unknown uParam2, boolean bParam3)
{
    END_POSTFX_BLENDER( 12, 0 );
    if (bParam3)
    {
        STOP_ALL_IMAGEFX( 0 );
    }
    SET_WIDESCREEN_BORDERS( 1, 500 );
    DISPLAY_HUD( 0 );
    if (iParam0 == 1)
    {
        if (NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
        {
            SET_PLAYER_CONTROL(  /* PLAYER_ID */ sub_11416(), 0, uParam2 );
            SET_PED_DUCKING(  /* PLAYER_PED_ID */ sub_11378(), 0 );
            if (iParam1 == 1)
            {
                CLEAR_PED_TASKS_IMMEDIATELY(  /* PLAYER_PED_ID */ sub_11378() );
            }
            SET_PED_INVINCIBLE(  /* PLAYER_PED_ID */ sub_11378(), 1 );
        }
    }
    DEACTIVATE_BULLET_TIME( 1, 0 );
    return;
}

/* SETUP_PASSOS_FOR_FAILURE_SCENE */ void sub_42546(unknown uParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "P_SETUP_PASSOS_FOR_FAILURE_SCENE", "***" );
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( (uParam0^), 1 );
        SET_PED_CAN_TRIGGER_BULLET_CAM( (uParam0^), 0 );
        SET_PED_VALIDATE_BULLET_CAM_HIT( (uParam0^), 1 );
        SET_AI_SHOULD_ALWAYS_MISS_PED( (uParam0^), 0 );
        SET_CAN_AI_KICK_THROUGH_CORPSES( (uParam0^), 1 );
        "[doubled result, dropped if not asigned]";
        "[doubled result, dropped if not asigned]";
        SET_PED_AI_TEMPLATE( (uParam0^), "AIT_NORMAL" );
        SET_PED_ONLY_DAMAGED_BY_PLAYER( (uParam0^), 0 );
        SET_PED_AS_ONE_SHOT_KILL( (uParam0^), 1 );
        SET_PED_GORE( (uParam0^), 1 );
        SET_PED_CAN_RAGDOLL_FROM_PLAYER_IMPACT( (uParam0^), 0 );
        SET_PED_PROOFS( (uParam0^), 0, 1, 1, 1, 1 );
        SET_PED_ALLOWED_TO_SURRENDER( (uParam0^), 0 );
        SET_PED_CAN_AVOID_DEATH_ZONES( (uParam0^), 0 );
        SET_PED_STAND_GROUND_ON_PLAYER_IMPACT( (uParam0^), 1 );
        SET_PED_CAN_PUSH_PLAYER( (uParam0^), 1 );
        SET_PED_RESIST_TO_OBJECT_COLLISION( (uParam0^), 0 );
        "[doubled result, dropped if not asigned]";
        "[doubled result, dropped if not asigned]";
        SET_PED_CAN_BE_TARGETTED( (uParam0^), 1 );
    }
    return;
}

/* SETUP_KILLER_FOR_FAILURE_CUTSCENES */ void sub_42989(unknown uParam0)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        CLEAR_PED_TASKS_IMMEDIATELY( (uParam0^) );
        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( (uParam0^), 1 );
        SET_PED_COMBAT_MOVEMENT( (uParam0^), 0 );
    }
    return;
}

/* NIS_CREATE_STATIC_CAM */ void sub_43223(int iParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8)
{
    iParam0->_fU4 = {uParam4};
    iParam0->_fU16 = {uParam1};
    iParam0->_fU28 = uParam7;
    iParam0->_fU32 = 0;
    iParam0->_fU36 = 0;
    iParam0->_fU84 = uParam8;
    iParam0->_fU88 = 0;
    iParam0->_fU92 = 0;
    iParam0->_fU40 = 0;
    iParam0->_fU44 = 0;
    iParam0->_fU100 = 1;
    iParam0->_fU104 = 1;
    iParam0->_fU96 = 0;
     /* CREATETIMER */ sub_10316( iParam0 + 48, uParam8, 1, 0 );
    iParam0->_fU0 = CREATE_CAM_WITH_PARAMS( ref g_U649, iParam0->_fU16, iParam0->_fU4, iParam0->_fU28, 1 );
    SET_CAM_PARAMS( iParam0->_fU0, iParam0->_fU16, iParam0->_fU4, iParam0->_fU28, 0, 1, 1 );
    return;
}

/* P_IMAGEFX_START_BULLETCAM */ void sub_43485(unknown uParam0, boolean bParam1)
{
    PRINTSTRING( "[CO] P_IMAGEFX_START_BULLETCAM: Starting BulletCam: " );
    PRINTSTRING( uParam0 );
    PRINTNL();
     /* CLEANCAMERA */ sub_43605( ref l_U276 );
    l_U276 = CREATE_CAM( "DEFAULT_BULLET_CAMERA", 1 );
    SETUP_BULLET_CAMERA_SCENE( l_U276, uParam0, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, "", "" );
    if (bParam1)
    {
        RENDER_SCRIPT_CAMS( 1, 0, 3000, 0 );
    }
    return;
}

/* CLEANCAMERA */ void sub_43605(unknown uParam0)
{
    if ((DOES_CAM_EXIST( (uParam0^) )) == 1)
    {
        if ((IS_CAM_ACTIVE( (uParam0^) )) == 1)
        {
            SET_CAM_ACTIVE( (uParam0^), 0 );
        }
        DESTROY_CAM( (uParam0^) );
    }
    (uParam0^) = nil;
    return;
}

/* NIS_PLAY_STATIC_CAMERA */ void sub_43941(int iParam0)
{
    RENDER_SCRIPT_CAMS( 0, 0, 3000, 0 );
    SET_CAM_ACTIVE( iParam0->_fU0, 1 );
    RENDER_SCRIPT_CAMS( 1, 0, 3000, 0 );
     /* STARTTIMER */ sub_34724( iParam0 + 48 );
    iParam0->_fU32 = 1;
    iParam0->_fU40 = 1;
    return;
}

/* F_CAM_SHAKE_WOBBLY */ string sub_44057()
{
    return "WOBBLY_SHAKE";
}

/* ISTIMERDONE */ int sub_44221(int iParam0)
{
    if (iParam0->_fU16)
    {
        return 0;
    }
    else if (NOT iParam0->_fU20)
    {
        return 0;
    }
    if (iParam0->_fU28)
    {
        iParam0->_fU4 = TIMERA();
    }
    else
    {
        iParam0->_fU4 = TIMERB();
    }
    if (iParam0->_fU32 == 1)
    {
        iParam0->_fU4 = TIMERSYSTEM();
    }
    if ((iParam0->_fU4 - iParam0->_fU0) >= iParam0->_fU12)
    {
        iParam0->_fU16 = 1;
        iParam0->_fU20 = 0;
        return 1;
        break;
    }
    return 0;
}

/* P_KILL_PED */ void sub_44507(unknown uParam0)
{
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        STOP_PED_SPEAKING( uParam0, 1 );
        SET_PED_HEALTH( uParam0, 0, 0 );
        SET_PED_CORPSE( uParam0, 0 );
    }
    return;
}

/* PLAY_MIDSCENE_05B_PASSOS_DEATH */ int sub_44860(unknown uParam0)
{
    switch (l_U2359)
    {
        case 0:
         /* LOADISEQ */ sub_1517( 637400269, 1 );
        if ( /* IS_MAX_VALID */ sub_35429())
        {
             /* TELEPORTPED */ sub_30319(  /* PLAYER_PED_ID */ sub_11378(), -244.42000000, -19.82000000, 5.13000000, 0 );
            SET_PED_VISIBLE(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        }
        if (ISEQ_QUERY_ENTITY_STATE( -1202559929, "passos", 3 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "Vig 17 was playing, kill it.  KILL IT NAOW!!!", 0 );
            ISEQ_UNREGISTER_ENTITY( -1202559929, "passos" );
             /* TERMINATEISEQ */ sub_28029( -1202559929, 1 );
        }
        if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
        {
            CLEAR_PED_TASKS_IMMEDIATELY( g_U818 );
             /* TELEPORTPED */ sub_30319( g_U818, -242.16750000, -25.48294000, 5.10000000, 180.00000000 );
            SET_ROOM_FOR_PED_BY_NAME( g_U818, ref g_U3561 );
             /* SETUP_PASSOS_FOR_FAILURE_SCENE */ sub_42546( ref g_U818 );
            ISEQ_REGISTER_ENTITY( 637400269, "passos", g_U818, 0 );
            ISEQ_START( 637400269 );
        }
         /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2839, -245.94850000, -19.94804000, 5.13012800, 210, uParam0, 7, 3, 2, 0, 0 );
         /* CLEANPED */ sub_21861( l_U2852 );
        l_U2852 =  /* CREATEPED */ sub_21953( ref l_U2839 );
        if ( /* IS_PED_VALID */ sub_22677( l_U2852 ))
        {
            SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( l_U2852, 1 );
             /* SETUP_KILLER_FOR_FAILURE_CUTSCENES */ sub_42989( ref l_U2852 );
             /* F_GIVEPEDWEAPON */ sub_13920( l_U2852, -862236369, 25000, 0, 0 );
            SET_ROOM_FOR_PED_BY_NAME( l_U2852, ref g_U3561 );
            REGISTER_TARGET( l_U2852, g_U818 );
            SET_PED_DEFAULT_AIM_AT_PED( l_U2852, g_U818 );
            TASK_AIM_GUN_AT_PED( l_U2852, g_U818, -1, 0 );
        }
         /* NIS_CREATE_STATIC_CAM */ sub_43223( ref l_U2799, -242.49370000, -27.48373000, 5.59246100, 16.02845000, -0.00000200, 23.18072000, 45, 7000 );
        l_U2359 = 1;
         /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_ONE_TICK_FOR_TELEPORT", 0 );
        break;
        case 1:
        if ( /* IS_MAX_VALID */ sub_35429())
        {
            SET_ROOM_FOR_PED_BY_NAME(  /* PLAYER_PED_ID */ sub_11378(), ref g_U3561 );
            SET_PED_VISIBLE(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        }
         /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_START", 0 );
        l_U2359 = 3;
        case 3:
         /* NIS_PLAY_STATIC_CAMERA */ sub_43941( ref l_U2799 );
        SHAKE_CAM( l_U2799._fU0,  /* F_CAM_SHAKE_WOBBLY */ sub_44057(), 0.25000000 );
         /* P_IMAGEFX_START_BULLETCAM */ sub_43485( "NY_PASSOS5_SCRIPTED_FAIL_FX", 0 );
         /* CREATETIMER */ sub_10316( ref l_U2830, 500, 1, 0 );
         /* STARTTIMER */ sub_34724( ref l_U2830 );
        l_U2359 = 2;
         /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_WAITING", 0 );
        break;
        case 2:
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2830 ))
        {
            if (( /* IS_PED_VALID */ sub_22677( g_U818 )) AND ( /* IS_PED_VALID */ sub_22677( l_U2852 )))
            {
                SET_PED_SHOOTS_AT_COORD( l_U2852, "[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_BONE_COORDS( g_U818, 65488, 0, 0, 0 ) );
                SHAKE_CAM( l_U2799._fU0, "SMALL_EXPLOSION_SHAKE", 1 );
                 /* P_KILL_PED */ sub_44507( g_U818 );
                 /* CREATETIMER */ sub_10316( ref l_U2830, 500, 1, 0 );
                 /* STARTTIMER */ sub_34724( ref l_U2830 );
                l_U2359 = 5;
                 /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_PLAYING", 0 );
            }
        }
        break;
        case 5:
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2830 ))
        {
            l_U2359 = 6;
             /* WRITESCRIPTLOG */ sub_803( "CCB", "ePassosDeathCamState - STATE_DEATHCAM_FINISHED", 0 );
        }
        break;
        case 6:
        return 1;
        break;
    }
    return 0;
}

/* IS_RESTART_ACTIVE */ void sub_46239()
{
    return g_U648;
}

/* P_RESET_CHECKPOINT_THREAD */ void sub_46382(int iParam0)
{
    iParam0->_fU36 = 0;
    iParam0->_fU40 = 0;
    return;
}

/* F_CHECK_QUIT_RETRY */ int sub_46493(int iParam0)
{
    iParam0 = 1;
    switch (l_U263)
    {
        case 0:
        if (NOT ( /* HASTIMERBEENACTIVATED */ sub_46575( ref l_U265 )))
        {
            if ((IS_DEATH_PANEL_WIPE_ALLOWED()) AND (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
            {
                l_U264 = 2000;
                ALLOW_BULLET_CAMERA_TO_GAMEPLAY( 0, 1 );
            }
             /* CREATETIMER */ sub_10316( ref l_U265, l_U264, 1, 1 );
             /* STARTTIMER */ sub_34724( ref l_U265 );
        }
        if ( /* ISTIMERDONE */ sub_44221( ref l_U265 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "NS", " show fail/retry text", 0 );
            if ((IS_DEATH_PANEL_WIPE_ALLOWED()) AND (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
            {
                if ((IS_BULLET_CAMERA_RUNNING( 0 )) == 0)
                {
                    if (IS_SCREEN_FADED_OUT())
                    {
                        DO_SCREEN_FADE_IN( 0 );
                    }
                }
                ENABLE_DEATHHELPERTEXT( 1, 1, 0 );
            }
            else if (IS_SCREEN_FADED_OUT())
            {
                DO_SCREEN_FADE_IN( 0 );
                ENABLE_DEATHHELPERTEXT( 1, iParam0, 0 );
            }
            else
            {
                ENABLE_DEATHHELPERTEXT( 1, iParam0, 0 );
            }
            if (NOT (IS_PLAYER_DEAD(  /* PLAYER_ID */ sub_11416() )))
            {
                SET_PLAYER_CONTROL(  /* PLAYER_ID */ sub_11416(), 0, 0 );
            }
            DISPLAY_HUD( 0 );
            l_U263 = 1;
        }
        break;
        case 1:
        if ((((NOT IS_QUIT_CONFIRMING()) == 1) AND (IS_BUTTON_JUST_PRESSED( 0, 501 ))) || ((N_1855335259()) || (IS_CONTROL_JUST_PRESSED( 2, 82 ))))
        {
            if (IS_QUIT_CONFIRMING() == 1)
            {
                l_U263 = 2;
            }
            else
            {
                l_U263 = 3;
            }
        }
        break;
        case 2:
         /* WRITESCRIPTLOG */ sub_803( "NS", "Player will QUIT", 0 );
         /* P_POSTQUITRETRYCLEANUP */ sub_47058();
        if (iParam0 == 1)
        {
            DO_SCREEN_FADE_OUT( 0 );
        }
        START_PANEL_WIPE( 0, 6 );
        SET_EXITFLAG_FOR_SCRIPT( GET_ID_OF_THIS_THREAD() );
        RETURN_TO_TITLESCREEN( 0 );
        break;
        case 3:
         /* WRITESCRIPTLOG */ sub_803( "NS", "Player will RETRY", 0 );
        if (IS_IN_NYMINUTE_MODE())
        {
            SWITCH_TO_LEVEL( GET_INDEX_OF_CURRENT_LEVEL() );
        }
        if (iParam0 == 1)
        {
            DO_SCREEN_FADE_OUT( 0 );
        }
         /* P_POSTQUITRETRYCLEANUP */ sub_47058();
        return 1;
        break;
    }
    return 0;
}

/* HASTIMERBEENACTIVATED */ int sub_46575(int iParam0)
{
    if (iParam0->_fU20 == 1)
    {
        return 1;
    }
    if (iParam0->_fU16 == 1)
    {
        return 1;
    }
    return 0;
}

/* P_POSTQUITRETRYCLEANUP */ void sub_47058()
{
     /* WRITESCRIPTLOG */ sub_803( "NS", "P_PostFailRetryCleanup", 0 );
     /* RESETTIMER */ sub_10518( ref l_U265 );
    ENABLE_DEATHHELPERTEXT( 0, 0, 2000 );
    SET_SCRIPT_CONTROL_RESET_ON_PLAYER_DEATH( 0 );
    if (NOT (IS_PLAYER_DEAD(  /* PLAYER_ID */ sub_11416() )))
    {
        SET_PLAYER_CONTROL(  /* PLAYER_ID */ sub_11416(), 1, 0 );
    }
    DISPLAY_HUD( 1 );
    l_U262 = 0;
    l_U262 = l_U262;
    l_U263 = 0;
    return;
}

/* P_IMAGEFX_STOP_BULLETCAM */ void sub_47765(unknown uParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "CO", "P_IMAGEFX_STOP_BULLETCAM:  Cameras Deleted", 0 );
    RENDER_SCRIPT_CAMS( 0, 0, 3000, 0 );
     /* CLEANCAMERA */ sub_43605( ref l_U276 );
    l_U275 = 1;
    return;
}

/* UNLOADACTIONTREE */ void sub_48314(unknown uParam0)
{
    ACTION_TREE_UNLOAD( uParam0 );
    return;
}

/* CLEANUP_ROOFTOP */ void sub_48425()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CLEANUP_ROOFTOP", " " );
    CLEAR_PED_DEFAULT_AIM(  /* PLAYER_PED_ID */ sub_11378() );
    SET_PLAYER_FORCED_AIM(  /* PLAYER_ID */ sub_11416(), 0, 0 );
    ISEQ_UNREGISTER_ENTITY( -329975025, "thug0" );
    ISEQ_UNREGISTER_ENTITY( -329975025, "thug1" );
    ISEQ_UNREGISTER_ENTITY( -329975025, "thug2" );
     /* TERMINATEISEQ */ sub_28029( -329975025, 0 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1823 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1649 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1687 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1748 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1799 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1858 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1894 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1930 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U1992 );
     /* CLEANPEDARRAY */ sub_34079( ref l_U2206 );
     /* CLEANPED */ sub_21861( l_U2798 );
     /* CLEANPED */ sub_21861( l_U2852 );
     /* CLEANPLACEMENT */ sub_27496( g_U683._fU0 );
     /* CLEANPLACEMENT */ sub_27496( g_U737._fU0 );
     /* CLEANPLACEMENT */ sub_27496( g_U701._fU0 );
     /* CLEANPLACEMENTARRAY */ sub_48733( ref l_U2588 );
     /* CLEANOBJECT */ sub_26423( l_U2045 );
     /* CLEANOBJECT */ sub_26423( l_U2046 );
     /* CLEANOBJECT */ sub_26423( l_U2047 );
     /* CLEANOBJECT */ sub_26423( l_U2044 );
     /* DESTROY_TOWER */ sub_28881();
    if (IS_ACTION_TREE_LOADED( "Vehicle/Vehicle_Car.act" ))
    {
         /* UNLOADACTIONTREE */ sub_48314( "Vehicle/Vehicle_Car.act" );
    }
    return;
}

/* CLEANPLACEMENTARRAY */ void sub_48733(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* CLEANPLACEMENT */ sub_27496( (uParam0^)[I] );
    }
    return;
}

/* P_SETUP_PLAYER_RELATIONSHIPS */ void sub_49030()
{
     /* WRITESCRIPTLOG */ sub_803( "SP", "P_SETUP_PLAYER_RELATIONSHIPS", "###" );
    if ((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
    {
        SET_PED_RELATIONSHIP(  /* PLAYER_PED_ID */ sub_11378(), 0, 1 );
        SET_PED_RELATIONSHIP(  /* PLAYER_PED_ID */ sub_11378(), 0, 2 );
        SET_PED_RELATIONSHIP(  /* PLAYER_PED_ID */ sub_11378(), 0, 6 );
        SET_PED_RELATIONSHIP(  /* PLAYER_PED_ID */ sub_11378(), 0, 7 );
    }
    return;
}

/* F_IMAGEFX_FADE_IN */ int sub_50328()
{
    if (l_U275)
    {
         /* WRITESCRIPTLOG */ sub_803( "CO", "F_IMAGEFX_FADE_IN: IMAGEFX START", 0 );
        START_PANEL_WIPE( 0, 6 );
        PLAY_IMAGEFX( "BULLETCAM_IMPACT", 3, 1 );
        PLAY_IMAGEFX( "BLACK_FADE_UP_FAST_01", 3, 1 );
        DO_SCREEN_FADE_IN( 0 );
        l_U275 = 0;
        return 1;
        break;
    }
     /* WRITESCRIPTLOG */ sub_803( "CO", "F_IMAGEFX_FADE_IN: NORMAL START", 0 );
    return 0;
}

/* HANDLE_EVENTS */ void sub_51417()
{
    int iVar2;
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;

    if (l_U2860 == 0)
    {
        if ((l_U2853 > 2) AND (l_U2853 != 9))
        {
            if ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U991,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U970,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U928,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U865,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U844,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1)))))
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
        }
        switch (l_U2853)
        {
            case 4:
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - ROOFTOP_MID_05A_PASSOS_DEATH", 0 );
            l_U2859 = 0;
             /* DEACTIVATE_ALL_PEDS_FOR_DEATH_SCENE */ sub_52097();
            l_U2422 =  /* GET_SCENEPED_FOR_MID_05A */ sub_52180();
            g_U3040 = 1;
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_DONE", 0 );
            l_U2853 = 19;
            break;
            case 5:
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - ROOFTOP_MID_05B_PASSOS_DEATH", 0 );
            l_U2859 = 1;
             /* DEACTIVATE_ALL_PEDS_FOR_DEATH_SCENE */ sub_52097();
            l_U2422 =  /* GET_SCENEPED_FOR_MID_05B */ sub_52880();
            g_U3040 = 1;
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_DONE", 0 );
            l_U2853 = 19;
            break;
            case 0:
             /* WRITESCRIPTLOG */ sub_803( "RJM", "Loading MidScene02AB ", 0 );
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_WAIT_ROOFTOPS_TRIGGER", 0 );
             /* LOAD_INITIAL_ROOFTOP_ASSETS */ sub_940( 1 );
             /* P_CREATE_GRILL */ sub_26362();
            l_U2853 = 1;
            break;
            case 1:
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U529, 0 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "SBA", "HANDLE_EVENTS - Top of stairs, first time", 0 );
                g_U3437[5] = 1;
                 /* P_SETDOORLOCKED */ sub_30047( ref g_U2860, 0 );
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U550, 0 ))
            {
                 /* CREATE_ROOFTOP_ENEMIES_AND_PASSOS */ sub_20738();
                SET_TRAFFIC_SYSTEM( 1 );
                 /* SET_WEATHER_AND_TIME_OF_DAY_FOR_NYBAR */ sub_10751( 2, 0 );
                if (g_U780 != 2)
                {
                     /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U349, 2,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[2]._fU0, g_U3141[2]._fU12, g_U3141[2]._fU16, g_U3141[2]._fU20, 1 );
                    START_CONTEXT( "NYBAR_ROOFTOPS_TO_MPM" );
                    g_U780 = 2;
                }
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_WAIT_BLENDOUT", 0 );
                l_U2853 = 2;
            }
            break;
            case 2:
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_APARTMENT_ROOF", 0 );
             /* START_ROOF_PATROLLERS */ sub_53838();
             /* TRIGGER_APT_ROOF_GUYS */ sub_54134();
            if (NOT l_U1663)
            {
                 /* HANDLE_PATROL_REACTIONS */ sub_54383();
            }
            if (IS_DEATH_PANEL_WIPE_ALLOWED())
            {
                DO_SCREEN_FADE_IN( 0 );
            }
            if ((IS_SCREEN_FADING_OUT()) || (IS_SCREEN_FADED_OUT()))
            {
                DO_SCREEN_FADE_IN( 1000 );
            }
             /* LOAD_WATERTOWER_ASSETS */ sub_2247( 0 );
             /* LOADSEAMLESSCUTSCENE */ sub_29445( l_U2600, 0 );
             /* LOADMODEL */ sub_987( 1740663406, 0 );
             /* LOADWEAPON */ sub_2816( 1478009203, 0 );
             /* LOADWEAPON */ sub_2816( -1074756423, 0 );
             /* CREATETIMER */ sub_10316( ref l_U1664, 500, 1, 0 );
             /* STARTTIMER */ sub_34724( ref l_U1664 );
            l_U2853 = 3;
            break;
            case 3:
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1823, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1687, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1799, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1649, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1748, -1054867456, 0, 1 );
            if (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U886,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1)
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
             /* KILL_WAYWARD_PEDS */ sub_56340();
            if (NOT l_U1663)
            {
                 /* HANDLE_PATROL_REACTIONS */ sub_54383();
            }
            if ( /* ISTIMERDONE */ sub_44221( ref l_U1664 ))
            {
                if ( /* IS_PED_VALID */ sub_22677( l_U1649[2] ))
                {
                    PLAY_PED_AMBIENT_SPEECH( l_U1649[2], "ORDER_FIRE", 1, 0, 2, 0, 30000 );
                }
            }
            if (NOT ( /* F_ISDOORLOCKED */ sub_56830( ref g_U2860 )))
            {
                if (NOT ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U571 )))
                {
                    uVar13 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS(  /* PLAYER_PED_ID */ sub_11378() )};
                    if (uVar13._fU8 > 5.00000000)
                    {
                        if ((( /* F_GETDOOROPENRATIO */ sub_57048( ref g_U2860 )) < 0.05000000) || (NOT (IS_OBJECT_ON_SCREEN( DOOR_FIND_CLOSEST( g_U2860._fU0, g_U2860._fU4 ) ))))
                        {
                             /* WRITESCRIPTLOG */ sub_803( "SBA", "HANDLE_EVENTS - Locking door to stairs, ok to unload Apartment script", 0 );
                             /* P_SETDOORLOCKED */ sub_30047( ref g_U2860, 1 );
                            g_U3437[4] = 1;
                        }
                    }
                }
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U718, 0 ))
            {
                STREAM_HELPERS_REQUEST_AT_LOC( -522.09200000, -8.25800000, 10.23100000, 0 );
                 /* CREATE_TOWER_FOR_ROOFTOPS */ sub_27924( 1 );
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_MAIN_FIGHT", 0 );
                l_U2596 = 10;
                l_U2853 = 6;
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U676, 0 ))
            {
                 /* RELEASE_THE_PIGEONS */ sub_57387();
                 /* ACTIVATE_COVER_ROOF_GUYS */ sub_57543();
            }
            if (NOT l_U2293)
            {
                if (( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1799 )) == 0)
                {
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "Killed the Rooftop Cover guys before jumping down, start AGA timer", 0 );
                    l_U2293 = 1;
                     /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2341, 5000 );
                }
            }
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2341 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "AGA timer expired before jumping down, start tasking AGA peds.", 0 );
                l_U2294 = 1;
            }
            if (l_U2294)
            {
                 /* HANDLE_ROOFTOP_ENEMY_TASKING */ sub_58617();
            }
            if ((NOT l_U2292) AND ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U718 )))
            {
                 /* PED_ARRAY_SET_LOCK_TO_COVER */ sub_57824( ref l_U1799, 0 );
                l_U2292 = 1;
            }
            break;
            case 6:
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1823, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1687, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1799, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1649, -1054867456, 0, 1 );
             /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1748, -1054867456, 0, 1 );
            if (NOT l_U2300)
            {
                if ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U760 ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "Disabling shootdodge", 0 );
                    SET_PLAYER_CAN_USE_SHOOTDODGE(  /* PLAYER_ID */ sub_11416(), 0 );
                    l_U2300 = 1;
                }
            }
            else if (NOT ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U760 )))
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "Enabling shootdodge", 0 );
                SET_PLAYER_CAN_USE_SHOOTDODGE(  /* PLAYER_ID */ sub_11416(), 1 );
                l_U2300 = 0;
            }
            if (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U886,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1)
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
             /* KILL_WAYWARD_PEDS */ sub_56340();
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U571, 0 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "SBA", "HANDLE_EVENTS - Locking door to stairs", 0 );
                 /* P_SETDOORLOCKED */ sub_30047( ref g_U2860, 1 );
            }
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2534 ))
            {
                 /* P_SPEECH_PLAY_MAX_MONOLOGUE */ sub_60342( "SNYC_DPDP", ref l_U2453 );
            }
             /* HANDLE_ROOFTOP_ENEMY_TASKING */ sub_58617();
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U676, 0 ))
            {
                 /* RELEASE_THE_PIGEONS */ sub_57387();
                 /* ACTIVATE_COVER_ROOF_GUYS */ sub_57543();
            }
            if ((NOT l_U2292) AND ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U718 )))
            {
                 /* PED_ARRAY_SET_LOCK_TO_COVER */ sub_57824( ref l_U1799, 0 );
                l_U2292 = 1;
            }
            iVar2 = (((( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1748 )) + ( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1823 ))) + ( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1799 ))) + ( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1649 ))) + ( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1687 ));
            if (iVar2 == 1)
            {
                 /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1748 );
                 /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1823 );
                 /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1799 );
                 /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1649 );
                 /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1687 );
            }
            else if (iVar2 == 0)
            {
                if (NOT l_U2302)
                {
                     /* CREATE_PLANE */ sub_62075();
                     /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2534, 20000 );
                    l_U2302 = 1;
                }
                if (NOT l_U2301)
                {
                    l_U2596 = 11;
                    l_U2301 = 1;
                }
                if (NOT l_U2533)
                {
                    if ((NOT ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1306 ))) AND ((TIME_SINCE_LAST_MONOLOGUE() > 5000) AND ((NOT ( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404())) AND ((NOT (IS_PLAYER_DOING_MELEE_GRAPPLE(  /* PLAYER_ID */ sub_11416() ))) AND (NOT (IS_BULLET_CAMERA_RUNNING( 0 )))))))
                    {
                         /* P_SPEECH_PLAY_MAX_MONOLOGUE */ sub_60342( "SNYC_STOR", ref l_U2443 );
                        l_U2533 = 1;
                    }
                }
            }
            if ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U634 ))
            {
                RESET_PED_MODEL_LOD_DISTANCES( 233534649 );
                 /* KILL_ANY_MISSION_SPEECH */ sub_62586( 0 );
                 /* LOADSEAMLESSCUTSCENE */ sub_29445( l_U2600, 1 );
                 /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 0 );
                 /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2543, 750 );
                if ( /* IS_MAX_VALID */ sub_35429())
                {
                    SET_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378(), 1 );
                }
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_PRE_MIDSCENE_03", 0 );
                l_U2853 = 7;
            }
            break;
            case 7:
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2543 ))
            {
                 /* CLEANPEDARRAY */ sub_34079( ref l_U1748 );
                 /* CLEANPEDARRAY */ sub_34079( ref l_U1823 );
                 /* CLEANPEDARRAY */ sub_34079( ref l_U1799 );
                 /* CLEANPEDARRAY */ sub_34079( ref l_U1649 );
                 /* CLEANPEDARRAY */ sub_34079( ref l_U1687 );
                 /* CLEANOBJECT */ sub_26423( l_U2047 );
                 /* UNLOADANIMDICT */ sub_34599( "ny_anim" );
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_MIDSCENE_03", 0 );
                if (l_U2595 == 11)
                {
                    l_U2596 = 11;
                }
                l_U2853 = 8;
            }
            break;
            case 8: if ( /* PLAY_MIDSCENE_03 */ sub_63723( 1, 0, 0 ))
            {
                SET_GAMEPLAY_CAM_RELATIVE_HEADING( g_U3141[3]._fU16, 1065353216, 0 );
                SET_GAMEPLAY_CAM_RELATIVE_PITCH( g_U3141[3]._fU20, 1065353216, 0 );
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_MAX_PAYNE_MOMENT", 0 );
                SET_PLAYER_CAN_USE_SHOOTDODGE(  /* PLAYER_ID */ sub_11416(), 1 );
                l_U2291 = 0;
                l_U2854 = 1;
                l_U2853 = 9;
            }
            case 9:
            if ( /* HANDLE_ROOFTOP_MPM */ sub_68298())
            {
                if (g_U780 != 4)
                {
                     /* WRITESCRIPTLOG */ sub_803( "BSW", "updating current checkpoint to MCE_ROOFTOPS_2", 0 );
                    g_U780 = 4;
                     /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U421, 4,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[4]._fU0, g_U3141[4]._fU12, g_U3141[4]._fU16, g_U3141[4]._fU20, 0 );
                }
                 /* LOADISEQ */ sub_1517( 1103749565, 0 );
                 /* LOADISEQ */ sub_1517( -1202559929, 0 );
                 /* LOADISEQ */ sub_1517( -1236175571, 1 );
                 /* LOADANIMDICT */ sub_1344( "FACE_PASNYB", 0, 0 );
                 /* LOADACTIONTREE */ sub_1836( "LEVEL/S_NYBAR/S_NYBAR_PASSOS_FACIAL.act", 0 );
                l_U2853 = 10;
            }
            break;
            case 10:
            l_U2291 = 1;
            if ( /* HANDLE_MID_03C_BLENDOUT */ sub_79486())
            {
                if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
                {
                    CLEAR_PED_TASKS_IMMEDIATELY( g_U818 );
                     /* TELEPORTPED */ sub_30319( g_U818, -269.48690000, -3.07285600, 2.75137900, 90.00000000 );
                }
                 /* P_CREATE_S_NY2_GG_LM_02 */ sub_80532();
                if ( /* IS_MAX_VALID */ sub_35429())
                {
                    SET_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378(), 0 );
                }
                 /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2552, 100 );
                 /* INIT_HANDLE_PASSOS_WAITING_SPEECH */ sub_35528();
                l_U2853 = 11;
            }
            break;
            case 11:
            if (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U907,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1)
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1054, 0 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "BSW", "player is in trigger box: tbPostMPMLedgeUp", 0 );
                l_U2596 = 17;
            }
             /* P_HANDLE_MONO_MAX_ROOFTOPS2 */ sub_80928();
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U781, 0 ))
            {
                 /* CREATE_ABANDONED_FLOOR1 */ sub_31828();
            }
            if ( /* IS_PASSOS_VALID */ sub_33084())
            {
                if (NOT l_U2286)
                {
                     /* HANDLE_PASSOS_WAITING_SPEECH */ sub_81084( 13000, 3000 );
                    if ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1096 ))
                    {
                         /* KILL_HANDLE_PASSOS_WAITING_SPEECH */ sub_82060( 0 );
                         /* LOADISEQ */ sub_1517( -1202559929, 0 );
                        l_U2286 = 1;
                        CLEAR_PED_TASKS_IMMEDIATELY( g_U818 );
                        TASK_FOLLOW_NAV_MESH_TO_COORD( g_U818, -256.80000000, -1.12500000, 1.60600000, 3, -1, 1048576000, 0, 0 );
                        if (NOT ( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404()))
                        {
                             /* P_PLAY_DIAL_PASSOS */ sub_81564( ref l_U2219, ref uVar3 );
                        }
                    }
                }
                else if (NOT l_U2287)
                {
                    if ( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U823, g_U818, 0 ))
                    {
                         /* WRITESCRIPTLOG */ sub_803( "bsw", "Passos succesfully vaulted, time to teleport him", 0 );
                        l_U2287 = 1;
                         /* TELEPORTPED */ sub_30319( g_U818, g_U3425, g_U3428 );
                        ISEQ_REGISTER_ENTITY( -1202559929, "passos", g_U818, 0 );
                        ISEQ_START( -1202559929 );
                        PED_SET_ACTION_INTENTION( g_U818, 57, 1000, 0, 0, 0 );
                    }
                }
                else if (NOT l_U2288)
                {
                    if ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1075 ))
                    {
                         /* WRITESCRIPTLOG */ sub_803( "RJM", "Player's in the fucking trigger volume, make Passos run into the FUCKING BUILDING!!!!!", 0 );
                        l_U2288 = 1;
                        PED_SET_ACTION_INTENTION( g_U818, 47, 1000, 0, 0, 0 );
                         /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2350, 1500 );
                    }
                };;;
            }
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2350 ))
            {
                 /* P_PLAY_DIAL_PASSOS_MAX_ROOF2 */ sub_82963();
            }
            if (NOT l_U2289)
            {
                if ( /* IS_PASSOS_VALID */ sub_33084())
                {
                    if (PED_ANIM_EVENT( g_U818, 1477325977 ))
                    {
                         /* TASK_FRONT_GUYS_TO_FIRE_AT_PASSOS */ sub_83218();
                        l_U2289 = 1;
                    }
                }
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U802, 0 ))
            {
                if (g_U780 != 5)
                {
                    g_U780 = 5;
                     /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U457, 5,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[5]._fU0, g_U3141[5]._fU12, g_U3141[5]._fU16, g_U3141[5]._fU20, 1 );
                }
                SET_TRAFFIC_SYSTEM( 0 );
                 /* LOADISEQ */ sub_1517( -223586764, 1 );
                 /* LOADISEQ */ sub_1517( -1222535398, 0 );
                 /* CLEANUP_ROOFTOP_ASSETS_FOR_ABANDONED_BUILDING */ sub_33922();
                START_CONTEXT( "NYBAR_ABANDONED_BUILDING" );
                if (IS_DEATH_PANEL_WIPE_ALLOWED())
                {
                    DO_SCREEN_FADE_IN( 0 );
                }
                 /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2561, 4000 );
                l_U2853 = 12;
                 /* WRITESCRIPTLOG */ sub_803( "BSW", "Kick off the abo floor 1 fight", 0 );
                l_U2596 = 18;
            }
            break;
            case 12:
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2350 ))
            {
                 /* P_PLAY_DIAL_PASSOS_MAX_ROOF2 */ sub_82963();
            }
             /* P_HANDLE_PASSOS_ABANDONED_BLDG_INCIDENTAL_SHOOT_VO */ sub_83779();
            if (NOT l_U2289)
            {
                if ( /* IS_PASSOS_VALID */ sub_33084())
                {
                    if (PED_ANIM_EVENT( g_U818, 1477325977 ))
                    {
                         /* TASK_FRONT_GUYS_TO_FIRE_AT_PASSOS */ sub_83218();
                        l_U2289 = 1;
                    }
                }
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1566, 0 ))
            {
                g_U3437[7] = 1;
            }
            if (NOT l_U2299)
            {
                if (((( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1894 )) + ( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1858 ))) <= 3) || ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1348, 0 )))
                {
                     /* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24346( ref l_U1930, 0 );
                    if ( /* IS_PED_VALID */ sub_22677( l_U1930[0] ))
                    {
                         /* PED_TASK_ATTACK_MOVE */ sub_55353( l_U1930[0], -245.77000000, -21.83000000, 1.73000000, 0.50000000, 20, -1, 4 );
                    }
                    if ( /* IS_PED_VALID */ sub_22677( l_U1930[1] ))
                    {
                         /* PED_TASK_ATTACK_MOVE */ sub_55353( l_U1930[1], -235.25000000, -23.03000000, 1.73000000, 0.50000000, 20, -1, 4 );
                    }
                    l_U2299 = 1;
                }
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1159, 0 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_MID_05A_PASSOS_DEATH", 0 );
                l_U2853 = 4;
            }
            if (NOT l_U2285)
            {
                if ((PED_GET_ACTION_INTENTION_STATUS( g_U818, 47 )) == 1)
                {
                    l_U2285 = 1;
                }
            }
            else if ( /* HAS_MAX_SHOT_NEAR_PASSOS */ sub_84391())
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "Player shot near Passos", 0 );
                PED_SET_ACTION_INTENTION( g_U818, 56, 1000, 0, 0, 0 );
            }
            if (NOT l_U2284)
            {
                if (( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1858 )) == 0)
                {
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "Reset tethering for the peds at the back of the first floor", 0 );
                     /* PED_ARRAY_RESET_TETHER */ sub_54216( ref l_U1894 );
                    l_U2284 = 1;
                }
            }
            iVar2 = (( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1858 )) + ( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1894 ))) + ( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1930 ));
            if ((l_U2595 == 20) AND (iVar2 < 6))
            {
                l_U2596 = 20;
            }
            else if (iVar2 == 1)
            {
                if (NOT l_U2290)
                {
                     /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1858 );
                     /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1894 );
                     /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1930 );
                }
            }
            else if (iVar2 == 0)
            {
                l_U2596 = 21;
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ABANDONED_FLOOR1_BULLET_CAM", 0 );
                l_U2853 = 13;
            };;;
            break;
            case 13:
            if (NOT IS_LAST_MAN_STANDING_ACTIVE())
            {
                if (NOT (IS_BULLET_CAMERA_RUNNING( 0 )))
                {
                    if ((PED_GET_ACTION_INTENTION_STATUS( g_U818, 47 )) == 1)
                    {
                        if (g_U780 != 6)
                        {
                            g_U780 = 6;
                             /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U493, 6,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[6]._fU0, g_U3141[6]._fU12, g_U3141[6]._fU16, g_U3141[6]._fU20, 1 );
                        }
                         /* TELEPORTPED */ sub_30319( g_U818, -242.80000000, -2.41871000, 1.60600000, 65446 );
                         /* PED_CLEAR_ALL_ACTION_INTENTIONS */ sub_73109( g_U818 );
                        PED_SET_ACTION_INTENTION( g_U818, 48, 1000, 0, 0, 0 );
                         /* PED_SET_ROOM_BY_NAME */ sub_32730( ref g_U818, g_U3553 );
                        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( g_U818, 1 );
                        CLEAR_PED_TASKS( g_U818 );
                        l_U2003 = 1;
                         /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ABANDONED_RUN_UP_STAIRS", 0 );
                        l_U2853 = 14;
                    }
                    else
                    {
                         /* P_HANDLE_EARLY_FIRE_ESCAPE_ABANDONEMENT */ sub_85219();
                    }
                }
            }
            break;
            case 14:
             /* P_HANDLE_PASSOS_INTERRUPTIONS */ sub_85500( g_U818, ref l_U2870, ref l_U2872, ref l_U2871, ref l_U2882, ref l_U2873 );
             /* P_HANDLE_EARLY_FIRE_ESCAPE_ABANDONEMENT */ sub_85219();
            if ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1537,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1516,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1))
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1566, 0 ))
            {
                g_U3437[7] = 1;
            }
            if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1432, 0 ))
            {
                 /* KILL_HANDLE_PASSOS_WAITING_SPEECH */ sub_82060( 1 );
                 /* RESETTIMER */ sub_10518( ref l_U2579 );
                l_U2596 = 23;
            }
            if (NOT ( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404()))
            {
                if ( /* ISTIMERDONE */ sub_44221( ref l_U2579 ))
                {
                     /* P_SPEECH_PLAY_MAX_MONOLOGUE */ sub_60342( "SNYC_SGTPH", ref l_U2523 );
                }
            }
            if (NOT l_U2298)
            {
                if ((PED_GET_ACTION_INTENTION_STATUS( g_U818, 48 )) == 1)
                {
                    CLEAR_PED_PRIMARY_LOOKAT( g_U818 );
                    if (NOT l_U2296)
                    {
                         /* INIT_HANDLE_PASSOS_WAITING_SPEECH */ sub_35528();
                         /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2579, 21000 );
                        l_U2296 = 1;
                    }
                    if ( /* IS_MAX_VALID */ sub_35429())
                    {
                         /* WRITESCRIPTLOG */ sub_803( "RJM", "SET_PED_PRIMARY_LOOKAT - Setting Passos to look at Max", 0 );
                        SET_PED_PRIMARY_LOOKAT( g_U818,  /* PLAYER_PED_ID */ sub_11378() );
                        SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( g_U818, 0 );
                        l_U2298 = 1;
                    }
                }
            }
            if (l_U2296)
            {
                 /* HANDLE_PASSOS_WAITING_SPEECH */ sub_81084( 16000, 2000 );
            }
            if ((( /* MAL_GETACTINTSTATUS */ sub_85683( g_U818, 29 )) != 3) AND (NOT l_U2295))
            {
                if (NOT ((PED_GET_ACTION_INTENTION_STATUS( g_U818, 52 )) == 3))
                {
                    if ((IS_CONTROL_PRESSED( 0, 6 )) AND ((IS_PLAYER_GUN_RAISED(  /* PLAYER_ID */ sub_11416() )) AND (IS_PED_IN_CROSSHAIR_CYLINDER_OFFSET( g_U818, 0.40000000, 1.00000000, 0.00000000, 0.00000000, -0.20000000, 15.00000000, 1 ))))
                    {
                        l_U2295 = 1;
                        PED_SET_ACTION_INTENTION( g_U818, 52, 1000, 0, 0, 0 );
                    }
                }
            }
            else if (l_U2295)
            {
                if (((PED_GET_ACTION_INTENTION_STATUS( g_U818, 52 )) == 1) || (NOT (IS_PED_IN_CROSSHAIR_CYLINDER_OFFSET( g_U818, 0.40000000, 1.00000000, 0.00000000, 0.00000000, -0.20000000, 15.00000000, 1 ))))
                {
                    PED_FINISH_ACTION_INTENTION( g_U818, 52 );
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "Turning on ability to POINT again", 0 );
                    l_U2295 = 0;
                }
            }
            if ( /* SETUP_ABANDONED_FLOOR2 */ sub_88814())
            {
                if (( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1495, 0 )) || ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1474, 0 )))
                {
                     /* TASK_ABANDONED_FLOOR2 */ sub_89789();
                     /* P_CREATE_S_NY2_GG_M5_03 */ sub_89989();
                     /* TELEPORTPED */ sub_30319( g_U818, -236.78000000, -24.10000000, 1.73123000, 0 );
                    PED_SET_ACTION_INTENTION( g_U818, 49, 1000, 0, 0, 0 );
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ABANDONED_BUILDING_FLOOR2", 0 );
                     /* P_INIT_PASSOS_WARNING_DEATH */ sub_90257();
                     /* TERMINATEISEQ */ sub_28029( -1222535398, 0 );
                     /* LOADISEQ */ sub_1517( 637400269, 0 );
                     /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2570, 1500 );
                     /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2561, 7000 );
                    l_U2853 = 15;
                }
            }
            break;
            case 15:
            if ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1537,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1516,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1))
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
            if ( /* IS_PASSOS_VALID */ sub_33084())
            {
                if (( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1369, 0 )) || ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1390, 0 )))
                {
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "Player has run out to the fire escape warning", 0 );
                     /* P_PLAY_DIAL_PASSOS */ sub_81564( "SNYC_WTFG", ref l_U2503 );
                }
                else if (( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1180, 0 )) || ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1411, 0 )))
                {
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_MID_05B_PASSOS_DEATH", 0 );
                    l_U2853 = 5;
                }
            }
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2570 ))
            {
                 /* P_SPEECH_PLAY_MAX_MONOLOGUE */ sub_60342( "SNYC_MSTT", ref l_U2513 );
            }
             /* P_HANDLE_PASSOS_ABANDONED_BLDG2_INCIDENTAL_SHOOT_VO */ sub_90810();
            if ( /* HAS_MAX_SHOT_NEAR_PASSOS */ sub_84391())
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "Player shot near Passos", 0 );
                PED_SET_ACTION_INTENTION( g_U818, 56, 1000, 0, 0, 0 );
            }
            iVar2 =  /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U1992 );
            if (iVar2 == 1)
            {
                if (NOT l_U2290)
                {
                     /* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ sub_61842( ref l_U1992 );
                }
            }
            else if (iVar2 == 0)
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ABANDONED_FLOOR2_BULLET_CAM", 0 );
                END_CONTEXT( "NYBAR_ABANDONED_BUILDING" );
                ENABLE_STATIC_EMITTER( "S_NYC2_SE_CHOP_SHOP_TOOLS", 1 );
                l_U2853 = 16;
            }
            break;
            case 16:
            if ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1537,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1516,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1))
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
            if (NOT IS_LAST_MAN_STANDING_ACTIVE())
            {
                if (NOT (IS_BULLET_CAMERA_RUNNING( 0 )))
                {
                    l_U2595 = 25;
                    l_U2596 = 25;
                    if ( /* IS_PASSOS_VALID */ sub_33084())
                    {
                         /* WRITESCRIPTLOG */ sub_803( "RJM", "Starting Vig_21 with Passos", 0 );
                        CLEAR_PED_TASKS_IMMEDIATELY( g_U818 );
                        ISEQ_UNREGISTER_ENTITY( -1202559929, "passos" );
                         /* PED_CLEAR_ALL_ACTION_INTENTIONS */ sub_73109( g_U818 );
                         /* TELEPORTPED */ sub_30319( g_U818, -238.48110000, -21.14708000, 5.12300000, 274 );
                        ISEQ_REGISTER_ENTITY( -223586764, "passos", g_U818, 0 );
                        ISEQ_START( -223586764 );
                    }
                     /* TAKE_PAINKILLER_ARRAY_SNAPSHOT */ sub_91658( ref l_U2588, ref l_U2591 );
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ABANDONED_FLOOR2_WAIT_FOR_PASSOS_MOVEMENT", 0 );
                    l_U2853 = 17;
                }
            }
            break;
            case 17:
             /* P_HANDLE_PASSOS_INTERRUPTIONS */ sub_85500( g_U818, ref l_U2870, ref l_U2872, ref l_U2871, ref l_U2882, ref l_U2873 );
            if ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1537,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1516,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1))
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
             /* P_HANDLE_MAX_ABAND_BLDNG_PILLS_VO */ sub_92134();
            if ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1243 ))
            {
                uVar16 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
                if ((GET_DOES_WEAPON_EXIST( uVar16 )) == 1)
                {
                    if (( /* IS_WEAPON_TWO_HANDED */ sub_65200( uVar16 )) == 1)
                    {
                         /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 0 );
                    }
                    else
                    {
                        uVar17 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
                        if ((GET_DOES_WEAPON_EXIST( uVar17 )) == 1)
                        {
                             /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 0 );
                        }
                    }
                }
            }
            if ( /* UPDATE_FORCEWALK_AND_TRIGGER_PAIR */ sub_92548( l_U1243, l_U1264, 1 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Max in Passos' MID_06 Start position.  Short-circuit", 0 );
                g_U3437[8] = 1;
                l_U2853 = 20;
            }
            if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
            {
                if ((PED_GET_ACTION_INTENTION_STATUS( g_U818, 56 )) == 1)
                {
                     /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ABANDONED_FLOOR2_WAIT_FOR_MID06", 0 );
                    l_U2853 = 18;
                }
            }
            break;
            case 18:
            if ((( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1537,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1) || (( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1516,  /* PLAYER_PED_ID */ sub_11378(), 0 )) == 1))
            {
                 /* WRITESCRIPTLOG */ sub_803( "kja", "Player Hit the Kill Box", 0 );
                SET_BULLET_CAM_PREF(  /* PLAYER_PED_ID */ sub_11378(), "MISS_DEATH_FALL_01A", "", "", 0, 1, 0, 0, 0, 0, 0, 0, 0 );
                 /* P_KILL_PED */ sub_44507(  /* PLAYER_PED_ID */ sub_11378() );
            }
            if (( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1222 )) || (( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1201 )) || ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1243 ))))
            {
                uVar16 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
                if ((GET_DOES_WEAPON_EXIST( uVar16 )) == 1)
                {
                    if (( /* IS_WEAPON_TWO_HANDED */ sub_65200( uVar16 )) == 1)
                    {
                         /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 0 );
                    }
                    else
                    {
                        uVar17 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
                        if ((GET_DOES_WEAPON_EXIST( uVar17 )) == 1)
                        {
                             /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 0 );
                        }
                    }
                }
            }
            if (( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1222 )) || (( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( l_U1201 )) || ( /* UPDATE_FORCEWALK_AND_TRIGGER_PAIR */ sub_92548( l_U1243, l_U1264, 1 ))))
            {
                 /* KILL_HANDLE_PASSOS_WAITING_SPEECH */ sub_82060( 0 );
                 /* WRITESCRIPTLOG */ sub_803( "SBA", "HANDLE_EVENTS: Timer done, moving on to ROOFTOP_DONE", 0 );
                g_U3437[8] = 1;
                l_U2853 = 20;
            }
            if ( /* F_ISPEDINTRIGGERBOXFIRSTTIME */ sub_51485( ref l_U1453, g_U818, 0 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "VIG 21 - Passos finished first animation, start timer for impatient dialog", 0 );
                 /* STARTTIMER */ sub_34724( ref l_U2305 );
                 /* P_PLAY_DIAL_PASSOS */ sub_81564( ref l_U2251, ref l_U2423 );
            }
            if ( /* HASTIMERBEENACTIVATED */ sub_46575( ref l_U2305 ))
            {
                if ( /* ISTIMERDONE */ sub_44221( ref l_U2305 ))
                {
                    PED_SET_ACTION_INTENTION( g_U818, 37, 1000, 0, 0, 0 );
                     /* P_PLAY_DIAL_PASSOS */ sub_81564( ref l_U2267, ref l_U2433 );
                     /* DISABLETIMER */ sub_59655( ref l_U2305 );
                     /* INIT_HANDLE_PASSOS_WAITING_SPEECH */ sub_35528();
                    l_U2297 = 1;
                }
            }
            if (l_U2297)
            {
                 /* HANDLE_PASSOS_WAITING_SPEECH */ sub_81084( 16000, 2000 );
            }
             /* P_HANDLE_MAX_ABAND_BLDNG_PILLS_VO */ sub_92134();
            break;
            case 19: break;
            case 20: break;
        }
    }
    return;
}

/* F_ISPEDINTRIGGERBOXFIRSTTIME */ void sub_51485(int iParam0, unknown uParam1, unknown uParam2)
{
    if (iParam0->_fU68 == 1)
    {
        return 0;
    }
    else
    {
        iParam0->_fU68 =  /* F_ISPEDINTRIGGERBOX */ sub_51555( uParam1, (iParam0^) );
        if ((iParam0->_fU68) AND (uParam2))
        {
            GAMEPLAY_HELPER_BOX_SET_ENABLED( iParam0 + 0, 0 );
        }
    }
    return iParam0->_fU68;
}

/* F_ISPEDINTRIGGERBOX */ int sub_51555(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11, unknown uParam12, unknown uParam13, unknown uParam14, unknown uParam15, unknown uParam16, unknown uParam17, unknown uParam18, unknown uParam19, unknown uParam20, unknown uParam21)
{
    if ((IS_PED_DEAD( uParam0 )) == 0)
    {
        return IS_PED_IN_GAMEPLAY_HELPER_BOX( uParam0, ref uParam1._fU0 );
    }
    return 0;
}

/* DEACTIVATE_ALL_PEDS_FOR_DEATH_SCENE */ void sub_52097()
{
     /* P_DEACTIVATEPEDARRAY */ sub_24818( ref l_U1858 );
     /* P_DEACTIVATEPEDARRAY */ sub_24818( ref l_U1894 );
     /* P_DEACTIVATEPEDARRAY */ sub_24818( ref l_U1992 );
    return;
}

/* GET_SCENEPED_FOR_MID_05A */ int sub_52180()
{
    int I;

    for ( I = 0; I <= (l_U1858 - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1858[I] ))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "GET_SCENEPED_FOR_MID_05A - Found a guy from the front group", 0 );
            return l_U1831[I]._fU20;
        }
    }
    for ( I = 0; I <= (l_U1894 - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1894[I] ))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "GET_SCENEPED_FOR_MID_05A - Found a guy from the back group", 0 );
            return l_U1867[I]._fU20;
        }
    }
    for ( I = 0; I <= (l_U1930 - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1930[I] ))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "GET_SCENEPED_FOR_MID_05A - Found a guy from the extra group", 0 );
            return l_U1903[I]._fU20;
        }
    }
     /* WRITESCRIPTLOG */ sub_803( "RJM", "GET_SCENEPED_FOR_MID_05A - Couldn't find anyone alive...that's weird, use a default", 0 );
    return 596270676;
}

/* GET_SCENEPED_FOR_MID_05B */ int sub_52880()
{
    int I;

    for ( I = 0; I <= (l_U1992 - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1992[I] ))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "GET_SCENEPED_FOR_MID_05B - Found a guy", 0 );
            return l_U1939[I]._fU20;
        }
    }
     /* WRITESCRIPTLOG */ sub_803( "RJM", "GET_SCENEPED_FOR_MID_05B - Couldn't find anyone alive...that's weird, use a default", 0 );
    return 293821277;
}

/* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ void sub_53351(int iParam0, unknown uParam1)
{
    if (iParam0->_fU64 == 1)
    {
        return 0;
    }
    else
    {
        iParam0->_fU64 =  /* F_ISPEDINTRIGGERBOX */ sub_51555(  /* PLAYER_PED_ID */ sub_11378(), (iParam0^) );
        if ((iParam0->_fU64) AND (uParam1))
        {
            GAMEPLAY_HELPER_BOX_SET_ENABLED( iParam0 + 0, 0 );
        }
    }
    return iParam0->_fU64;
}

/* START_ROOF_PATROLLERS */ void sub_53838()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "START_ROOF_PATROLLERS", "***" );
     /* ACTIVATE_ROOF_PATROLLERS */ sub_53914( 0 );
    return;
}

/* ACTIVATE_ROOF_PATROLLERS */ void sub_53914(boolean bParam0)
{
    int I;

     /* WRITESCRIPTLOG */ sub_803( "SBA", "ACTIVATE_ROOF_PATROLLERS", "***" );
    for ( I = 0; I < 3; I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1649[I] ))
        {
            if (bParam0)
            {
                 /* TELEPORTPED */ sub_30319( l_U1649[I], l_U1609[I]._fU0, l_U1609[I]._fU12 );
            }
            PED_SET_ACTION_INTENTION( l_U1649[I], 53, 1000, 0.00000000, 0.00000000, 0.00000000 );
        }
    }
    return;
}

/* TRIGGER_APT_ROOF_GUYS */ void sub_54134()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "TRIGGER_APT_ROOF_GUYS - start", 0 );
     /* PED_ARRAY_RESET_TETHER */ sub_54216( ref l_U1823 );
    if ( /* IS_PED_VALID */ sub_22677( l_U1823[0] ))
    {
         /* P_ACTIVATEPED */ sub_33665( l_U1823[0] );
        SET_PED_COMBAT_MOVEMENT( l_U1823[0], 0 );
    }
    return;
}

/* PED_ARRAY_RESET_TETHER */ void sub_54216(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( (uParam0^)[I] ))
        {
            RESET_PED_TETHERING( (uParam0^)[I] );
        }
    }
    return;
}

/* HANDLE_PATROL_REACTIONS */ void sub_54383()
{
    int I;
    string sVar3;

    for ( I = 0; I < 3; I++ )
    {
        if ((NOT l_U1659[I]) AND ( /* IS_PED_VALID */ sub_22677( l_U1748[I] )))
        {
            if (I == 0)
            {
                sVar3 = "thug0";
            }
            else if (I == 1)
            {
                sVar3 = "thug1";
            }
            else if (I == 2)
            {
                sVar3 = "thug2";
            };;;
            if ((ISEQ_QUERY_ENTITY_STATE( -329975025, sVar3, 5 )) || (ISEQ_QUERY_ENTITY_STATE( -329975025, sVar3, 6 )))
            {
                 /* WRITESCRIPTLOG */ sub_803( "BSW", "HANDLE_PATROL_REACTIONS - Patroller reacting", 0 );
                SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( l_U1649[I], 0 );
                if ( /* IS_MAX_VALID */ sub_35429())
                {
                     /* PED_TASK_COMBAT_PLAYER */ sub_54660( l_U1649[I], 1 );
                }
                if (I != 2)
                {
                    PLAY_PED_AMBIENT_SPEECH( l_U1649[I], "ORDER_FIRE", 0, 0, 2, 0, 30000 );
                }
                l_U1659[I] = 1;
            }
        }
    }
    if ((l_U1659[2]) AND ((l_U1659[1]) AND (l_U1659[0])))
    {
         /* WRITESCRIPTLOG */ sub_803( "BSW", "HANDLE_PATROL_REACTIONS, all patrollers have reacted", 0 );
        l_U1663 = 1;
        if ( /* IS_PED_VALID */ sub_22677( l_U1823[0] ))
        {
            SET_PED_COMBAT_MOVEMENT( l_U1823[0], 2 );
             /* PED_SET_REGISTER_TARGET_PLAYER */ sub_54762( ref l_U1823[0] );
            SET_PED_COMBAT_ATTRIBUTES( l_U1823[0], 1, 0 );
             /* PED_TASK_ATTACK_MOVE */ sub_55353( l_U1823[0], -335.69000000, -15.73000000, 6.27000000, 0.50000000, 20, -1, 4 );
        }
         /* ACTIVATE_AND_MOVE_ROOF_RIGHT_GUYS */ sub_55435();
        if (l_U2595 == 9)
        {
            l_U2596 = 9;
        }
    }
    return;
}

/* PED_TASK_COMBAT_PLAYER */ void sub_54660(unknown uParam0, boolean bParam1)
{
    if ((NOT (IS_PED_RAGDOLL( uParam0, 0 ))) AND ((NOT (IS_PED_INJURED( uParam0 ))) AND (( /* IS_MAX_VALID */ sub_35429()) AND ( /* IS_PED_VALID */ sub_22677( uParam0 )))))
    {
        if (bParam1)
        {
            CLEAR_PED_TASKS_IMMEDIATELY( uParam0 );
        }
        CLEAR_LOCKED_TARGET( uParam0 );
         /* PED_SET_REGISTER_TARGET_PLAYER */ sub_54762( ref uParam0 );
         /* PED_SET_LOCKED_ON_PLAYER */ sub_54917( ref uParam0 );
        TASK_COMBAT_PED( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
    }
    return;
}

/* PED_SET_REGISTER_TARGET_PLAYER */ void sub_54762(unknown uParam0)
{
    if (( /* IS_MAX_VALID */ sub_35429()) AND ( /* IS_PED_VALID */ sub_22677( (uParam0^) )))
    {
         /* PED_SET_REGISTER_TARGET */ sub_54831( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
    }
    return;
}

/* PED_SET_REGISTER_TARGET */ void sub_54831(unknown uParam0, unknown uParam1)
{
    if (( /* IS_PED_VALID */ sub_22677( uParam1 )) AND ( /* IS_PED_VALID */ sub_22677( (uParam0^) )))
    {
        REGISTER_TARGET( (uParam0^), uParam1 );
    }
    return;
}

/* PED_SET_LOCKED_ON_PLAYER */ void sub_54917(unknown uParam0)
{
    if (( /* IS_MAX_VALID */ sub_35429()) AND ( /* IS_PED_VALID */ sub_22677( (uParam0^) )))
    {
         /* PED_SET_LOCKED_ON_PED */ sub_54980( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
    }
    return;
}

/* PED_SET_LOCKED_ON_PED */ void sub_54980(unknown uParam0, unknown uParam1)
{
    if (( /* IS_PED_VALID */ sub_22677( uParam1 )) AND ( /* IS_PED_VALID */ sub_22677( (uParam0^) )))
    {
        SET_LOCKED_TARGET( (uParam0^), uParam1 );
    }
    return;
}

/* PED_TASK_ATTACK_MOVE */ void sub_55353(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7)
{
    if ( /* IS_PED_VALID */ sub_22677( uParam0 ))
    {
        CLEAR_PED_TASKS_IMMEDIATELY( uParam0 );
        TASK_ATTACK_MOVE( uParam0, uParam1, uParam4, uParam5, uParam6, uParam7 );
    }
    return;
}

/* ACTIVATE_AND_MOVE_ROOF_RIGHT_GUYS */ void sub_55435()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "ACTIVATE_AND_MOVE_ROOF_RIGHT_GUYS", "***" );
     /* P_ACTIVATEPEDARRAY */ sub_33613( ref l_U1687 );
     /* P_SET_PED_ARRAY_REGISTERED_TARGET */ sub_55553( ref l_U1687,  /* PLAYER_PED_ID */ sub_11378(), 1 );
    if (( /* IS_MAX_VALID */ sub_35429()) AND ( /* IS_PED_VALID */ sub_22677( l_U1687[0] )))
    {
        SET_PED_COMBAT_ATTRIBUTES( l_U1687[0], 1, 0 );
        TASK_COMBAT_PED( l_U1687[0],  /* PLAYER_PED_ID */ sub_11378() );
    }
    return;
}

/* P_SET_PED_ARRAY_REGISTERED_TARGET */ void sub_55553(unknown uParam0, unknown uParam1, int iParam2)
{
    int I;

    for ( I = 0; I < (uParam0^); I++ )
    {
        if ((NOT (IS_PED_DEAD( uParam1 ))) AND (NOT (IS_PED_DEAD( (uParam0^)[I] ))))
        {
            REGISTER_TARGET( (uParam0^)[I], uParam1 );
            if (iParam2 == 1)
            {
                CLEAR_LOCKED_TARGET( (uParam0^)[I] );
                SET_LOCKED_TARGET( (uParam0^)[I], uParam1 );
            }
        }
    }
    return;
}

/* P_PED_ARRAY_Z_SAFETY_CHECK */ void sub_55958(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3)
{
    int I;

    for ( I = 0; I < (uParam0^); I++ )
    {
         /* P_PED_Z_SAFETY_CHECK */ sub_56024( (uParam0^)[I], uParam1, uParam2, uParam3 );
    }
    return;
}

/* P_PED_Z_SAFETY_CHECK */ void sub_56024(unknown uParam0, float fParam1, int iParam2, boolean bParam3)
{
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;

    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        uVar6 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( uParam0 )};
        if (uVar6._fU8 < fParam1)
        {
            if (iParam2 == 1)
            {
                SET_PED_HEALTH( uParam0, 0, 0 );
            }
            if (bParam3)
            {
                 /* CLEANPED */ sub_21861( uParam0 );
            }
        }
    }
    return;
}

/* KILL_WAYWARD_PEDS */ void sub_56340()
{
     /* KILLMEMBERSINTRIGGER */ sub_56380( ref l_U1823, l_U844 );
     /* KILLMEMBERSINTRIGGER */ sub_56380( ref l_U1649, l_U844 );
     /* KILLMEMBERSINTRIGGER */ sub_56380( ref l_U1687, l_U844 );
     /* KILLMEMBERSINTRIGGER */ sub_56380( ref l_U1799, l_U844 );
     /* KILLMEMBERSINTRIGGER */ sub_56380( ref l_U1748, l_U865 );
     /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1823, -1054867456, 0, 1 );
     /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1649, -1054867456, 0, 1 );
     /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1687, -1054867456, 0, 1 );
     /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1799, -1054867456, 0, 1 );
     /* P_PED_ARRAY_Z_SAFETY_CHECK */ sub_55958( ref l_U1748, -1054867456, 0, 1 );
    return;
}

/* KILLMEMBERSINTRIGGER */ void sub_56380(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11, unknown uParam12, unknown uParam13, unknown uParam14, unknown uParam15, unknown uParam16, unknown uParam17, unknown uParam18, unknown uParam19, unknown uParam20, unknown uParam21)
{
    int Result;
    int I;
    int iVar26;

    Result = 0;
    I = 0;
    iVar26 = (uParam0^);
    for ( I = 0; I < iVar26; I++ )
    {
        if ( /* KILLPEDINTRIGGER */ sub_56453( ref (uParam0^)[I], uParam1 ))
        {
            Result = 1;
        }
    }
    return Result;
}

/* KILLPEDINTRIGGER */ int sub_56453(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11, unknown uParam12, unknown uParam13, unknown uParam14, unknown uParam15, unknown uParam16, unknown uParam17, unknown uParam18, unknown uParam19, unknown uParam20, unknown uParam21)
{
    if ((DOES_PED_EXIST( (uParam0^) )) == 1)
    {
        if ((IS_PED_DEAD( (uParam0^) )) == 0)
        {
            if ((IS_PED_IN_GAMEPLAY_HELPER_BOX( (uParam0^), ref uParam1._fU0 )) == 1)
            {
                 /* P_KILL_PED */ sub_44507( (uParam0^) );
                return 1;
            }
        }
    }
    return 0;
}

/* F_ISDOORLOCKED */ void sub_56830(int iParam0)
{
    unknown Result;
    unknown uVar4;

    if (( /* F_DOESDOOREXIST */ sub_29816( iParam0 )) == 0)
    {
         /* P_PRINTDOORNOTEXIST */ sub_29900( iParam0 );
    }
    GET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, ref Result, ref uVar4 );
    return Result;
}

/* F_ISPLAYERINTRIGGERBOX */ void sub_56920(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11, unknown uParam12, unknown uParam13, unknown uParam14, unknown uParam15, unknown uParam16, unknown uParam17, unknown uParam18, unknown uParam19, unknown uParam20)
{
    return  /* F_ISPEDINTRIGGERBOX */ sub_51555(  /* PLAYER_PED_ID */ sub_11378(), uParam0 );
}

/* F_GETDOOROPENRATIO */ void sub_57048(int iParam0)
{
    int iVar3;
    float Result;

    if (( /* F_DOESDOOREXIST */ sub_29816( iParam0 )) == 0)
    {
         /* P_PRINTDOORNOTEXIST */ sub_29900( iParam0 );
    }
    iVar3 = 0;
    Result = 0.00000000;
    GET_STATE_OF_CLOSEST_DOOR_OF_TYPE( iParam0->_fU0, iParam0->_fU4, ref iVar3, ref Result );
    return Result;
}

/* RELEASE_THE_PIGEONS */ void sub_57387()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "RELEASE_THE_PIGEONS: starting effect", 0 );
    START_PARTICLE_FX_NON_LOOPED_AT_COORD( "Ambient_Birds_scripted_S", -327.55600000, -17.03100000, 4.91800000, 0, 0, 50, 1065353216 );
    return;
}

/* ACTIVATE_COVER_ROOF_GUYS */ void sub_57543()
{
    unknown uVar2;

     /* WRITESCRIPTLOG */ sub_803( "SBA", "ACTIVATE_COVER_ROOF_GUYS", "***" );
     /* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24346( ref l_U1799, 0 );
     /* PED_ARRAY_ALWAYS_HIDE_IN_COVER */ sub_26125( ref l_U1799, 0 );
     /* PED_ARRAY_SET_REGISTER_TARGET_PLAYER */ sub_57648( ref l_U1799 );
     /* PED_ARRAY_SET_LOCK_TO_COVER */ sub_57824( ref l_U1799, 0 );
    if ( /* IS_MAX_VALID */ sub_35429())
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U1799[0] ))
        {
            OPEN_SEQUENCE_TASK( ref uVar2 );
            TASK_PAUSE( 0, 500 );
            TASK_COMBAT_PED( 0,  /* PLAYER_PED_ID */ sub_11378() );
            CLOSE_SEQUENCE_TASK( uVar2 );
            TASK_PERFORM_SEQUENCE( l_U1799[0], uVar2 );
            CLEAR_SEQUENCE_TASK( uVar2 );
        }
        if ( /* IS_PED_VALID */ sub_22677( l_U1799[1] ))
        {
            OPEN_SEQUENCE_TASK( ref uVar2 );
            TASK_PAUSE( 0, 750 );
            TASK_COMBAT_PED( 0,  /* PLAYER_PED_ID */ sub_11378() );
            CLOSE_SEQUENCE_TASK( uVar2 );
            TASK_PERFORM_SEQUENCE( l_U1799[1], uVar2 );
            CLEAR_SEQUENCE_TASK( uVar2 );
        }
        if ( /* IS_PED_VALID */ sub_22677( l_U1799[2] ))
        {
            RESET_PED_TETHERING( l_U1799[2] );
             /* PED_SET_TETHERBOX */ sub_24170( ref l_U1799[2], l_U1563, 1 );
            SET_PED_COMBAT_ATTRIBUTES( l_U1799[2], 1, 0 );
            OPEN_SEQUENCE_TASK( ref uVar2 );
            TASK_PAUSE( 0, 250 );
            TASK_ATTACK_MOVE( 0, -315.97000000, -18.95000000, 5.68000000, 1092616192, 1101004800, -1082130432, 3 );
            TASK_COMBAT_PED( 0,  /* PLAYER_PED_ID */ sub_11378() );
            CLOSE_SEQUENCE_TASK( uVar2 );
            TASK_PERFORM_SEQUENCE( l_U1799[2], uVar2 );
            CLEAR_SEQUENCE_TASK( uVar2 );
        }
    }
    return;
}

/* PED_ARRAY_SET_REGISTER_TARGET_PLAYER */ void sub_57648(unknown uParam0)
{
     /* PED_ARRAY_SET_REGISTER_TARGET */ sub_57704( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
    return;
}

/* PED_ARRAY_SET_REGISTER_TARGET */ void sub_57704(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( (uParam0^)[I] ))
        {
             /* PED_SET_REGISTER_TARGET */ sub_54831( ref (uParam0^)[I], uParam1 );
        }
    }
    return;
}

/* PED_ARRAY_SET_LOCK_TO_COVER */ void sub_57824(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* PED_SET_LOCK_TO_COVER */ sub_25904( ref (uParam0^)[I], uParam1 );
    }
    return;
}

/* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ void sub_58291(unknown uParam0)
{
    int Result;
    int I;
    int iVar5;

    Result = 0;
    iVar5 = (uParam0^) - 1;
    for ( I = 0; I <= iVar5; I++ )
    {
        if (NOT (IS_PED_DEAD( (uParam0^)[I] )))
        {
            Result++;
        }
    }
    return Result;
}

/* HANDLE_ROOFTOP_ENEMY_TASKING */ void sub_58617()
{
    int iVar2;

    iVar2 = 3000;
    if (NOT l_U2283)
    {
        switch (l_U2858)
        {
            case 0:
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_ROOFTOP_ENEMY_TASKING - Going to RET_WAIT_FOR_PLAYER_TRIGGER", 0 );
            l_U2858 = 1;
            break;
            case 1:
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_ROOFTOP_ENEMY_TASKING - Going to RET_TASK_FIRST_WAVE", 0 );
            l_U2858 = 2;
            break;
            case 2:
             /* TASK_UPPER_ROOF0 */ sub_58904();
             /* P_CREATE_AND_START_TIMER */ sub_34674( ref l_U2332, iVar2 );
             /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_ROOFTOP_ENEMY_TASKING - Going to RET_TASK_SECOND_WAVE", 0 );
            l_U2858 = 3;
            break;
            case 3:
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2332 ))
            {
                 /* TASK_UPPER_ROOF1 */ sub_59307();
                 /* DISABLETIMER */ sub_59655( ref l_U2332 );
                 /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_ROOFTOP_ENEMY_TASKING - Going to RET_TASK_DONE", 0 );
                l_U2858 = 4;
            }
            break;
            case 4:
             /* PED_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24429( ref l_U1748[0], 0 );
             /* PED_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24429( ref l_U1748[1], 0 );
            l_U2283 = 1;
            l_U2294 = 0;
            break;
        }
    }
    return;
}

/* TASK_UPPER_ROOF0 */ void sub_58904()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "TASK_UPPER_ROOF0 - start", 0 );
    if (( /* IS_MAX_VALID */ sub_35429()) AND ( /* IS_PED_VALID */ sub_22677( l_U1748[0] )))
    {
         /* P_ACTIVATEPED */ sub_33665( l_U1748[0] );
        SET_PED_PATH_CAN_DROP_FROM_HEIGHT( l_U1748[0], 1 );
         /* PED_TASK_COMBAT_MOVE_TO_COVER */ sub_33214( l_U1748[0], "GenCover", "F824CF1A_B6E6FA61_Corner2",  /* PLAYER_PED_ID */ sub_11378(), 0 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U1748[1] ))
    {
         /* P_ACTIVATEPED */ sub_33665( l_U1748[1] );
        SET_PED_PATH_CAN_DROP_FROM_HEIGHT( l_U1748[1], 1 );
         /* PED_TASK_COMBAT_MOVE_TO_COVER */ sub_33214( l_U1748[1], "GenCover", "F824CF1A_673F1030_Corner1",  /* PLAYER_PED_ID */ sub_11378(), 0 );
    }
    return;
}

/* TASK_UPPER_ROOF1 */ void sub_59307()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "TASK_UPPER_ROOF1 - start", 0 );
    if ( /* IS_PED_VALID */ sub_22677( l_U1748[2] ))
    {
        SET_PED_PATH_CAN_DROP_FROM_HEIGHT( l_U1748[2], 1 );
         /* PED_SET_REGISTER_TARGET_PLAYER */ sub_54762( ref l_U1748[2] );
         /* PED_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24429( ref l_U1748[2], 0 );
         /* P_ACTIVATEPED */ sub_33665( l_U1748[2] );
        SET_PED_COMBAT_ATTRIBUTES( l_U1748[2], 1, 0 );
         /* PED_TASK_ATTACK_MOVE */ sub_55353( l_U1748[2], -312.12000000, -20.31000000, 5.72000000, 0.50000000, 1101004800, -1082130432, 3 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U1748[3] ))
    {
        SET_PED_PATH_CAN_DROP_FROM_HEIGHT( l_U1748[3], 1 );
         /* PED_SET_REGISTER_TARGET_PLAYER */ sub_54762( ref l_U1748[3] );
         /* PED_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24429( ref l_U1748[3], 0 );
         /* P_ACTIVATEPED */ sub_33665( l_U1748[3] );
        RESET_PED_TETHERING( l_U1748[3] );
         /* PED_TASK_ATTACK_MOVE */ sub_55353( l_U1748[3], -309.89000000, -23.02000000, 6.47000000, 0.50000000, 1101004800, -1082130432, 3 );
    }
    return;
}

/* DISABLETIMER */ void sub_59655(int iParam0)
{
    iParam0->_fU20 = 0;
    iParam0->_fU16 = 0;
    return;
}

/* P_SPEECH_PLAY_MAX_MONOLOGUE */ void sub_60342(unknown uParam0, unknown uParam1)
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_SPEECH_PLAY_MAX_MONOLOGUE", "***" );
    if ( /* IS_MAX_VALID */ sub_35429())
    {
         /* RESET_SCRIPT_SPEECH_STRUCT */ sub_60441( uParam1 );
         /* ADD_PED_FOR_SCRIPT_SPEECH */ sub_60550( 0,  /* PLAYER_PED_ID */ sub_11378(), "MAX", uParam1, 2, 0 );
         /* ADD_PED_FOR_SCRIPT_SPEECH */ sub_60550( 1,  /* PLAYER_PED_ID */ sub_11378(), "MAX", uParam1, 2, 0 );
         /* PLAY_SINGLE_SPEECH */ sub_60803( uParam0, uParam1, 8, 1 );
    }
    return;
}

/* RESET_SCRIPT_SPEECH_STRUCT */ void sub_60441(int iParam0)
{
    iParam0->_fU4 = -1;
    iParam0->_fU16 = 0;
    iParam0->_fU20 = 0;
    iParam0->_fU24 = 0;
    iParam0->_fU28 = 0;
    iParam0->_fU32 = 0;
    iParam0->_fU36 = 0;
    return;
}

/* ADD_PED_FOR_SCRIPT_SPEECH */ void sub_60550(int iParam0, unknown uParam1, unknown uParam2, int iParam3, unknown uParam4, unknown uParam5)
{
    if (iParam3->_fU32)
    {
        ;
    }
    else if (iParam3->_fU36 == 0)
    {
        iParam3->_fU36 = 1;
        iParam3->_fU4 = CREATE_NEW_SCRIPTED_CONVERSATION( uParam4 );
        if (iParam3->_fU4 == -1)
        {
            iParam3->_fU32 = 1;
        }
    }
    if ((iParam0 < 9) AND ((iParam0 >= 0) AND ((iParam3->_fU4 < 4) AND (iParam3->_fU4 >= 0))))
    {
        g_U16[iParam3->_fU4]._fU16[iParam0]._fU0 = uParam1;
        g_U16[iParam3->_fU4]._fU16[iParam0]._fU4 = GET_HASH_KEY( uParam2 );
        if (NOT (IS_PED_INJURED( uParam1 )))
        {
            SET_PED_CAN_PLAY_AMBIENT_ANIMS( uParam1, uParam5 );
        }
    }
    return;
}

/* PLAY_SINGLE_SPEECH */ void sub_60803(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3)
{
    return  /* PLAY_SINGLE_SPEECH_FROM_BLOCK */ sub_60848( uParam0, ref g_U157._fU0, uParam1, uParam2, uParam3 );
}

/* PLAY_SINGLE_SPEECH_FROM_BLOCK */ void sub_60848(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4)
{
    char[16] cVar7;
    char[12] cVar11;
    unknown uVar14;
    unknown uVar15;
    unknown uVar16;
    unknown uVar17;
    unknown uVar18;
    unknown uVar19;

    StrCopy( ref cVar7, uParam1, 16 );
    array(ref cVar11, 2);
    StrCopy( ref cVar11[0], uParam0, 16 );
    StrCopy( ref cVar11[1], "END", 16 );
    return  /* PLAYSPEECHMAIN */ sub_60935( ref cVar11, uParam2, uParam3, 0, 0, 0, 0, ref cVar7, uParam4 );
}

/* PLAYSPEECHMAIN */ int sub_60935(unknown uParam0, int iParam1, unknown uParam2, boolean bParam3, boolean bParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8)
{
    int I;
    unknown uVar12;
    unknown uVar13;

    if (iParam1->_fU4 == -1)
    {
        return 0;
    }
    iParam1->_fU0 = uParam2;
    if (NOT ( /* CANTHISSPEECHBEPLAYED */ sub_60987( iParam1 )))
    {
        return 0;
    }
    uVar12 = iParam1->_fU4;
    uVar13 = GET_HASH_KEY( ref (uParam0^)[0] );
    iParam1->_fU16 = uVar13;
    SET_CONVERSATION_CHECK_HASH( uVar12, uVar13 );
    g_U157._fU132 = 0;
    iParam1->_fU24 = 0;
    iParam1->_fU28 = uParam5;
    if (bParam3)
    {
        if (iParam1->_fU20)
        {
            iParam1->_fU20 = 0;
        }
    }
    else
    {
        iParam1->_fU20 = 0;
        if (bParam4)
        {
            iParam1->_fU12 = uParam6;
            iParam1->_fU20 = 0;
        }
        else
        {
            iParam1->_fU12 = 0;
            iParam1->_fU20 = 0;
        }
    }
    iParam1->_fU24 = bParam4;
    for ( I = 0; I <= 24; I++ )
    {
        StrCopy( ref g_U233[uVar12][I], "END", 16 );
    }
    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        g_U233[uVar12][I] = {(uParam0^)[I]};
    }
    g_U192[uVar12] = {(iParam1^)};
     /* COPYHIDDENSPEECHSTUCT */ sub_61505( ref g_U16[uVar12], ref g_U157 );
    StrCopy( ref g_U16[uVar12]._fU0, uParam7, 16 );
    g_U16[uVar12]._fU136 = uParam8;
    g_U11[iParam1->_fU4] = 1;
    return 1;
}

/* CANTHISSPEECHBEPLAYED */ int sub_60987(int iParam0)
{
    switch (g_U11[iParam0->_fU4])
    {
        case 1:
        case 2:
        return 0;
        break;
    }
    if (IS_SCRIPTED_CONVERSATION_ONGOING( iParam0->_fU4 ))
    {
        if (g_U1[iParam0->_fU4] > iParam0->_fU0)
        {
            return 0;
        }
        STOP_SCRIPTED_CONVERSATION( iParam0->_fU4, 0, 0 );
    }
    g_U1[iParam0->_fU4] = iParam0->_fU0;
    g_U6[iParam0->_fU4]++;
    if (g_U6[iParam0->_fU4] > 100000)
    {
        g_U6[iParam0->_fU4] = 1;
    }
    iParam0->_fU8 = g_U6[iParam0->_fU4];
    return 1;
}

/* COPYHIDDENSPEECHSTUCT */ void sub_61505(int iParam0, int iParam1)
{
    int I;

    iParam0->_fU0 = {iParam1->_fU0};
    for ( I = 0; I <= 8; I++ )
    {
        iParam0->_fU92[I] = iParam1->_fU92[I];
    }
    iParam0->_fU132 = iParam1->_fU132;
    iParam0->_fU136 = iParam1->_fU136;
    return;
}

/* F_ASSIGN_BULLET_CAM_TO_LAST_LIVING_PED */ void sub_61842(unknown uParam0)
{
    int I;

    if (( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( uParam0 )) == 1)
    {
        for ( I = 0; I <= ((uParam0^) - 1); I++ )
        {
            if (NOT (IS_PED_DEAD( (uParam0^)[I] )))
            {
                if (NOT (GET_PED_CAN_TRIGGER_BULLET_CAM( (uParam0^)[I] )))
                {
                    SET_PED_CAN_TRIGGER_BULLET_CAM( (uParam0^)[I], 1 );
                    return (uParam0^)[I];
                }
            }
        }
    }
    return nil;
}

/* CREATE_PLANE */ void sub_62075()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_PLANE", 0 );
     /* CLEANOBJECT */ sub_26423( l_U2047 );
    l_U2047 = CREATE_OBJECT_NO_OFFSET( 1740663406, -302.18600000, -5.44400000, 30.20300000, 1, 0 );
    if (DOES_OBJECT_EXIST( l_U2047 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Setting up NYC_PLANE_ROOT", 0 );
        PLAY_OBJECT_ANIM( l_U2047, "NYC_PLANE_ROOT", "ny_anim", 0.10000000, 0, 1 );
        SET_OBJECT_ANIM_CURRENT_TIME( l_U2047, "NYC_PLANE_ROOT", "ny_anim", 0.25000000 );
    }
    return;
}

/* IS_ANY_SPEECH_CURRENTLY_PLAYING */ void sub_62404()
{
    int Result;
    int I;

    Result = 0;
    for ( I = 0; I <= 3; I++ )
    {
        Result = (IS_SCRIPTED_CONVERSATION_ONGOING( I )) || (Result);
    }
    return Result;
}

/* KILL_ANY_MISSION_SPEECH */ void sub_62586(unknown uParam0)
{
    int I;

    for ( I = 0; I <= 3; I++ )
    {
        PRINTSTRING( "\n KILL_ANY_MISSION_SPEECH CALLED***************************************" );
        if (IS_SCRIPTED_CONVERSATION_ONGOING( I ))
        {
            if ((g_U1[I] <= 8) AND (g_U1[I] >= 4))
            {
                STOP_SCRIPTED_CONVERSATION( I, uParam0, 0 );
            }
        }
    }
    return;
}

/* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ void sub_62797(unknown uParam0)
{
    int iVar3;
    unknown uVar4;
    unknown uVar5;

    if ((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
    {
        iVar3 = 0;
        uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar4 )) == 0)
        {
            iVar3 = 1;
        }
        if ((( /* IS_WEAPON_SINGLE_HANDED */ sub_62920( uVar4 )) == 0) AND ((GET_DOES_WEAPON_EXIST( uVar4 )) == 1))
        {
            iVar3 = 1;
        }
        if (iVar3 == 1)
        {
            uVar5 =  /* F_GET_SINGLE_HANDED_WEAPON_FROM_PLAYER */ sub_63155();
            if ((GET_DOES_WEAPON_EXIST( uVar5 )) == 1)
            {
                SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), uVar5, 0, uParam0 );
            }
        }
    }
    return;
}

/* IS_WEAPON_SINGLE_HANDED */ int sub_62920(unknown uParam0)
{
    int iVar3;

    if ((GET_DOES_WEAPON_EXIST( uParam0 )) == 1)
    {
        iVar3 = GET_WEAPON_TYPE( uParam0 );
        if ((iVar3 == 1194438308) || ((iVar3 == -76667461) || ((iVar3 == -1404433099) || ((iVar3 == 1131969637) || ((iVar3 == -691403429) || ((iVar3 == 1845102363) || ((iVar3 == 150541352) || ((iVar3 == -820634585) || ((iVar3 == -612753081) || ((iVar3 == 811797242) || ((iVar3 == 68019059) || ((iVar3 == -1464892298) || ((iVar3 == 456708483) || ((iVar3 == -862236369) || (iVar3 == 406496141)))))))))))))))
        {
            return 1;
        }
    }
    return 0;
}

/* F_GET_SINGLE_HANDED_WEAPON_FROM_PLAYER */ int sub_63155()
{
    unknown Result;
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;

    if ((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
    {
        Result = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
        if ((GET_DOES_WEAPON_EXIST( Result )) == 1)
        {
            if (( /* IS_WEAPON_SINGLE_HANDED */ sub_62920( Result )) == 1)
            {
                return Result;
            }
        }
        uVar3 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar3 )) == 1)
        {
            return uVar3;
        }
        uVar4 = GET_WEAPON_FROM_HOLSTER(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar4 )) == 1)
        {
            return uVar4;
        }
        uVar5 = GET_WEAPON_FROM_HOLSTER(  /* PLAYER_PED_ID */ sub_11378(), 1 );
        if ((GET_DOES_WEAPON_EXIST( uVar5 )) == 1)
        {
            return uVar5;
        }
    }
    return 0;
}

/* PLAY_MIDSCENE_03 */ void sub_63723(boolean bParam0, unknown uParam1, unknown uParam2)
{
    int Result;

    Result = 0;
    if (IS_STRING_NULL( uParam2 ))
    {
        uParam2 = l_U2600;
    }
    switch (l_U2633)
    {
        case 0:
         /* WRITESCRIPTLOG */ sub_803( "RJM", "PLAY_MIDSCENE_03 start", 0 );
         /* NIS_PRE_SETUP */ sub_42160( 1, 0, 0, 1 );
        if (NOT bParam0)
        {
             /* LOAD_MID_03_ASSETS */ sub_63874();
             /* LOADSEAMLESSCUTSCENE */ sub_29445( uParam2, 1 );
        }
        else
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "PLAY_MIDSCENE_03 forcing fade in", 0 );
            DO_SCREEN_FADE_IN( 0 );
        }
        if (bParam0)
        {
            CUTSCENE_REGISTER_ISEQ( 1419096468 );
            CUTSCENE_REGISTER_ISEQ( 123489604 );
            CUTSCENE_REGISTER_ISEQ( -900483547 );
            CUTSCENE_REGISTER_ISEQ( -652127296 );
            CUTSCENE_REGISTER_ISEQ( 8102532 );
            CUTSCENE_REGISTER_ISEQ( -1131749617 );
            CUTSCENE_REGISTER_ISEQ( 2119011196 );
            CUTSCENE_REGISTER_ISEQ( -1930417983 );
            SET_PED_DEFAULT_AIM_AT_COORD(  /* PLAYER_PED_ID */ sub_11378(), -287.63280000, 3.79891700, 1.71265600 );
            SET_PLAYER_FORCED_AIM(  /* PLAYER_ID */ sub_11416(), 1, 0 );
        }
         /* CREATE_MID_03_PEDS_AND_OBJECTS */ sub_64225();
         /* REGISTER_PEDS_MID_03 */ sub_64782( bParam0 );
        START_SEAMLESS_CUTSCENE();
        l_U2633 = 1;
        break;
        case 1:
         /* SET_TOWER_VISIBLE */ sub_67612( 0 );
        l_U2633 = 2;
        break;
        case 2:
        if ((l_U2595 == 13) AND (GET_CUTSCENE_TIME_MS() > 12945))
        {
            l_U2596 = 13;
        }
        if (HAS_CUTSCENE_FINISHED())
        {
            CAMERA_PLAY_ANIMATED( "LEVEL_S_NYBAR_CP_04", "VIG_15B_NYBAR_MPM_FWD_CAM", 0, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0, 0 );
        }
        case 3:
        if ((HAS_CUTSCENE_UNLOADED()) AND (HAS_CUTSCENE_FINISHED()))
        {
            if (l_U2595 == 13)
            {
                l_U2596 = 13;
            }
             /* P_SET_TWO_HANDED_WEAPON_VISIBLE */ sub_66070( l_U2601, 1 );
             /* P_SET_TWO_HANDED_WEAPON_VISIBLE */ sub_66070( l_U2601, 1 );
             /* SET_TOWER_VISIBLE */ sub_67612( 1 );
             /* CLEANUP_MID_03_ASSETS */ sub_67949();
             /* UNLOAD_MID_03_ASSETS */ sub_68041();
             /* WRITESCRIPTLOG */ sub_803( "RJM", "PLAY_MIDSCENE_03 end", 0 );
            Result = 1;
            l_U2633 = 3;
        }
        break;
    }
    return Result;
}

/* LOAD_MID_03_ASSETS */ void sub_63874()
{
     /* LOADMODEL */ sub_987( 233534649, 1 );
     /* LOADISEQ */ sub_1517( 1419096468, 1 );
     /* LOADISEQ */ sub_1517( 123489604, 1 );
     /* LOADISEQ */ sub_1517( -900483547, 1 );
     /* LOADISEQ */ sub_1517( -652127296, 1 );
     /* LOADISEQ */ sub_1517( 8102532, 1 );
     /* LOADISEQ */ sub_1517( -1131749617, 1 );
     /* LOADISEQ */ sub_1517( 2119011196, 1 );
     /* LOADISEQ */ sub_1517( -1930417983, 1 );
    return;
}

/* CREATE_MID_03_PEDS_AND_OBJECTS */ void sub_64225()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_MID_03_PEDS_AND_OBJECTS - start", 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2635, 0, 0, 0, 0.00000000, -1491110017, 26, 6, 0, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2649, 0, 0, 0, 0.00000000, 951389475, 26, 6, 0, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2663, 0, 0, 0, 0.00000000, 11941526, 26, 6, 0, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2677, 0, 0, 0, 0.00000000, 2031544278, 26, 6, 0, 0, 0 );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2691, 0, 0, 0, 0.00000000, -1969074258, 26, 6, 0, 0, 0 );
    l_U2634 =  /* CREATEPED */ sub_21953( ref l_U2635 );
    l_U2648 =  /* CREATEPED */ sub_21953( ref l_U2649 );
    l_U2662 =  /* CREATEPED */ sub_21953( ref l_U2663 );
    l_U2676 =  /* CREATEPED */ sub_21953( ref l_U2677 );
    l_U2690 =  /* CREATEPED */ sub_21953( ref l_U2691 );
    if ( /* IS_PED_VALID */ sub_22677( l_U2634 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( l_U2634, 434544317, 25000, 0, 0 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2634 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( l_U2648, -1074756423, 25000, 0, 0 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2634 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( l_U2662, -1074756423, 25000, 0, 0 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2634 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( l_U2676, -1074756423, 25000, 0, 0 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2634 ))
    {
         /* F_GIVEPEDWEAPON */ sub_13920( l_U2690, -1074756423, 25000, 0, 0 );
    }
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_MID_03_PEDS_AND_OBJECTS - end", 0 );
    return;
}

/* REGISTER_PEDS_MID_03 */ void sub_64782(boolean bParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "REGISTER_PEDS_MID_03 - start", 0 );
    if ( /* IS_MAX_VALID */ sub_35429())
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Registering Max with mid_03", 0 );
         /* P_PLAYER_HOLSTER_WEAPONS */ sub_64916( ref l_U2601, 1, 1 );
         /* P_SET_TWO_HANDED_WEAPON_VISIBLE */ sub_66070( l_U2601, 0 );
         /* P_SET_LEFT_HAND_WEAPON_VISIBLE */ sub_66209( l_U2601, 0 );
         /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 1 );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 ), "W_PI_Clt1911_Aa_H", 0 );
        CUTSCENE_REGISTER_ACTION_TREE_PLAY_NODE(  /* PLAYER_PED_ID */ sub_11378(), "/Global/Player/PlayerRoot/PLAYER_INITIALIZE_IDLE" );
        CUTSCENE_REGISTER_PED_TELEPORT(  /* PLAYER_PED_ID */ sub_11378(), g_U3141[3]._fU0, g_U3141[3]._fU12 );
        if (bParam0)
        {
            ISEQ_REGISTER_ENTITY( 1419096468, "ny_mpm_max",  /* PLAYER_PED_ID */ sub_11378(), 0 );
        }
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2634 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Registering piMid_03Guy1 with mid_03", 0 );
        REGISTER_PED_PRE_SEAMLESS_CUTSCENE( l_U2634, "G_NY_T_Sold_D", 0 );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND( l_U2634, 0, 0 ), "W_SG_BenM3_Aa_H", 1 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2648 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Registering piMid_03Guy2 with mid_03", 0 );
        REGISTER_PED_PRE_SEAMLESS_CUTSCENE( l_U2648, "G_NY_T_Sold_D^1", 0 );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND( l_U2648, 0, 0 ), "W_AR_AK47_Aa_H^2", 1 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2662 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Registering piMid_03Guy3 with mid_03", 0 );
        REGISTER_PED_PRE_SEAMLESS_CUTSCENE( l_U2662, "G_NY_T_Sold_D^2", 0 );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND( l_U2662, 0, 0 ), "W_AR_AK47_Aa_H", 1 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2676 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Registering piMid_03Guy4 with mid_03", 0 );
        REGISTER_PED_PRE_SEAMLESS_CUTSCENE( l_U2676, "G_NY_T_Sold_D^3", 0 );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND( l_U2676, 0, 0 ), "W_AR_AK47_Aa_H^3", 1 );
    }
    if ( /* IS_PED_VALID */ sub_22677( l_U2690 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Registering piMid_03Guy5 with mid_03", 0 );
        REGISTER_PED_PRE_SEAMLESS_CUTSCENE( l_U2690, "G_NY_T_Sold_D^4", 0 );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND( l_U2690, 0, 0 ), "W_AR_AK47_Aa_H^1", 1 );
    }
    if (bParam0)
    {
        if (DOES_OBJECT_EXIST( g_U3116 ))
        {
            ISEQ_REGISTER_ENTITY( 123489604, "TOWER_AA", g_U3116, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3112 ))
        {
            ISEQ_REGISTER_ENTITY( -900483547, "TOWER_ANM01", g_U3112, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3113 ))
        {
            ISEQ_REGISTER_ENTITY( -652127296, "TOWER_ANM02", g_U3113, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3115 ))
        {
            ISEQ_REGISTER_ENTITY( 8102532, "TOWER_ANM03", g_U3115, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3114 ))
        {
            ISEQ_REGISTER_ENTITY( -1131749617, "TOWER_BASE", g_U3114, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3117 ))
        {
            ISEQ_REGISTER_ENTITY( 2119011196, "RF_WT_lid_01", g_U3117, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3118 ))
        {
            ISEQ_REGISTER_ENTITY( -1930417983, "RF_WT_lid_02", g_U3118, 1 );
        }
    }
    REGISTER_HIDE_ENTITY_AT_POSITION( g_U2895._fU0, g_U2895._fU4 );
     /* WRITESCRIPTLOG */ sub_803( "RJM", "REGISTER_PEDS_MID_03 - end", 0 );
    return;
}

/* P_PLAYER_HOLSTER_WEAPONS */ void sub_64916(int iParam0, int iParam1, unknown uParam2)
{
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;
    unknown uVar11;
    unknown uVar12;
    unknown uVar13;

     /* RESET_WEAPON_CONFIG */ sub_64955( iParam0 );
    if ((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
    {
        uVar5 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar5 )) == 1)
        {
            if (( /* IS_WEAPON_SINGLE_HANDED */ sub_62920( uVar5 )) == 1)
            {
                ref iParam0->_fU0->_fU0 = uVar5;
                ref iParam0->_fU0->_fU4 = GET_WEAPON_TYPE( uVar5 );
            }
            else if (( /* IS_WEAPON_TWO_HANDED */ sub_65200( uVar5 )) == 1)
            {
                ref iParam0->_fU24->_fU0 = uVar5;
                ref iParam0->_fU24->_fU4 = GET_WEAPON_TYPE( uVar5 );
            }
        }
        uVar6 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar6 )) == 1)
        {
            ref iParam0->_fU12->_fU0 = uVar6;
            ref iParam0->_fU12->_fU4 = GET_WEAPON_TYPE( uVar6 );
        }
        uVar7 = GET_WEAPON_FROM_HOLSTER(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar7 )) == 1)
        {
            ref iParam0->_fU36->_fU0 = uVar7;
            ref iParam0->_fU36->_fU4 = GET_WEAPON_TYPE( uVar7 );
        }
        uVar8 = GET_WEAPON_FROM_HOLSTER(  /* PLAYER_PED_ID */ sub_11378(), 1 );
        if ((GET_DOES_WEAPON_EXIST( uVar8 )) == 1)
        {
            ref iParam0->_fU48->_fU0 = uVar8;
            ref iParam0->_fU48->_fU4 = GET_WEAPON_TYPE( uVar8 );
        }
        uVar9 = GET_WEAPON_FROM_HOLSTER(  /* PLAYER_PED_ID */ sub_11378(), 2 );
        if ((GET_DOES_WEAPON_EXIST( uVar9 )) == 1)
        {
            ref iParam0->_fU60->_fU0 = uVar9;
            ref iParam0->_fU60->_fU4 = GET_WEAPON_TYPE( uVar9 );
        }
    }
    if (iParam1 == 0)
    {
        if ((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
        {
            uVar10 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
            if ((GET_DOES_WEAPON_EXIST( uVar10 )) == 1)
            {
                SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0, uParam2 );
            }
            uVar11 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
            if ((GET_DOES_WEAPON_EXIST( uVar11 )) == 1)
            {
                SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 1, uParam2 );
            }
        }
    }
    else if (iParam1 == 1)
    {
        if ((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
        {
            uVar12 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
            if ((GET_DOES_WEAPON_EXIST( uVar12 )) == 1)
            {
                if (( /* IS_WEAPON_TWO_HANDED */ sub_65200( uVar12 )) == 1)
                {
                    SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0, uParam2 );
                }
            }
            uVar13 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
            if ((GET_DOES_WEAPON_EXIST( uVar13 )) == 1)
            {
                SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 1, uParam2 );
            }
        }
    }
    return;
}

/* RESET_WEAPON_CONFIG */ void sub_64955(int iParam0)
{
    ref iParam0->_fU0->_fU0 = 0;
    ref iParam0->_fU0->_fU4 = 0;
    ref iParam0->_fU12->_fU0 = 0;
    ref iParam0->_fU12->_fU4 = 0;
    ref iParam0->_fU24->_fU0 = 0;
    ref iParam0->_fU24->_fU4 = 0;
    ref iParam0->_fU36->_fU0 = 0;
    ref iParam0->_fU36->_fU4 = 0;
    ref iParam0->_fU48->_fU0 = 0;
    ref iParam0->_fU48->_fU4 = 0;
    ref iParam0->_fU60->_fU0 = 0;
    ref iParam0->_fU60->_fU4 = 0;
    return;
}

/* IS_WEAPON_TWO_HANDED */ int sub_65200(unknown uParam0)
{
    int iVar3;

    if ((GET_DOES_WEAPON_EXIST( uParam0 )) == 1)
    {
        iVar3 = GET_WEAPON_TYPE( uParam0 );
        if ((iVar3 == -2075384407) || ((iVar3 == 10648147) || ((iVar3 == 1224272620) || ((iVar3 == 1478009203) || ((iVar3 == 1964270085) || ((iVar3 == -110877124) || ((iVar3 == 427207702) || ((iVar3 == 319712764) || ((iVar3 == 514118749) || ((iVar3 == -184942895) || ((iVar3 == -168327769) || ((iVar3 == 434544317) || ((iVar3 == -1659006841) || ((iVar3 == 930042831) || ((iVar3 == 1001413062) || ((iVar3 == 377623895) || ((iVar3 == -1312131151) || ((iVar3 == -1787162676) || ((iVar3 == 724901397) || ((iVar3 == 57534114) || ((iVar3 == 840671040) || ((iVar3 == 1308526797) || ((iVar3 == -1074756423) || ((iVar3 == 1992962408) || (iVar3 == -1013714740)))))))))))))))))))))))))
        {
            return 1;
        }
    }
    return 0;
}

/* P_SET_TWO_HANDED_WEAPON_VISIBLE */ void sub_66070(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11, unknown uParam12, unknown uParam13, unknown uParam14, unknown uParam15, unknown uParam16, unknown uParam17, unknown uParam18)
{
    unknown uVar21;
    unknown uVar22;

    uVar21 = uParam0._fU24._fU0;
    if ((GET_DOES_WEAPON_EXIST( uVar21 )) == 1)
    {
        SET_WEAPON_VISIBLE( uVar21, uParam18 );
    }
    uVar22 = uParam0._fU60._fU0;
    if ((GET_DOES_WEAPON_EXIST( uVar22 )) == 1)
    {
        SET_WEAPON_VISIBLE( uVar22, uParam18 );
    }
    return;
}

/* P_SET_LEFT_HAND_WEAPON_VISIBLE */ void sub_66209(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11, unknown uParam12, unknown uParam13, unknown uParam14, unknown uParam15, unknown uParam16, unknown uParam17, unknown uParam18)
{
    unknown uVar21;

    uVar21 = uParam0._fU12._fU0;
    if ((GET_DOES_WEAPON_EXIST( uVar21 )) == 1)
    {
        SET_WEAPON_VISIBLE( uVar21, uParam18 );
    }
    return;
}

/* SET_TOWER_VISIBLE */ void sub_67612(unknown uParam0)
{
    SET_OBJECT_VISIBLE( g_U3112, uParam0 );
    SET_OBJECT_VISIBLE( g_U3113, uParam0 );
    SET_OBJECT_VISIBLE( g_U3114, uParam0 );
    SET_OBJECT_VISIBLE( g_U3115, uParam0 );
    SET_OBJECT_VISIBLE( g_U3116, uParam0 );
    SET_OBJECT_VISIBLE( g_U3117, uParam0 );
    SET_OBJECT_VISIBLE( g_U3118, uParam0 );
    return;
}

/* CLEANUP_MID_03_ASSETS */ void sub_67949()
{
     /* CLEANPED */ sub_21861( l_U2634 );
     /* CLEANPED */ sub_21861( l_U2648 );
     /* CLEANPED */ sub_21861( l_U2662 );
     /* CLEANPED */ sub_21861( l_U2676 );
     /* CLEANPED */ sub_21861( l_U2690 );
    return;
}

/* UNLOAD_MID_03_ASSETS */ void sub_68041()
{
     /* UNLOADMODEL */ sub_34347( 233534649 );
    return;
}

/* HANDLE_ROOFTOP_MPM */ void sub_68298()
{
    int Result;
    unknown uVar3;
    unknown uVar4;
    int iVar5;

    Result = 0;
    switch (l_U2854)
    {
        case 1:
         /* WRITESCRIPTLOG */ sub_803( "BSW", "HANDLE_ROOFTOP_MPM - rooftopMPMState start", 0 );
         /* SET_WEATHER_AND_TIME_OF_DAY_FOR_NYBAR */ sub_10751( 2, 0 );
        if (g_U780 != 3)
        {
             /* WRITESCRIPTLOG */ sub_803( "BSW", "updating current checkpoint to MCE_ROOFTOPS_MPM", 0 );
            g_U780 = 3;
             /* P_SAVE_PLAYER_DATA_CHECKPOINT */ sub_16140( ref l_U385, 3,  /* PLAYER_PED_ID */ sub_11378(), g_U3141[3]._fU0, g_U3141[3]._fU12, g_U3141[3]._fU16, g_U3141[3]._fU20, 0 );
        }
         /* LOAD_POST_MPM_ASSETS */ sub_2576( 0 );
        END_CONTEXT( "NYBAR_APARTMENT_TO_MPM" );
        START_CONTEXT( "NYBAR_MPM" );
         /* NIS_PRE_SETUP */ sub_42160( 1, 0, 0, 1 );
         /* CREATE_MPM_ENEMIES */ sub_68675();
         /* TASK_MPM_ENEMIES */ sub_69349();
         /* MAR_NY_HOLSTERRIFLEORDUALANDDRAWPISTOL */ sub_69737( ref uVar3, ref uVar4 );
         /* LOADISEQ */ sub_1517( 1681130475, 0 );
         /* LOADISEQ */ sub_1517( -283082350, 0 );
         /* LOADISEQ */ sub_1517( -1236175571, 0 );
        l_U2595 = 12;
        l_U2596 = 12;
        if (GET_ADRENALINE_AMT() < 0.10000000)
        {
            SET_ADRENALINE_AMT( 0.10000000 );
        }
        ACTIVATE_BULLET_TIME( 0, 1.00000000, 1 );
        if ((ISEQ_QUERY_STATE( 1419096468, 3 )) == 0)
        {
             /* TELEPORTPED */ sub_30319(  /* PLAYER_PED_ID */ sub_11378(), g_U3141[3]._fU0, g_U3141[3]._fU12 );
            CAMERA_PLAY_ANIMATED( "LEVEL_S_NYBAR_CP_04", "VIG_15B_NYBAR_MPM_FWD_CAM", 0, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0, 0 );
             /* WRITESCRIPTLOG */ sub_803( "bsw", "registering the menagerie of watertower iseqs", 0 );
            if ( /* IS_MAX_VALID */ sub_35429())
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering Max", 0 );
                ISEQ_REGISTER_ENTITY( 1419096468, "ny_mpm_max",  /* PLAYER_PED_ID */ sub_11378(), 0 );
            }
            if (DOES_OBJECT_EXIST( g_U3116 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_AA", 0 );
                ISEQ_REGISTER_ENTITY( 123489604, "TOWER_AA", g_U3116, 1 );
            }
            if (DOES_OBJECT_EXIST( g_U3112 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_ANM01", 0 );
                ISEQ_REGISTER_ENTITY( -900483547, "TOWER_ANM01", g_U3112, 1 );
            }
            if (DOES_OBJECT_EXIST( g_U3113 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_ANM02", 0 );
                ISEQ_REGISTER_ENTITY( -652127296, "TOWER_ANM02", g_U3113, 1 );
            }
            if (DOES_OBJECT_EXIST( g_U3115 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_ANM03", 0 );
                ISEQ_REGISTER_ENTITY( 8102532, "TOWER_ANM03", g_U3115, 1 );
            }
            if (DOES_OBJECT_EXIST( g_U3114 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_BASE", 0 );
                ISEQ_REGISTER_ENTITY( -1131749617, "TOWER_BASE", g_U3114, 1 );
            }
            if (DOES_OBJECT_EXIST( g_U3117 ))
            {
                ISEQ_REGISTER_ENTITY( 2119011196, "RF_WT_lid_01", g_U3117, 1 );
            }
            if (DOES_OBJECT_EXIST( g_U3118 ))
            {
                ISEQ_REGISTER_ENTITY( -1930417983, "RF_WT_lid_02", g_U3118, 1 );
            }
            ISEQ_START( 1419096468 );
            ISEQ_START( 123489604 );
            ISEQ_START( -900483547 );
            ISEQ_START( -652127296 );
            ISEQ_START( 8102532 );
            ISEQ_START( -1131749617 );
            ISEQ_START( 2119011196 );
            ISEQ_START( -1930417983 );
            FREEZE_PED_POSITION(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        }
        PLAY_SCRIPT_STREAM_FROM_OBJECT( g_U3117, 0 );
        if (NOT ( /* F_IMAGEFX_FADE_IN */ sub_50328()))
        {
            DO_SCREEN_FADE_IN( 100 );
        }
         /* LOADSEAMLESSCUTSCENE */ sub_29445( ref l_U2704, 0 );
         /* CREATETIMER */ sub_10316( ref l_U2080, 10, 1, 0 );
         /* STARTTIMER */ sub_34724( ref l_U2080 );
        l_U2854 = 2;
        break;
        case 2:
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2080 ))
        {
             /* SETUP_MPM_CAM_SETTINGS */ sub_71726();
        }
        if ((CAMERA_ANIMATED_CURRENT_TIME() + 1) >= (CAMERA_ANIMATED_LENGTH( "LEVEL_S_NYBAR_CP_04", "VIG_15B_NYBAR_MPM_FWD_CAM" )))
        {
            ACTIVATE_BULLET_TIME( 0, 0.70000000, 1 );
            SET_GAMEPLAY_CAM_RELATIVE_HEADING( g_U3141[3]._fU16, 1065353216, 0 );
            SET_GAMEPLAY_CAM_RELATIVE_PITCH( g_U3141[3]._fU20, 1065353216, 0 );
            CAMERA_FREEZE_FRAME( 1, 400, 0, 0 );
            l_U2854 = 3;
        }
        break;
        case 3:
         /* WRITESCRIPTLOG */ sub_803( "bsw", "HANDLE_ROOFTOP_MPM - activating bullet time...", 0 );
         /* NIS_POST_SETUP */ sub_72167( 1, 1 );
         /* TOGGLE_MPM_SETTINGS */ sub_72472( 1 );
         /* P_LIMIT_PLAYER_ACTIONS_FOR_MPM */ sub_72717();
         /* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24346( ref l_U2206, 0 );
         /* CREATETIMER */ sub_10316( ref l_U2089, 2100, 1, 0 );
         /* STARTTIMER */ sub_34724( ref l_U2089 );
        l_U2854 = 4;
        break;
        case 4:
        iVar5 =  /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U2206 );
        if ((iVar5 < 4) AND (l_U2595 == 15))
        {
            l_U2596 = 15;
        }
        if ( /* IS_MAX_VALID */ sub_35429())
        {
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2089 ))
            {
                CLEAR_PED_DEFAULT_AIM(  /* PLAYER_PED_ID */ sub_11378() );
                SET_PLAYER_FORCED_AIM(  /* PLAYER_ID */ sub_11416(), 0, 0 );
                if ((PED_GET_ACTION_INTENTION_STATUS(  /* PLAYER_PED_ID */ sub_11378(), 47 )) == 3)
                {
                     /* WRITESCRIPTLOG */ sub_803( "BSW", "ACT_INT_SEQ_ACTION01 is started", 0 );
                }
                 /* PED_CLEAR_ALL_ACTION_INTENTIONS */ sub_73109(  /* PLAYER_PED_ID */ sub_11378() );
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "HANDLE_ROOFTOP_MPM - times up, how did you do?", 0 );
                END_CONTEXT( "NYBAR_MPM" );
                 /* TOGGLE_MPM_SETTINGS */ sub_72472( 0 );
                SET_CAMERA_OVERRIDE( "", "", 0, 1, 1 );
                l_U2854 = 7;
            }
        }
        break;
        case 7: if ( /* HANDLE_ROOFTOP_MPM_DIVE_NIS */ sub_73430())
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "MPM ready for reckoning", 0 );
            if (( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U2206 )) == 0)
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "HANDLE_ROOFTOP_MPM - 0 guys remaining, you WIN", 0 );
                 /* CREATE_PASSOS_ROOFTOP_MPM */ sub_30663();
                 /* INITIALIZE_VARS_FOR_MID_03C */ sub_75805();
                l_U2596 = 16;
                 /* DESTROY_TOWER */ sub_28881();
                 /* UNLOADMODEL */ sub_34347( -1522991054 );
                 /* UNLOADMODEL */ sub_34347( -1193498759 );
                 /* UNLOADMODEL */ sub_34347( 588151771 );
                 /* UNLOADMODEL */ sub_34347( 216303562 );
                 /* UNLOADMODEL */ sub_34347( -946946919 );
                 /* UNLOADMODEL */ sub_34347( -1915312722 );
                 /* UNLOADMODEL */ sub_34347( -1549971141 );
                 /* LOAD_POST_MPM_ASSETS */ sub_2576( 1 );
                 /* CREATE_DESTROYED_TOWER */ sub_31193();
                 /* PLAY_MIDSCENE_03C */ sub_75953( 1, 0 );
                 /* P_CLEANUP_DEAD_MPM_ENEMIES_NEAR_ROOF_DOOR */ sub_77982();
                l_U2854 = 5;
            }
            else
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "HANDLE_ROOFTOP_MPM - didnt kill everyone, you LOSE", 0 );
                 /* UNLOAD_POST_MPM_ASSETS */ sub_78340();
                l_U2854 = 6;
            }
        }
        case 6:
        if (l_U2854 == 6)
        {
            if ( /* HANDLE_ROOFTOP_MPM_FAIL_NIS */ sub_78502())
            {
                l_U2854 = 0;
            }
        }
        break;
        case 5:
        if ( /* PLAY_MIDSCENE_03C */ sub_75953( 1, 0 ))
        {
            CAMERA_ENABLE_SHOULDER_MODE( 1 );
             /* NIS_RETURN_TO_GAMEPLAY_CAM */ sub_79078( 0, 0, 0, -859915232, -859915232, 0 );
            Result = 1;
        }
        break;
        case 0: break;
    }
    return Result;
}

/* CREATE_MPM_ENEMIES */ void sub_68675()
{
     /* PED_ARRAY_INITIALIZE */ sub_21317( ref l_U2127, ref l_U2206, ref l_U2213, 1478009203, 1.00000000, "AIT_EXPERT", 0, 0, 25000, 2, 0, 25000, 0 );
     /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U2206, "MPM_GUYS_" );
     /* PED_ARRAY_SET_BLOCKING_OF_NON_TEMPORARY_EVENTS */ sub_24346( ref l_U2206, 1 );
     /* PED_ARRAY_SET_ALERTNESS */ sub_68793( ref l_U2206, 3 );
    REMOVE_ALL_PED_WEAPONS( l_U2206[1] );
     /* F_GIVEPEDWEAPON */ sub_13920( l_U2206[1], 434544317, 25000, 0, 0 );
    REMOVE_ALL_PED_WEAPONS( l_U2206[2] );
     /* F_GIVEPEDWEAPON */ sub_13920( l_U2206[2], 1478009203, 25000, 0, 0 );
    REMOVE_ALL_PED_WEAPONS( l_U2206[3] );
     /* F_GIVEPEDWEAPON */ sub_13920( l_U2206[3], 1478009203, 25000, 0, 0 );
    SET_PED_DEFAULT_AIM_AT_COORD( l_U2206[0], -284.67000000, -7.81000000, 1.85000000 );
    SET_PED_DEFAULT_AIM_AT_COORD( l_U2206[4], -284.67000000, -7.81000000, 1.85000000 );
     /* PED_ARRAY_SET_ONE_SHOT_KILL */ sub_69121( ref l_U2206, 1 );
     /* PED_ARRAY_SET_CAN_USE_COVER */ sub_69234( ref l_U2206, 0 );
     /* PED_ARRAY_SET_TETHERBOX */ sub_24108( ref l_U2206, l_U1558, 1 );
    return;
}

/* PED_ARRAY_SET_ALERTNESS */ void sub_68793(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* PED_SET_ALERTNESS */ sub_68853( ref (uParam0^)[I], uParam1 );
    }
    return;
}

/* PED_SET_ALERTNESS */ void sub_68853(unknown uParam0, unknown uParam1)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        SET_PED_ALERTNESS( (uParam0^), uParam1 );
    }
    return;
}

/* PED_ARRAY_SET_ONE_SHOT_KILL */ void sub_69121(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( (uParam0^)[I] ))
        {
            SET_PED_AS_ONE_SHOT_KILL( (uParam0^)[I], uParam1 );
        }
    }
    return;
}

/* PED_ARRAY_SET_CAN_USE_COVER */ void sub_69234(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        SET_PED_COMBAT_ATTRIBUTES( (uParam0^)[I], 1, uParam1 );
    }
    return;
}

/* TASK_MPM_ENEMIES */ void sub_69349()
{
    int I;

    for ( I = 0; I <= (l_U2206 - 1); I++ )
    {
        if ( /* IS_PED_VALID */ sub_22677( l_U2206[I] ))
        {
            SET_PED_FLAG_BLOCK_GORE_REACTION( l_U2206[I], 1 );
        }
    }
     /* PED_TASK_COMBAT_PLAYER */ sub_54660( l_U2206[0], 1 );
     /* PED_SET_COMBAT_MOVEMENT */ sub_69465( ref l_U2206[0], 0 );
     /* PED_TASK_COMBAT_PLAYER */ sub_54660( l_U2206[1], 1 );
     /* PED_SET_COMBAT_MOVEMENT */ sub_69465( ref l_U2206[1], 0 );
     /* PED_TASK_COMBAT_PLAYER */ sub_54660( l_U2206[2], 1 );
     /* PED_SET_COMBAT_MOVEMENT */ sub_69465( ref l_U2206[2], 0 );
     /* PED_TASK_COMBAT_PLAYER */ sub_54660( l_U2206[3], 1 );
     /* PED_SET_COMBAT_MOVEMENT */ sub_69465( ref l_U2206[3], 0 );
     /* PED_TASK_COMBAT_PLAYER */ sub_54660( l_U2206[4], 1 );
     /* PED_SET_COMBAT_MOVEMENT */ sub_69465( ref l_U2206[4], 0 );
    if ( /* IS_PED_VALID */ sub_22677( l_U2206[5] ))
    {
        RESET_PED_TETHERING( l_U2206[5] );
         /* PED_TASK_ATTACK_MOVE */ sub_55353( l_U2206[5], -286.39000000, 2.19000000, 1.50000000, 0.50000000, 20, -1, 4 );
         /* PED_SET_COMBAT_MOVEMENT */ sub_69465( ref l_U2206[5], 2 );
    }
    return;
}

/* PED_SET_COMBAT_MOVEMENT */ void sub_69465(unknown uParam0, unknown uParam1)
{
    if ( /* IS_PED_VALID */ sub_22677( (uParam0^) ))
    {
        SET_PED_COMBAT_MOVEMENT( (uParam0^), uParam1 );
    }
    return;
}

/* MAR_NY_HOLSTERRIFLEORDUALANDDRAWPISTOL */ void sub_69737(unknown uParam0, unknown uParam1)
{
    unknown uVar4;

     /* WRITESCRIPTLOG */ sub_803( "TEH", "MAR_NY_HolsterRifleOrDualAndDrawPistol begun", 0 );
    uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
    if (GET_DOES_WEAPON_EXIST( uVar4 ))
    {
        if (((uParam0^) == 1) || (((GET_WEAPON_TYPE( uVar4 )) == 1992962408) || (((GET_WEAPON_TYPE( uVar4 )) == 724901397) || (((GET_WEAPON_TYPE( uVar4 )) == 57534114) || (((GET_WEAPON_TYPE( uVar4 )) == 1308526797) || (((GET_WEAPON_TYPE( uVar4 )) == -1074756423) || (((GET_WEAPON_TYPE( uVar4 )) == -1013714740) || (((GET_WEAPON_TYPE( uVar4 )) == -184942895) || (((GET_WEAPON_TYPE( uVar4 )) == -168327769) || (((GET_WEAPON_TYPE( uVar4 )) == 1845102363) || ((GET_WEAPON_TYPE( uVar4 )) == 434544317)))))))))))
        {
             /* WRITESCRIPTLOG */ sub_803( "TEH", "Holster weapon and draw gun", 0 );
            SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0, 1 );
            uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
            while (GET_DOES_WEAPON_EXIST( uVar4 ))
            {
                WAIT( 0 );
                uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
                 /* WRITESCRIPTLOG */ sub_803( "TEH", "Waiting for right hand to be empty", 0 );
            }
        }
    }
    uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
    if (GET_DOES_WEAPON_EXIST( uVar4 ))
    {
        (uParam1^) = 1;
         /* WRITESCRIPTLOG */ sub_803( "TEH", "Dual wielding is true", 0 );
        SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 1, 1 );
        uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
        while (GET_DOES_WEAPON_EXIST( uVar4 ))
        {
            WAIT( 0 );
            uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
        }
    }
    uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
    if (NOT (GET_DOES_WEAPON_EXIST( uVar4 )))
    {
        uVar4 = GET_WEAPON_FROM_HOLSTER(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        if (NOT (GET_DOES_WEAPON_EXIST( uVar4 )))
        {
            uVar4 = GET_WEAPON_FROM_HOLSTER(  /* PLAYER_PED_ID */ sub_11378(), 1 );
        }
        SELECT_WEAPON_TO_HAND(  /* PLAYER_PED_ID */ sub_11378(), uVar4, 0, 1 );
        uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
        while (NOT (GET_DOES_WEAPON_EXIST( uVar4 )))
        {
            WAIT( 0 );
            uVar4 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
             /* WRITESCRIPTLOG */ sub_803( "TEH", "Waiting for right hand to be full", 0 );
        }
    }
     /* WRITESCRIPTLOG */ sub_803( "TEH", "MAR_NY_HolsterRifleOrDualAndDrawPistol ended", 0 );
    return;
}

/* SETUP_MPM_CAM_SETTINGS */ void sub_71726()
{
     /* WRITESCRIPTLOG */ sub_803( "BSW", "SETUP_MPM_CAM_SETTINGS() - start", 0 );
    SET_CAMERA_OVERRIDE( "NYBAR_MPM_AIM_CAMERA", "NYBAR_MPM_AIM_CAMERA", 0, 1, 1 );
    CAMERA_ENABLE_SHOULDER_MODE( 0 );
    SET_CAM_SIDE_LEFT( 0 );
    SET_PLAYER_FORCED_AIM(  /* PLAYER_ID */ sub_11416(), 1, 0 );
    SET_GAMEPLAY_CAM_RELATIVE_HEADING( g_U3141[3]._fU16, 1065353216, 0 );
    SET_GAMEPLAY_CAM_RELATIVE_PITCH( g_U3141[3]._fU20, 1065353216, 0 );
    return;
}

/* NIS_POST_SETUP */ void sub_72167(boolean bParam0, boolean bParam1)
{
    SET_WIDESCREEN_BORDERS( 0, 500 );
    DISPLAY_HUD( 1 );
    if (NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
    {
        SET_PLAYER_CONTROL(  /* PLAYER_ID */ sub_11416(), 1, 0 );
        SET_PED_INVINCIBLE(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        if (bParam0)
        {
             /* P_MAX_RELOAD_WEAPONS */ sub_72265();
        }
    }
    PULSE_CROSSHAIR( 1 );
    if (bParam1)
    {
        DESTROY_ALL_CAMS();
    }
    return;
}

/* P_MAX_RELOAD_WEAPONS */ void sub_72265()
{
    unknown uVar2;
    unknown uVar3;
    unknown uVar4;
    unknown uVar5;

    if ((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0)
    {
        uVar2 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 );
        uVar3 = GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 1, 0 );
        if ((GET_DOES_WEAPON_EXIST( uVar2 )) == 1)
        {
            uVar4 = GET_MAX_AMMO_IN_HAND_CLIP_MP(  /* PLAYER_PED_ID */ sub_11378(), 0 );
            SET_WEAPON_AMMO_IN_CLIP( uVar2, uVar4 );
        }
        if ((GET_DOES_WEAPON_EXIST( uVar3 )) == 1)
        {
            uVar5 = GET_MAX_AMMO_IN_HAND_CLIP_MP(  /* PLAYER_PED_ID */ sub_11378(), 1 );
            SET_WEAPON_AMMO_IN_CLIP( uVar3, uVar5 );
        }
    }
    return;
}

/* TOGGLE_MPM_SETTINGS */ void sub_72472(boolean bParam0)
{
     /* WRITESCRIPTLOG */ sub_803( "bsw", "toggling MPM settings", 0 );
    if ( /* IS_MAX_VALID */ sub_35429())
    {
        SET_PED_INVINCIBLE(  /* PLAYER_PED_ID */ sub_11378(), bParam0 );
        SET_PED_PROOFS(  /* PLAYER_PED_ID */ sub_11378(), bParam0, bParam0, bParam0, bParam0, bParam0 );
        SET_PED_CONSUMING_AMMO(  /* PLAYER_PED_ID */ sub_11378(), NOT bParam0 );
        SET_PED_CAN_SWITCH_WEAPON(  /* PLAYER_PED_ID */ sub_11378(), NOT bParam0 );
    }
    if (bParam0)
    {
        DISPLAY_HUD( 0 );
        ENABLE_CROSSHAIR( 1 );
        ENABLE_MPM( 1 );
        ENABLE_ALL_ADRENALINE( 0 );
        SET_CROSSHAIR_PULSE();
    }
    else
    {
        ENABLE_MPM( 0 );
        ENABLE_ALL_ADRENALINE( 1 );
        ENABLE_CROSSHAIR( 0 );
        DISPLAY_HUD( 0 );
    }
    SET_SILHOUETTE_ACTIVE( NOT bParam0 );
    return;
}

/* P_LIMIT_PLAYER_ACTIONS_FOR_MPM */ void sub_72717()
{
     /* WRITESCRIPTLOG */ sub_803( "SP", "P_LIMIT_PLAYER_ACTIONS_FOR_MPM", 0 );
    if (((IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )) == 0) AND ((IS_PLAYER_DEAD(  /* PLAYER_ID */ sub_11416() )) == 0))
    {
        SET_PLAYER_CONTROL(  /* PLAYER_ID */ sub_11416(), 0, 0 );
        REENABLE_PLAYER_INPUT( 14 );
        REENABLE_PLAYER_INPUT( 15 );
        REENABLE_PLAYER_INPUT( 16 );
        REENABLE_PLAYER_INPUT( 17 );
        REENABLE_PLAYER_INPUT( 6 );
        REENABLE_PLAYER_INPUT( 4 );
    }
    return;
}

/* PED_CLEAR_ALL_ACTION_INTENTIONS */ void sub_73109(unknown uParam0)
{
    if ( /* IS_PED_VALID */ sub_22677( uParam0 ))
    {
        PED_FINISH_ACTION_INTENTION( uParam0, 47 );
        PED_FINISH_ACTION_INTENTION( uParam0, 48 );
        PED_FINISH_ACTION_INTENTION( uParam0, 49 );
        PED_FINISH_ACTION_INTENTION( uParam0, 50 );
        PED_FINISH_ACTION_INTENTION( uParam0, 51 );
        PED_FINISH_ACTION_INTENTION( uParam0, 52 );
        PED_FINISH_ACTION_INTENTION( uParam0, 53 );
        PED_FINISH_ACTION_INTENTION( uParam0, 54 );
        PED_FINISH_ACTION_INTENTION( uParam0, 55 );
        PED_FINISH_ACTION_INTENTION( uParam0, 56 );
        PED_FINISH_ACTION_INTENTION( uParam0, 57 );
        PED_FINISH_ACTION_INTENTION( uParam0, 58 );
    }
    return;
}

/* HANDLE_ROOFTOP_MPM_DIVE_NIS */ void sub_73430()
{
    int Result;

    Result = 0;
    switch (l_U2856)
    {
        case 0:
         /* NIS_PRE_SETUP */ sub_42160( 1, 0, 0, 1 );
         /* NIS_CREATE_STATIC_CAM */ sub_43223( ref l_U2886, -287.49000000, -12.91000000, -9.84000000, 70.00000000, 0.00000000, 58.33000000, 45.00000000, 400 );
         /* NIS_PLAY_STATIC_CAMERA */ sub_43941( ref l_U2886 );
        ACTIVATE_BULLET_TIME( 0, 0.30000000, 1 );
         /* P_DEACTIVATEPEDARRAY */ sub_24818( ref l_U2206 );
        l_U1608 =  /* F_GET_FIRST_LIVING_PED_FROM_ARRAY */ sub_73612( ref l_U2206 );
        if ( /* IS_PED_VALID */ sub_22677( l_U1608 ))
        {
             /* P_ACTIVATEPED */ sub_33665( l_U1608 );
            CLEAR_PED_TASKS_IMMEDIATELY( l_U1608 );
            SET_BLOCKING_OF_NON_TEMPORARY_EVENTS( l_U1608, 1 );
             /* TELEPORTPED */ sub_30319( l_U1608, -287.72900000, -5.97800000, 1.49545100, 180.00000000 );
        }
         /* CREATE_TOWER */ sub_28826( 0 );
        if (DOES_OBJECT_EXIST( g_U3116 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_AA", 0 );
            ISEQ_REGISTER_ENTITY( 361106065, "TOWER_AA", g_U3116, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3112 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_ANM01", 0 );
            ISEQ_REGISTER_ENTITY( 1876730400, "TOWER_ANM01", g_U3112, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3113 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_ANM02", 0 );
            ISEQ_REGISTER_ENTITY( 1423764005, "TOWER_ANM02", g_U3113, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3115 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_ANM03", 0 );
            ISEQ_REGISTER_ENTITY( -361846818, "TOWER_ANM03", g_U3115, 1 );
        }
        if (DOES_OBJECT_EXIST( g_U3114 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering TOWER_BASE", 0 );
            ISEQ_REGISTER_ENTITY( -787715329, "TOWER_BASE", g_U3114, 1 );
        }
         /* LOADISEQ */ sub_1517( 1681130475, 1 );
        ISEQ_UNREGISTER_ENTITY( 1419096468, "ny_mpm_max" );
         /* TERMINATEISEQ */ sub_28029( 1419096468, 0 );
        ISEQ_REGISTER_ENTITY( 1681130475, "max",  /* PLAYER_PED_ID */ sub_11378(), 0 );
        ISEQ_START( 1681130475 );
         /* TELEPORTPED */ sub_30319(  /* PLAYER_PED_ID */ sub_11378(), -289.10710000, -12.40520000, 5.59287900, 0.00000000 );
         /* CLEANOBJECT */ sub_26423( g_U3117 );
         /* CLEANOBJECT */ sub_26423( g_U3118 );
        ISEQ_START( 361106065 );
        ISEQ_START( 1876730400 );
        ISEQ_START( 1423764005 );
        ISEQ_START( -361846818 );
        ISEQ_START( -787715329 );
        l_U2856 = 1;
        break;
        case 1:
        l_U2917++;
        if ((l_U2917 mod 2) == 0)
        {
             /* UPDATE_MAX_LEAP_POSITION */ sub_74498();
        }
        if ( /* NIS_IS_SHOT_FINISHED */ sub_74639( ref l_U2886, 1 ))
        {
            if ( /* IS_MAX_VALID */ sub_35429())
            {
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering Max with S_NYBAR_MID_03B_HANG", 0 );
                PED_SET_ACTION_INTENTION(  /* PLAYER_PED_ID */ sub_11378(), 48, 1000, 0.00000000, 0.00000000, 0.00000000 );
                 /* P_PLAYER_HOLSTER_WEAPONS */ sub_64916( ref l_U2108, 1, 1 );
                 /* P_SET_LEFT_HAND_WEAPON_VISIBLE */ sub_66209( l_U2108, 0 );
                 /* P_SET_TWO_HANDED_WEAPON_VISIBLE */ sub_66070( l_U2108, 0 );
                 /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 1 );
                 /* TELEPORTPED */ sub_30319(  /* PLAYER_PED_ID */ sub_11378(), g_U3105, g_U3111 );
            }
            START_PARTICLE_FX_NON_LOOPED_AT_COORD( "NYC_WT_Blast_S", -288.48500000, -14.00000000, 1.50000000, 0.00000000, 0.00000000, 0.00000000, 1065353216 );
            CAMERA_PLAY_ANIMATED( l_U2883, l_U2884, 0, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0, 0 );
             /* NIS_CREATE_STATIC_CAM */ sub_43223( ref l_U2049, -287.40310000, -13.92598000, -4.90621000, 37.43932000, 0.03090900, 3.19475400, 23.47000000, 1000 );
             /* NIS_PLAY_STATIC_CAMERA */ sub_43941( ref l_U2049 );
            ACTIVATE_BULLET_TIME( 0, 1065353216, 1 );
            l_U2856 = 2;
             /* CREATETIMER */ sub_10316( ref l_U2098, 300, 1, 0 );
             /* STARTTIMER */ sub_34724( ref l_U2098 );
        }
        break;
        case 2:
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2098 ))
        {
            DEACTIVATE_BULLET_TIME( 0, 0 );
        }
        if ((NOT IS_ANIMATED_CAMERA_PLAYING()) || ((CAMERA_ANIMATED_CURRENT_TIME() + 1) >= (CAMERA_ANIMATED_LENGTH( l_U2883, l_U2884 ))))
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "first cam done", 0 );
            if (( /* F_GET_NUM_LIVING_PEDS_IN_ARRAY */ sub_58291( ref l_U2206 )) > 0)
            {
                if ( /* IS_MAX_VALID */ sub_35429())
                {
                     /* WRITESCRIPTLOG */ sub_803( "bsw", "...registering Max with S_NYBAR_MID_03B_FAIL", 0 );
                    ISEQ_UNREGISTER_ENTITY( 1681130475, "max" );
                     /* TERMINATEISEQ */ sub_28029( 1681130475, 0 );
                     /* TELEPORTPED */ sub_30319(  /* PLAYER_PED_ID */ sub_11378(), g_U3108, g_U3111 );
                    ISEQ_REGISTER_ENTITY( -283082350, "max",  /* PLAYER_PED_ID */ sub_11378(), 0 );
                }
                if ( /* IS_PED_VALID */ sub_22677( l_U1608 ))
                {
                    ISEQ_REGISTER_ENTITY( -283082350, "thug", l_U1608, 0 );
                    REMOVE_ALL_PED_WEAPONS( l_U1608 );
                     /* F_GIVEPEDWEAPON */ sub_13920( l_U1608, -862236369, 25000, 0, 0 );
                     /* TELEPORTPED */ sub_30319( l_U1608, -287.72900000, -5.97800000, 1.49545100, 180.00000000 );
                }
                ISEQ_START( -283082350 );
                CAMERA_PLAY_ANIMATED( l_U2883, l_U2885, 0, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0, 0 );
            }
            l_U2856 = 3;
        }
        break;
        case 3:
         /* WRITESCRIPTLOG */ sub_803( "bsw", "HANDLE_ROOFTOP_MPM_DIVE_NIS finished, returning TRUE", 0 );
        Result = 1;
        break;
    }
    return Result;
}

/* F_GET_FIRST_LIVING_PED_FROM_ARRAY */ void sub_73612(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if (NOT (IS_PED_DEAD( (uParam0^)[I] )))
        {
            return (uParam0^)[I];
        }
    }
    return nil;
}

/* UPDATE_MAX_LEAP_POSITION */ void sub_74498()
{
    unknown uVar2;
    unknown uVar3;
    unknown uVar4;

    if ( /* IS_MAX_VALID */ sub_35429())
    {
        uVar2 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS(  /* PLAYER_PED_ID */ sub_11378() )};
        uVar2._fU0 = -289.10710000;
        uVar2._fU4 += 0.03500000;
        uVar2._fU8 = 5.59287900;
        SET_PED_COORDS(  /* PLAYER_PED_ID */ sub_11378(), uVar2, 1 );
        SET_PED_HEADING(  /* PLAYER_PED_ID */ sub_11378(), 0.00000000 );
    }
    return;
}

/* NIS_IS_SHOT_FINISHED */ int sub_74639(int iParam0, boolean bParam1)
{
    if (bParam1 == 1)
    {
        if (NOT iParam0->_fU44)
        {
            if ((ref iParam0->_fU48->_fU16) || ( /* ISTIMERDONE */ sub_44221( iParam0 + 48 )))
            {
                iParam0->_fU44 = 1;
                iParam0->_fU36 = 1;
                return 1;
            }
        }
    }
    if (NOT bParam1)
    {
        if ((ref iParam0->_fU48->_fU16) || ( /* ISTIMERDONE */ sub_44221( iParam0 + 48 )))
        {
            iParam0->_fU36 = 1;
            return 1;
        }
    }
    return 0;
}

/* INITIALIZE_VARS_FOR_MID_03C */ void sub_75805()
{
    l_U2744 = 0;
    return;
}

/* PLAY_MIDSCENE_03C */ void sub_75953(boolean bParam0, boolean bParam1)
{
    int Result;

    Result = 0;
    switch (l_U2744)
    {
        case 0:
         /* WRITESCRIPTLOG */ sub_803( "RJM", "PLAY_MIDSCENE_03c start", 0 );
         /* NIS_PRE_SETUP */ sub_42160( 1, 0, 0, 1 );
        if (NOT bParam0)
        {
             /* BLOCKLOAD_MID_03C_ASSETS */ sub_76085();
             /* LOADSEAMLESSCUTSCENE */ sub_29445( ref l_U2704, 1 );
        }
        else
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "PLAY_MIDSCENE_03c forcing fade in", 0 );
            DO_SCREEN_FADE_IN( 500 );
        }
        if (NOT bParam0)
        {
             /* CREATE_MID_03C_PEDS_AND_OBJECTS */ sub_76618();
        }
         /* REGISTER_PEDS_NYC2_MID_03C */ sub_76871( bParam0 );
        if (bParam0)
        {
            CUTSCENE_REGISTER_ISEQ( -1236175571 );
        }
        if (bParam1)
        {
            START_CUTSCENE_CAPTURE( ref l_U2704 );
        }
        START_SEAMLESS_CUTSCENE();
        l_U2744 = 1;
        break;
        case 1:
        SET_GAMEPLAY_CAM_RELATIVE_HEADING( g_U3141[4]._fU16, 1065353216, 0 );
        SET_GAMEPLAY_CAM_RELATIVE_PITCH( g_U3141[4]._fU20, 1065353216, 0 );
        l_U2744 = 2;
        break;
        case 2:
        if (HAS_CUTSCENE_FINISHED())
        {
            CAMERA_PLAY_ANIMATED( "LEVEL_S_NYBAR_CP_05", "BLEND_OUT_MID_03C_NYBAR_CAM", 0, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0, 0 );
            if (bParam1)
            {
                STOP_CUTSCENE_CAPTURE();
            }
             /* CLEANUP_MID_03C_ASSETS */ sub_77772();
            if (NOT bParam0)
            {
                 /* UNLOAD_MID_03C_ASSETS */ sub_77833();
            }
             /* P_SET_TWO_HANDED_WEAPON_VISIBLE */ sub_66070( l_U2712, 1 );
             /* P_SET_TWO_HANDED_WEAPON_VISIBLE */ sub_66070( l_U2712, 1 );
             /* WRITESCRIPTLOG */ sub_803( "RJM", "PLAY_MIDSCENE_03c end", 0 );
             /* NIS_POST_SETUP */ sub_72167( 1, 1 );
            Result = 1;
            l_U2744 = 3;
        }
        break;
        case 3: break;
    }
    return Result;
}

/* BLOCKLOAD_MID_03C_ASSETS */ void sub_76085()
{
     /* BLOCKLOADMODEL */ sub_76127( 2024698471 );
    return;
}

/* BLOCKLOADMODEL */ void sub_76127(unknown uParam0)
{
    DISPLAYF( "[MSWW]### Trying to load model: {!f1} : {1} ###", 2, 1, -874832622, 513, uParam0 );
    if ((IS_MODEL_IN_CDIMAGE( uParam0 )) == 0)
    {
         /* WRITE_STRING */ sub_1104( "[SP]### ERROR! (BlockLoadModel) Trying to block load a model that isn't in the img! ###" );
    }
    REQUEST_MODEL( uParam0 );
    "[doubled result, dropped if not asigned]";
    LOAD_ALL_OBJECTS_NOW();
    while ((HAS_MODEL_LOADED( uParam0 )) == 0)
    {
        LOAD_ALL_OBJECTS_NOW();
        DISPLAYF( "[SP]### Waiting to load model: {!f1} : {1} ###", 2, 1, -874832622, 513, uParam0 );
        WAIT( 0 );
    }
    DISPLAYF( "[MSWW]### Has loaded model: {!f1} : {1} ###", 2, 1, -874832622, 513, uParam0 );
    return;
}

/* CREATE_MID_03C_PEDS_AND_OBJECTS */ void sub_76618()
{
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_mid_03c_PEDS_AND_OBJECTS - start", 0 );
     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_SETUP_NYC_mid_03c", "***" );
     /* P_CREATEPEDSTRUCTWITHNAME */ sub_8380( ref l_U2731, 0, 0, 0, 0.00000000, -1756913695, 26, 6, 0, 0, 0 );
     /* CLEANPED */ sub_21861( l_U2730 );
    l_U2730 =  /* CREATEPED */ sub_21953( ref l_U2731 );
     /* WRITESCRIPTLOG */ sub_803( "RJM", "CREATE_mid_03c_PEDS_AND_OBJECTS - end", 0 );
    return;
}

/* REGISTER_PEDS_NYC2_MID_03C */ void sub_76871(boolean bParam0)
{
    unknown uVar3;

     /* WRITESCRIPTLOG */ sub_803( "SBA", "REGISTER_PEDs_nyc2_mid_03c", "***" );
    if (bParam0)
    {
         /* LOADISEQ */ sub_1517( -1236175571, 1 );
         /* WRITESCRIPTLOG */ sub_803( "SBA", "FROM FLOW: Registering passos with NYC_mid_03c", "***" );
        uVar3 = g_U818;
    }
    else
    {
         /* WRITESCRIPTLOG */ sub_803( "SBA", "FROM CUTSCENE SCRIPT: Registering passos with NYC_mid_03c", "***" );
        uVar3 = l_U2730;
    }
    if ( /* IS_PED_VALID */ sub_22677( uVar3 ))
    {
        REGISTER_PED_PRE_SEAMLESS_CUTSCENE( uVar3, "FB_Pass_NY", 0 );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND( uVar3, 0, 0 ), "W_PI_Clt1911_Aa_H^1", 0 );
        ISEQ_REGISTER_ENTITY( -1236175571, "passos", uVar3, 0 );
        CUTSCENE_REGISTER_PED_TELEPORT( uVar3, g_U781[3]._fU0, g_U781[3]._fU12 );
    }
    if ( /* IS_MAX_VALID */ sub_35429())
    {
         /* WRITESCRIPTLOG */ sub_803( "bsw", "registering Max for mid03c", 0 );
         /* P_PLAYER_HOLSTER_WEAPONS */ sub_64916( ref l_U2712, 1, 1 );
         /* P_SET_LEFT_HAND_WEAPON_VISIBLE */ sub_66209( l_U2712, 0 );
         /* P_SET_TWO_HANDED_WEAPON_VISIBLE */ sub_66070( l_U2712, 0 );
         /* P_EQUIP_PLAYER_WITH_SINGLE_HANDED_WEAPON */ sub_62797( 1 );
        CUTSCENE_REGISTER_ACTION_TREE_PLAY_NODE(  /* PLAYER_PED_ID */ sub_11378(), "/Global/Player/PlayerRoot/PLAYER_INITIALIZE_IDLE" );
        REGISTER_WEAPON_PRE_SEAMLESS_CUTSCENE( GET_WEAPON_FROM_HAND(  /* PLAYER_PED_ID */ sub_11378(), 0, 0 ), "W_PI_Clt1911_Aa_H", 0 );
        ISEQ_REGISTER_ENTITY( -1236175571, "max",  /* PLAYER_PED_ID */ sub_11378(), 0 );
        CUTSCENE_REGISTER_PED_TELEPORT(  /* PLAYER_PED_ID */ sub_11378(), g_U3141[4]._fU0, g_U3141[4]._fU12 );
    }
    REGISTER_HIDE_ENTITY_AT_POSITION( g_U2895._fU0, g_U2895._fU4 );
    return;
}

/* CLEANUP_MID_03C_ASSETS */ void sub_77772()
{
     /* CLEANPED */ sub_21861( l_U2730 );
    return;
}

/* UNLOAD_MID_03C_ASSETS */ void sub_77833()
{
     /* UNLOADMODEL */ sub_34347( 2024698471 );
    return;
}

/* P_CLEANUP_DEAD_MPM_ENEMIES_NEAR_ROOF_DOOR */ void sub_77982()
{
    int I;

    for ( I = 0; I <= (l_U2206 - 1); I++ )
    {
        if (DOES_PED_EXIST( l_U2206[I] ))
        {
            if (IS_PED_DEAD( l_U2206[I] ))
            {
                if (IS_PED_IN_GAMEPLAY_HELPER_BOX( l_U2206[I], "TRIG_CLEANUP_BY_ROOF_DOOR" ))
                {
                     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_CLEANUP_DEAD_MPM_ENEMIES_NEAR_ROOF_DOOR: cleaning up dead guy by door", 0 );
                     /* CLEANPED */ sub_21861( l_U2206[I] );
                }
            }
        }
    }
    return;
}

/* UNLOAD_POST_MPM_ASSETS */ void sub_78340()
{
     /* UNLOADMODEL */ sub_34347( g_U3091 );
     /* UNLOADMODEL */ sub_34347( -1809963165 );
     /* UNLOADANIMDICT */ sub_34599( "PAS_INT" );
     /* UNLOADANIMDICT */ sub_34599( "FACE_PASNYB" );
     /* UNLOADACTIONTREE */ sub_48314( "LEVEL/S_NYBAR/S_NYBAR_PASSOS_FACIAL.act" );
    return;
}

/* HANDLE_ROOFTOP_MPM_FAIL_NIS */ void sub_78502()
{
    int Result;

    Result = 0;
    switch (l_U2855)
    {
        case 0:
         /* WRITESCRIPTLOG */ sub_803( "bsw", "HANDLE_ROOFTOP_MPM_FAIL_NIS start", 0 );
         /* P_IMAGEFX_START_BULLETCAM */ sub_43485( "NY_MPM_SCRIPTED_FAIL_FX", 0 );
        l_U2855 = 1;
        break;
        case 1:
        if ((CAMERA_ANIMATED_CURRENT_TIME() + 500) >= (CAMERA_ANIMATED_LENGTH( l_U2883, l_U2885 )))
        {
             /* WRITESCRIPTLOG */ sub_803( "bsw", "HANDLE_ROOFTOP_MPM_FAIL_NIS fading out", 0 );
            l_U2126 = 1;
            l_U2855 = 3;
            DO_SCREEN_FADE_OUT( 500 );
        }
        if (( /* IS_PED_VALID */ sub_22677( l_U1608 )) AND ( /* IS_MAX_VALID */ sub_35429()))
        {
            if (PED_ANIM_EVENT( l_U1608, -1531652494 ))
            {
                 /* WRITESCRIPTLOG */ sub_803( "BSW", "executor ped has shot, cause blood from Max head", 0 );
                START_PARTICLE_FX_NON_LOOPED_ON_PED_BONE( "CS_Blood_ImpactSplash_S",  /* PLAYER_PED_ID */ sub_11378(), 0.25000000, 0, 0, 0, 180, 0, 65488, 1 );
                START_PARTICLE_FX_NON_LOOPED_ON_PED_BONE( "CS_Blood_Exit_S",  /* PLAYER_PED_ID */ sub_11378(), 0.25000000, 0, 0, 0, 180, 0, 65488, 1 );
            }
        }
        break;
        case 3:
        Result = 1;
        break;
    }
    return Result;
}

/* NIS_RETURN_TO_GAMEPLAY_CAM */ void sub_79078(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, float fParam4, unknown uParam5)
{
    SET_CAM_SIDE_LEFT( uParam2 );
    if (fParam4 != -1E8)
    {
        SET_GAMEPLAY_CAM_RELATIVE_HEADING( uParam3, 1065353216, 0 );
    }
    if (fParam4 != -1E8)
    {
        SET_GAMEPLAY_CAM_RELATIVE_PITCH( fParam4, 1065353216, 0 );
    }
    RENDER_SCRIPT_CAMS( 0, uParam1, uParam0, uParam5 );
    return;
}

/* HANDLE_MID_03C_BLENDOUT */ void sub_79486()
{
    int Result;

    Result = 0;
    switch (l_U2857)
    {
        case 0:
         /* WRITESCRIPTLOG */ sub_803( "SP", "eMID03cBlendoutState = MPM_NIS_START", 0 );
         /* LOADISEQ */ sub_1517( 1103749565, 0 );
         /* LOADISEQ */ sub_1517( -1202559929, 0 );
         /* NIS_PRE_SETUP */ sub_42160( 1, 0, 0, 1 );
         /* LOADISEQ */ sub_1517( -1236175571, 1 );
        if (NOT (ISEQ_QUERY_STATE( -1236175571, 3 )))
        {
            CAMERA_PLAY_ANIMATED( "LEVEL_S_NYBAR_CP_05", "BLEND_OUT_MID_03C_NYBAR_CAM", 0, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0, 0 );
             /* P_TELEPORT_PLAYER */ sub_79795( g_U3141[4]._fU0, g_U3141[4]._fU12, g_U3141[4]._fU16, g_U3141[4]._fU20 );
             /* WRITESCRIPTLOG */ sub_803( "bsw", "starting S_NYBAR_MID03C_BLENDOUT", 0 );
            if ( /* IS_MAX_VALID */ sub_35429())
            {
                ISEQ_REGISTER_ENTITY( -1236175571, "max",  /* PLAYER_PED_ID */ sub_11378(), 0 );
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "S_NYBAR_MID03C_BLENDOUT registering Max", 0 );
            }
            if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
            {
                ISEQ_REGISTER_ENTITY( -1236175571, "passos", g_U818, 0 );
                 /* WRITESCRIPTLOG */ sub_803( "bsw", "S_NYBAR_MID03C_BLENDOUT registering piPassos", 0 );
            }
            ISEQ_START( -1236175571 );
        }
        SET_GAMEPLAY_CAM_RELATIVE_HEADING( g_U3141[4]._fU16, 1065353216, 0 );
        SET_GAMEPLAY_CAM_RELATIVE_PITCH( g_U3141[4]._fU20, 1065353216, 0 );
        if ((IS_DEATH_PANEL_WIPE_ALLOWED()) || ((IS_SCREEN_FADING_OUT()) || (IS_SCREEN_FADED_OUT())))
        {
            DO_SCREEN_FADE_IN( 500 );
        }
        l_U2857 = 1;
        break;
        case 1:
        if ((CAMERA_ANIMATED_CURRENT_TIME() + 1000) >= (CAMERA_ANIMATED_LENGTH( "LEVEL_S_NYBAR_CP_05", "BLEND_OUT_MID_03C_NYBAR_CAM" )))
        {
             /* WRITESCRIPTLOG */ sub_803( "SP", "eMID03cBlendoutState = MPM_NIS_PLAYING", 0 );
            CAMERA_FREEZE_FRAME( 1, 1500, 0, 0 );
            CAMERA_ANIMATED_STOP( 0, 0 );
            l_U2857 = 3;
        }
        break;
        case 3:
         /* NIS_POST_SETUP */ sub_72167( 1, 1 );
         /* WRITESCRIPTLOG */ sub_803( "SP", "eMID03cBlendoutState = MPM_NIS_FINISHED", 0 );
        Result = 1;
        break;
    }
    return Result;
}

/* P_TELEPORT_PLAYER */ void sub_79795(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5)
{
    unknown uVar8;

    uVar8 =  /* PLAYER_PED_ID */ sub_11378();
     /* TELEPORTPED */ sub_30319( uVar8, uParam0, uParam3 );
    SET_GAMEPLAY_CAM_RELATIVE_HEADING( uParam4, 1065353216, 0 );
    SET_GAMEPLAY_CAM_RELATIVE_PITCH( uParam5, 1065353216, 0 );
    return;
}

/* P_CREATE_S_NY2_GG_LM_02 */ void sub_80532()
{
     /* WRITESCRIPTLOG */ sub_803( "CO", "P_CREATE_S_NY2_GG_LM_02", 0 );
     /* P_CREATECOLLECTIBLESTRUCT */ sub_27016( ref g_U737, g_U777, -1758307275, -451971732, -315.35000000, 0.26000000, 2.89000000, 0.00000000, 0.00000000, 1.00000000, "" );
     /* P_CREATECOLLECTIBLE */ sub_27173( ref g_U737 );
    return;
}

/* P_HANDLE_MONO_MAX_ROOFTOPS2 */ void sub_80928()
{
    if (NOT l_U1054._fU64)
    {
        if (NOT ( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404()))
        {
            if ( /* ISTIMERDONE */ sub_44221( ref l_U2552 ))
            {
                 /* P_SPEECH_PLAY_MAX_MONOLOGUE */ sub_60342( "SNYC_ROTR", ref l_U2463 );
            }
        }
    }
    return;
}

/* HANDLE_PASSOS_WAITING_SPEECH */ void sub_81084(int iParam0, unknown uParam1)
{
    switch (l_U117)
    {
        case 0: break;
        case 1:
         /* CREATETIMER */ sub_10316( ref l_U149, iParam0 + (GET_RANDOM_INT_IN_RANGE( -uParam1, uParam1 )), 1, 0 );
         /* STARTTIMER */ sub_34724( ref l_U149 );
        l_U158 = 0;
         /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_PASSOS_WAITING_SPEECH: Going to ePWS_ChooseSpeechState", 0 );
        l_U117 = 2;
        break;
        case 2:
        if (NOT ( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404()))
        {
            if ( /* ISTIMERDONE */ sub_44221( ref l_U149 ))
            {
                l_U118 = l_U158;
                 /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_PASSOS_WAITING_SPEECH: Going to ePWS_PlaySpeechState", 0 );
                 /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_PASSOS_WAITING_SPEECH: iPassosSpeechLevel = ", 0 );
                 /* WRITE_INT */ sub_19082( l_U158 );
                l_U117 = 3;
            }
        }
        break;
        case 3:
        switch (l_U118)
        {
            case 0:
             /* P_PLAY_DIAL_PASSOS */ sub_81564( "SNYC_PSDS", ref l_U129 );
            break;
            case 1:
             /* P_PLAY_DIAL_PASSOS */ sub_81564( "SNYC_CMMF", ref l_U119 );
            break;
            case 2:
             /* P_PLAY_DIAL_PASSOS */ sub_81564( "SNYC_TMFL", ref l_U139 );
            break;
        }
         /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_PASSOS_WAITING_SPEECH: Going to ePWS_ResetState", 0 );
        l_U117 = 4;
        break;
        case 4:
         /* CREATETIMER */ sub_10316( ref l_U149, iParam0 + (GET_RANDOM_INT_IN_RANGE( -uParam1, uParam1 )), 1, 0 );
         /* STARTTIMER */ sub_34724( ref l_U149 );
        l_U158++;
        if (l_U158 > 2)
        {
            l_U158 = 0;
        }
         /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_PASSOS_WAITING_SPEECH: Returning to ePWS_ChooseSpeechState", 0 );
        l_U117 = 2;
        break;
    }
    return;
}

/* P_PLAY_DIAL_PASSOS */ void sub_81564(unknown uParam0, unknown uParam1)
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_PLAY_DIAL_PASSOS", "***" );
    if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
    {
        if (NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
        {
             /* RESET_SCRIPT_SPEECH_STRUCT */ sub_60441( uParam1 );
             /* ADD_PED_FOR_SCRIPT_SPEECH */ sub_60550( 1, g_U818, "PASSOS", uParam1, 2, 0 );
             /* ADD_PED_FOR_SCRIPT_SPEECH */ sub_60550( 0,  /* PLAYER_PED_ID */ sub_11378(), "MAX", uParam1, 2, 0 );
             /* PLAY_SINGLE_SPEECH */ sub_60803( uParam0, uParam1, 8, 1 );
        }
    }
    return;
}

/* KILL_HANDLE_PASSOS_WAITING_SPEECH */ void sub_82060(unknown uParam0)
{
     /* KILL_SPEECH */ sub_82112( ref l_U119, uParam0 );
     /* KILL_SPEECH */ sub_82112( ref l_U129, uParam0 );
     /* KILL_SPEECH */ sub_82112( ref l_U139, uParam0 );
     /* WRITESCRIPTLOG */ sub_803( "SBA", "INIT_HANDLE_PASSOS_WAITING_SPEECH: Setting ePWS_State = ePWS_IdleState", 0 );
    l_U117 = 0;
    return;
}

/* KILL_SPEECH */ void sub_82112(int iParam0, unknown uParam1)
{
    if (NOT ( /* IS_SCRIPT_SPEECH_STRUCT_VALID */ sub_82140( (iParam0^) )))
    {
        ;
    }
    else
    {
        PRINTSTRING( "\n KILL SPEECH CALLED***************************************" );
        if (IS_SCRIPTED_CONVERSATION_ONGOING( iParam0->_fU4 ))
        {
            if (iParam0->_fU8 == g_U6[iParam0->_fU4])
            {
                STOP_SCRIPTED_CONVERSATION( iParam0->_fU4, uParam1, 0 );
            }
        }
    }
    return;
}

/* IS_SCRIPT_SPEECH_STRUCT_VALID */ boolean sub_82140(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9)
{
    int iVar12;

    if (uParam0._fU4 < 0)
    {
        return 0;
    }
    iVar12 = GET_CHECK_HASH_FROM_CONVERSATION_ID( uParam0._fU4 );
    return (uParam0._fU16 == iVar12) AND (iVar12 != 0);
}

/* P_PLAY_DIAL_PASSOS_MAX_ROOF2 */ void sub_82963()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_PLAY_DIAL_PASSOS_MAX_ROOF2", "***" );
    if ( /* IS_PED_VALID */ sub_22677( g_U818 ))
    {
        if (NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() )))
        {
             /* RESET_SCRIPT_SPEECH_STRUCT */ sub_60441( ref l_U2473 );
             /* ADD_PED_FOR_SCRIPT_SPEECH */ sub_60550( 2, g_U818, "PASSOS", ref l_U2473, 2, 0 );
             /* ADD_PED_FOR_SCRIPT_SPEECH */ sub_60550( 1,  /* PLAYER_PED_ID */ sub_11378(), "MAX", ref l_U2473, 2, 0 );
             /* PLAY_SINGLE_SPEECH */ sub_60803( "SNYC_TGCC", ref l_U2473, 8, 1 );
        }
    }
    return;
}

/* TASK_FRONT_GUYS_TO_FIRE_AT_PASSOS */ void sub_83218()
{
    int I;
    unknown uVar3;

     /* WRITESCRIPTLOG */ sub_803( "RJM", "TASK_FRONT_GUYS_TO_FIRE_AT_PASSOS", 0 );
    for ( I = 0; I <= 1; I++ )
    {
        if (( /* IS_PASSOS_VALID */ sub_33084()) AND ( /* IS_PED_VALID */ sub_22677( l_U1858[I] )))
        {
            CLEAR_PED_TASKS_IMMEDIATELY( l_U1858[I] );
            OPEN_SEQUENCE_TASK( ref uVar3 );
            TASK_SHOOT_AT_COORD( 0, -242.84000000, 3.89000000, 3.61000000, 2000, 0, 0, 0 );
            TASK_SHOOT_AT_COORD( 0, -240.12000000, 3.87000000, 3.27000000, 2000, 0, 0, 0 );
            TASK_COMBAT_PED( 0, g_U818 );
            CLOSE_SEQUENCE_TASK( uVar3 );
            TASK_PERFORM_SEQUENCE( l_U1858[I], uVar3 );
            CLEAR_SEQUENCE_TASK( uVar3 );
        }
    }
    return;
}

/* P_HANDLE_PASSOS_ABANDONED_BLDG_INCIDENTAL_SHOOT_VO */ void sub_83779()
{
    if (NOT ( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404()))
    {
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2561 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_PASSOS_ABANDONED_BLDG_INCIDENTAL_SHOOT_VO", "***" );
             /* P_PLAY_DIAL_PASSOS */ sub_81564( "SNYC_PCDS", ref l_U2483 );
             /* CREATETIMER */ sub_10316( ref l_U2561, GET_RANDOM_INT_IN_RANGE( 15000, 18000 ), 1, 0 );
             /* STARTTIMER */ sub_34724( ref l_U2561 );
        }
    }
    return;
}

/* HAS_MAX_SHOT_NEAR_PASSOS */ int sub_84391()
{
    int iVar2;

    if (((IS_PED_DEAD( g_U818 )) == 0) AND ((DOES_PED_EXIST( g_U818 )) == 1))
    {
        if (HAS_BULLET_IMPACTED_IN_AREA( "[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( g_U818 ), 4.00000000, ref iVar2 ))
        {
            if (iVar2 == ( /* PLAYER_PED_ID */ sub_11378()))
            {
                return 1;
            }
        }
    }
    return 0;
}

/* P_HANDLE_EARLY_FIRE_ESCAPE_ABANDONEMENT */ void sub_85219()
{
    if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1390, 0 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "Player has run out to the fire escape warning", 0 );
         /* P_PLAY_DIAL_PASSOS */ sub_81564( "SNYC_WTFG", ref l_U2503 );
    }
    else if ( /* F_ISPLAYERINTRIGGERBOXFIRSTTIME */ sub_53351( ref l_U1411, 0 ))
    {
         /* WRITESCRIPTLOG */ sub_803( "RJM", "HANDLE_EVENTS - Moving to ROOFTOP_MID_05B_PASSOS_DEATH", 0 );
        l_U2853 = 5;
    }
    return;
}

/* P_HANDLE_PASSOS_INTERRUPTIONS */ void sub_85500(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5)
{
     /* MAL_HANDLEPASSOSINTERRUPTIONSWITHDIALOGUE */ sub_85626( uParam0, uParam1, uParam2, uParam3, uParam4, uParam5, 85554, 1077936128, 1069547520, 1065353216 );
    return;
}

/* MAL_DUMMYPASSOSINTERRUPTDIALOGUECALL */ void sub_85554(unknown uParam0)
{
    return;
}

/* MAL_HANDLEPASSOSINTERRUPTIONSWITHDIALOGUE */ void sub_85626(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, int iParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9)
{
    unknown uVar12;

    if (( /* MAL_GETACTINTSTATUS */ sub_85683( uParam0, 29 )) == 3)
    {
        uVar12 = nil;
        if ((( /* MAL_HASPLAYERFIRED */ sub_85870( 1 )) AND (IS_PED_IN_CROSSHAIR_CYLINDER( uParam0, 2, 10000, 0, -1082130432 ))) || (HAS_BULLET_IMPACTED_IN_AREA(  /* MAL_GETPEDCOORDS */ sub_85767( uParam0 ), 3, ref uVar12 )))
        {
             /* MAL_WRITESCRIPTLOG */ sub_85984( "PLAYER SHOT AT PASSOS" );
             /* MAL_SETACTINWITHFOCUSPOS */ sub_86159( ref uParam0,  /* MAL_GETPEDCOORDS */ sub_85767(  /* PLAYER_PED_ID */ sub_11378() ), 34, 1000 );
            SET_PED_PRIMARY_LOOKAT( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
            (uParam1^) = 1;
            break;
            uParam6;
            0;
            break;
        }
        if (NOT (uParam2^))
        {
            if ((( /* MAL_GETACTINTSTATUS */ sub_85683( uParam0, 32 )) != 3) AND ((( /* MAL_GETACTINTSTATUS */ sub_85683( uParam0, 33 )) != 3) AND (IS_PED_TOUCHING_PED(  /* PLAYER_PED_ID */ sub_11378(), uParam0 ))))
            {
                 /* MAL_WRITESCRIPTLOG */ sub_85984( "BAD TOUCH!!" );
                (uParam2^) = 1;
                (uParam1^) = 1;
                 /* MAL_SETACTINWITHFOCUSPOS */ sub_86159( ref uParam0,  /* MAL_GETPEDCOORDS */ sub_85767(  /* PLAYER_PED_ID */ sub_11378() ), 35, 1000 );
                SET_PED_PRIMARY_LOOKAT( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
                break;
                uParam6;
                1;
                break;
            }
        }
        else if (NOT (IS_PED_TOUCHING_PED(  /* PLAYER_PED_ID */ sub_11378(), uParam0 )))
        {
            (uParam2^) = 0;
        }
        if (NOT (uParam3^))
        {
            if ( /* MAL_CHECKANGLEANDDISTANCEBETWEENPEDANDPLAYER */ sub_86432( ref uParam0, 300, 100, -1, 0, 0 ))
            {
                if ((IS_CONTROL_PRESSED( 0, 6 )) AND (IS_PED_IN_CROSSHAIR_CYLINDER( uParam0, 1, 10000, 0, -1082130432 )))
                {
                    (uParam1^) = 1;
                    (uParam3^) = 1;
                     /* MAL_SETACTINWITHFOCUSPOS */ sub_86159( ref uParam0,  /* MAL_GETPEDCOORDS */ sub_85767(  /* PLAYER_PED_ID */ sub_11378() ), 32, 1000 );
                    SET_PED_PRIMARY_LOOKAT( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
                     /* MAL_WRITESCRIPTLOG */ sub_85984( "PLAYER AIMING AT PASSOS" );
                    break;
                    uParam6;
                    2;
                    break;
                }
            }
        }
        else if ((NOT (IS_CONTROL_PRESSED( 0, 6 ))) || (NOT (IS_PED_IN_CROSSHAIR_CYLINDER( uParam0, 1.50000000, 10000, 0, -1082130432 ))))
        {
            if (( /* MAL_GETACTINTSTATUS */ sub_85683( uParam0, 32 )) != 3)
            {
                (uParam3^) = 0;
                 /* MAL_WRITESCRIPTLOG */ sub_85984( "PLAYER NO LONGER AIMING AT PASSOS" );
            }
        }
        if (NOT (uParam1^))
        {
            if (( /* MAL_CHECKANGLEANDDISTANCEBETWEENPEDANDPLAYER */ sub_86432( ref uParam0, uParam9, 180, -1, 46, 0 )) || (( /* MAL_CHECKANGLEANDDISTANCEBETWEENPEDANDPLAYER */ sub_86432( ref uParam0, uParam8, 45, -1, 31, 0 )) || ( /* MAL_CHECKANGLEANDDISTANCEBETWEENPEDANDPLAYER */ sub_86432( ref uParam0, uParam7, 30, -1, 0, 0 ))))
            {
                 /* MAL_WRITESCRIPTLOG */ sub_85984( "INTERRUPTING PASSOS" );
                 /* MAL_SETACTINWITHFOCUSPOS */ sub_86159( ref uParam0,  /* MAL_GETPEDCOORDS */ sub_85767(  /* PLAYER_PED_ID */ sub_11378() ), 33, 1000 );
                SET_PED_PRIMARY_LOOKAT( uParam0,  /* PLAYER_PED_ID */ sub_11378() );
                (uParam1^) = 1;
            }
        }
        else if (( /* MAL_CHECKANGLEANDDISTANCEBETWEENPEDANDPLAYER */ sub_86432( ref uParam0, -1, 180, uParam8 + 1, 91, 0 )) || ( /* MAL_CHECKANGLEANDDISTANCEBETWEENPEDANDPLAYER */ sub_86432( ref uParam0, -1, 90, uParam7 + 1, 0, 0 )))
        {
            if ((NOT (uParam2^)) AND (NOT (uParam3^)))
            {
                if (( /* MAL_ISACTINTCOMPLETED */ sub_87479( ref uParam0, 35, 1 )) || (( /* MAL_ISACTINTCOMPLETED */ sub_87479( ref uParam0, 32, 1 )) || (( /* MAL_ISACTINTCOMPLETED */ sub_87479( ref uParam0, 34, 1 )) || ( /* MAL_ISACTINTCOMPLETED */ sub_87479( ref uParam0, 33, 1 )))))
                {
                     /* MAL_FINISHACTINT */ sub_87541( ref uParam0, 33 );
                     /* MAL_FINISHACTINT */ sub_87541( ref uParam0, 34 );
                     /* MAL_FINISHACTINT */ sub_87541( ref uParam0, 32 );
                     /* MAL_FINISHACTINT */ sub_87541( ref uParam0, 35 );
                     /* MAL_FINISHACTINT */ sub_87541( ref uParam0, 31 );
                     /* MAL_SETACTINT */ sub_87708( uParam0, 36, 1000 );
                    CLEAR_PED_PRIMARY_LOOKAT( uParam0 );
                    (uParam1^) = 0;
                    (uParam3^) = 0;
                    (uParam2^) = 0;
                    (uParam4^) = 0;
                     /* CREATETIMER */ sub_10316( iParam5,  /* F_GETRANDOMINTINRANGE */ sub_87809( 10000, 15000 ), 1, 0 );
                    return;
                }
            }
        }
        if (( /* MAL_GETACTINTSTATUS */ sub_85683( uParam0, 30 )) == 3)
        {
            if ( /* ISTIMERDONE */ sub_44221( iParam5 ))
            {
                 /* MAL_SETACTINWITHFOCUSPOS */ sub_86159( ref uParam0,  /* MAL_GETPEDCOORDS */ sub_85767(  /* PLAYER_PED_ID */ sub_11378() ), 31, 1000 );
                (uParam4^)++;
                break;
                uParam6;
                3;
                break;
            }
            else if ((uParam4^) < 3)
            {
                if ((iParam5->_fU16) || (NOT ( /* HASTIMERBEENACTIVATED */ sub_46575( iParam5 ))))
                {
                     /* CREATETIMER */ sub_10316( iParam5,  /* F_GETRANDOMINTINRANGE */ sub_87809( 10000, 15000 ), 1, 0 );
                     /* STARTTIMER */ sub_34724( iParam5 );
                }
            }
        }
    }
     /* MAL_ISACTINTCOMPLETED */ sub_87479( ref uParam0, 31, 1 );
     /* MAL_ISACTINTCOMPLETED */ sub_87479( ref uParam0, 36, 1 );
    return;
}

/* MAL_GETACTINTSTATUS */ int sub_85683(unknown uParam0, unknown uParam1)
{
    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        return PED_GET_ACTION_INTENTION_STATUS( uParam0, uParam1 );
    }
    return 0;
}

/* MAL_GETPEDCOORDS */ vector sub_85767(unknown uParam0)
{
    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        return "[dynamic result, ret vals = 3]";
        break;
        GET_PED_COORDS( uParam0 );
        "[doubled result, dropped if not asigned]";
        "[doubled result, dropped if not asigned]";
        break;
    }
    return vector( 0, 0, 0);
}

/* MAL_HASPLAYERFIRED */ int sub_85870(unknown uParam0)
{
    int iVar3;

    iVar3 = nil;
    if (HAS_SHOT_BEEN_FIRED_IN_AREA(  /* MAL_GETPEDCOORDS */ sub_85767(  /* PLAYER_PED_ID */ sub_11378() ), 2.00000000, uParam0, ref iVar3 ))
    {
        if (iVar3 == ( /* PLAYER_PED_ID */ sub_11378()))
        {
             /* MAL_WRITESCRIPTLOG */ sub_85984( "MAL_HasPlayerFired RETURNING TRUE" );
            return 1;
        }
    }
    return 0;
}

/* MAL_WRITESCRIPTLOG */ void sub_85984(unknown uParam0)
{
    unknown uVar3;

    uVar3 = GET_REAL_GAME_TIMER();
    DISPLAYF( "[{0}][{1}]{3} {2} {3}", 4, 513, uVar3, 1537, "MSWW", 1537, uParam0, 1537, "###" );
    return;
}

/* MAL_SETACTINWITHFOCUSPOS */ void sub_86159(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5)
{
    if (NOT (IS_PED_DEAD( (uParam0^) )))
    {
        PED_SET_ACTION_INTENTION( (uParam0^), uParam4, uParam5, uParam1 );
    }
    return;
}

/* MAL_CHECKANGLEANDDISTANCEBETWEENPEDANDPLAYER */ int sub_86432(unknown uParam0, float fParam1, unknown uParam2, float fParam3, float fParam4, boolean bParam5)
{
    float fVar8;

    if ((NOT (IS_PED_DEAD(  /* PLAYER_PED_ID */ sub_11378() ))) AND (NOT (IS_PED_DEAD( (uParam0^) ))))
    {
        fVar8 =  /* GET_DISTANCE_BETWEEN_PEDS */ sub_86528( (uParam0^),  /* PLAYER_PED_ID */ sub_11378(), 0 );
        if ((fVar8 > fParam1) AND (fParam1 > -1))
        {
            return 0;
        }
        else if ((fVar8 < fParam3) AND (fParam3 > -1))
        {
            return 0;
        }
        else if (NOT (IS_PED_FACING_PED( (uParam0^),  /* PLAYER_PED_ID */ sub_11378(), uParam2 )))
        {
            return 0;
        }
        else if ((IS_PED_FACING_PED( (uParam0^),  /* PLAYER_PED_ID */ sub_11378(), fParam4 )) AND (fParam4 > 0))
        {
            return 0;
        }
        else if (bParam5)
        {
            PRINTSTRING( "MAL_CheckAngleAndDistanceBetweenPedAndPlayer: Actual Distance: " );
            PRINTFLOAT( fVar8 );
            PRINTSTRING( " MAX DISTANCE: " );
            PRINTFLOAT( fParam1 );
            PRINTSTRING( " MIN DISTANCE: " );
            PRINTFLOAT( fParam3 );
            PRINTSTRING( " MAX ANGLE: " );
            PRINTFLOAT( uParam2 );
            PRINTSTRING( " MIN ANGLE: " );
             /* WRITE_FLOAT */ sub_18913( fParam4 );
        }
        return 1;;;;;
    }
    return 0;
}

/* GET_DISTANCE_BETWEEN_PEDS */ void sub_86528(unknown uParam0, unknown uParam1, boolean bParam2)
{
    unknown uVar5;
    unknown uVar6;
    unknown uVar7;
    unknown uVar8;
    unknown uVar9;
    unknown uVar10;

    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        uVar5 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( uParam0 )};
    }
    if (NOT (IS_PED_DEAD( uParam1 )))
    {
        uVar8 = {"[doubled result, dropped if not asigned]", "[doubled result, dropped if not asigned]", GET_PED_COORDS( uParam1 )};
    }
    if (bParam2)
    {
        return VDIST( uVar5, uVar8 );
        break;
    }
    return VDIST( uVar5._fU0, uVar5._fU4, 0, uVar8._fU0, uVar8._fU4, 0 );
}

/* MAL_ISACTINTCOMPLETED */ int sub_87479(unknown uParam0, unknown uParam1, boolean bParam2)
{
    if (( /* MAL_GETACTINTSTATUS */ sub_85683( (uParam0^), uParam1 )) == 1)
    {
        if (bParam2)
        {
             /* MAL_FINISHACTINT */ sub_87541( uParam0, uParam1 );
        }
        return 1;
    }
    return 0;
}

/* MAL_FINISHACTINT */ void sub_87541(unknown uParam0, unknown uParam1)
{
    if (NOT (IS_PED_DEAD( (uParam0^) )))
    {
        PED_FINISH_ACTION_INTENTION( (uParam0^), uParam1 );
    }
    return;
}

/* MAL_SETACTINT */ void sub_87708(unknown uParam0, unknown uParam1, unknown uParam2)
{
    if (NOT (IS_PED_DEAD( uParam0 )))
    {
        PED_SET_ACTION_INTENTION( uParam0, uParam1, uParam2, l_U283 );
    }
    return;
}

/* F_GETRANDOMINTINRANGE */ void sub_87809(unknown uParam0, int iParam1)
{
    int Result;

    Result = GET_RANDOM_INT_IN_RANGE( uParam0, iParam1 + 1 );
    if (Result > iParam1)
    {
        Result = iParam1;
    }
    return Result;
}

/* SETUP_ABANDONED_FLOOR2 */ int sub_88814()
{
    switch (l_U2003)
    {
        case 1:
        l_U2004 = 0;
         /* P_SETUP_AI_GROUP */ sub_21429( ref l_U1997, 0.50000000, 0 );
         /* CREATE_ABANDONED_BUILDING2_PLACEMENTS */ sub_88914();
        l_U2003 = 2;
         /* WRITESCRIPTLOG */ sub_803( "GA", "e_AbandonFloor2Spawn = ENTITY_STATE_CREATING", 0 );
        break;
        case 2:
        l_U1992[l_U2004] =  /* CREATEPED */ sub_21953( ref l_U1939[l_U2004] );
         /* P_QUICK_ADD_PED_TO_GROUP */ sub_22806( l_U1992[l_U2004], ref l_U1997 );
        if (NOT (IS_PED_DEAD( l_U1992[l_U2004] )))
        {
             /* PED_SET_ROOM_BY_NAME */ sub_32730( ref l_U1992[l_U2004], g_U3561 );
             /* PED_SET_TETHERBOX */ sub_24170( ref l_U1992[l_U2004], l_U1562, 1 );
             /* PED_SET_ALERTNESS */ sub_68853( ref l_U1992[l_U2004], 3 );
            SET_PED_AI_TEMPLATE( l_U1992[l_U2004], "AIT_NORMAL" );
            if (l_U2004 == 0)
            {
                 /* F_GIVEPEDWEAPON */ sub_13920( l_U1992[l_U2004], -862236369, 25000, 0, 0 );
            }
            else if (l_U2004 == 1)
            {
                 /* F_GIVEPEDWEAPON */ sub_13920( l_U1992[l_U2004], -691403429, 25000, 0, 0 );
            }
            else if (l_U2004 == 2)
            {
                 /* F_GIVEPEDWEAPON */ sub_13920( l_U1992[l_U2004], -1074756423, 25000, 0, 0 );
            }
            else if (l_U2004 == 3)
            {
                 /* F_GIVEPEDWEAPON */ sub_13920( l_U1992[l_U2004], 434544317, 25000, 0, 0 );
            };;;;
        }
        l_U2004++;
        if (l_U2004 >= 4)
        {
            l_U2003 = 3;
             /* WRITESCRIPTLOG */ sub_803( "GA", "e_AbandonFloor2Spawn = ENTITY_STATE_POST_CREATE_SETUP", 0 );
        }
        break;
        case 3:
         /* GIVE_DEBUG_NAMES_TO_PEDS_IN_ARRAY */ sub_23888( ref l_U1992, "ABDN_FLOOR2" );
         /* P_DEACTIVATEPEDARRAY */ sub_24818( ref l_U1992 );
         /* WRITESCRIPTLOG */ sub_803( "GA", "e_AbandonFloor2Spawn = ENTITY_STATE_COMPLETE", 0 );
        l_U2003 = 4;
        break;
        case 4:
        return 1;
        break;
    }
    return 0;
}

/* CREATE_ABANDONED_BUILDING2_PLACEMENTS */ void sub_88914()
{
     /* CLEANPLACEMENTARRAY */ sub_48733( ref l_U2588 );
    l_U2588[0] =  /* CREATEPLACEMENT */ sub_27581( -4072149, -241.21000000, -10.15000000, 5.83000000, 0, 0, 0.00000000, 0, 0, 0, 1119092736 );
    ADD_PLACEMENT_TO_INTERIOR_ROOM_BY_NAME( l_U2588[0], ref g_U3561 );
    l_U2588[1] =  /* CREATEPLACEMENT */ sub_27581( -4072149, -241.00000000, -10.05000000, 5.86400000, 1.57500000, 0, 0.00000000, 0, 0, 0, 1119092736 );
    ADD_PLACEMENT_TO_INTERIOR_ROOM_BY_NAME( l_U2588[1], ref g_U3561 );
    return;
}

/* TASK_ABANDONED_FLOOR2 */ void sub_89789()
{
     /* P_ACTIVATEPEDARRAY */ sub_33613( ref l_U1992 );
     /* PED_ARRAY_SET_ALERTNESS */ sub_68793( ref l_U1992, 3 );
     /* PED_ARRAY_TASK_COMBAT_PLAYER */ sub_89846( ref l_U1992 );
     /* PED_TASK_ATTACK_MOVE */ sub_55353( l_U1992[1], -239.10000000, -14.50000000, 5.14000000, 1092616192, 1101004800, -1082130432, 3 );
    return;
}

/* PED_ARRAY_TASK_COMBAT_PLAYER */ void sub_89846(unknown uParam0)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
         /* PED_TASK_COMBAT_PLAYER */ sub_54660( (uParam0^)[I], 1 );
    }
    return;
}

/* P_CREATE_S_NY2_GG_M5_03 */ void sub_89989()
{
     /* WRITESCRIPTLOG */ sub_803( "CO", "P_CREATE_S_NY2_GG_M5_03", 0 );
     /* P_CREATECOLLECTIBLESTRUCT */ sub_27016( ref g_U701, g_U775, 1292101257, 67259641, -239.90000000, -28.51000000, 5.15000000, 1.50000000, 0.00000000, 2.00000000, "" );
     /* P_CREATECOLLECTIBLE */ sub_27173( ref g_U701 );
    return;
}

/* P_INIT_PASSOS_WARNING_DEATH */ void sub_90257()
{
     /* WRITESCRIPTLOG */ sub_803( "SBA", "P_INIT_PASSOS_WARNING_DEATH", "***" );
    l_U97 = 1;
    return;
}

/* P_HANDLE_PASSOS_ABANDONED_BLDG2_INCIDENTAL_SHOOT_VO */ void sub_90810()
{
    if (NOT ( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404()))
    {
        if ( /* ISTIMERDONE */ sub_44221( ref l_U2561 ))
        {
             /* WRITESCRIPTLOG */ sub_803( "SBA", "P_HANDLE_PASSOS_ABANDONED_BLDG2_INCIDENTAL_SHOOT_VO", "***" );
             /* P_PLAY_DIAL_PASSOS */ sub_81564( "SNYC_PDB2", ref l_U2483 );
             /* CREATETIMER */ sub_10316( ref l_U2561, GET_RANDOM_INT_IN_RANGE( 13000, 16000 ), 1, 0 );
             /* STARTTIMER */ sub_34724( ref l_U2561 );
        }
    }
    return;
}

/* TAKE_PAINKILLER_ARRAY_SNAPSHOT */ void sub_91658(unknown uParam0, unknown uParam1)
{
    int I;

    for ( I = 0; I <= ((uParam0^) - 1); I++ )
    {
        if (DOES_PLACEMENT_EXIST( (uParam0^)[I] ))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "DO_ANY_PAINKILLERS_STILL_EXIST - Found a pill in there, we can still play some V.O.", 0 );
            (uParam1^)[I] = 1;
        }
        else
        {
            (uParam1^)[I] = 0;
        }
    }
    return;
}

/* P_HANDLE_MAX_ABAND_BLDNG_PILLS_VO */ void sub_92134()
{
    if (NOT l_U2594)
    {
        if ( /* UPDATE_PILL_VO */ sub_92211( "SNYC_FSPL", ref l_U2588, ref l_U2591 ))
        {
            l_U2594 = 1;
        }
    }
    return;
}

/* UPDATE_PILL_VO */ int sub_92211(unknown uParam0, unknown uParam1, unknown uParam2)
{
    int I;

    if ((IS_PLAYER_DEAD(  /* PLAYER_ID */ sub_11416() )) == 0)
    {
        if (( /* IS_ANY_SPEECH_CURRENTLY_PLAYING */ sub_62404()) == 0)
        {
            for ( I = 0; I <= ((uParam1^) - 1); I++ )
            {
                if ((uParam2^)[I])
                {
                    if ((HAS_PLACEMENT_BEEN_COLLECTED( (uParam1^)[I] )) || (NOT (DOES_PLACEMENT_EXIST( (uParam1^)[I] ))))
                    {
                        (uParam2^)[I] = 0;
                        if (TIME_SINCE_LAST_MONOLOGUE() > 5000)
                        {
                             /* RESET_SCRIPT_SPEECH_STRUCT */ sub_60441( ref l_U107 );
                             /* P_SPEECH_PLAY_MAX_MONOLOGUE */ sub_60342( uParam0, ref l_U107 );
                            return 1;
                        }
                    }
                }
            }
        }
    }
    return 0;
}

/* UPDATE_FORCEWALK_AND_TRIGGER_PAIR */ int sub_92548(unknown uParam0, unknown uParam1, unknown uParam2, unknown uParam3, unknown uParam4, unknown uParam5, unknown uParam6, unknown uParam7, unknown uParam8, unknown uParam9, unknown uParam10, unknown uParam11, unknown uParam12, unknown uParam13, unknown uParam14, unknown uParam15, unknown uParam16, unknown uParam17, unknown uParam18, unknown uParam19, unknown uParam20, unknown uParam21, unknown uParam22, unknown uParam23, unknown uParam24, unknown uParam25, unknown uParam26, unknown uParam27, unknown uParam28, unknown uParam29, unknown uParam30, unknown uParam31, unknown uParam32, unknown uParam33, unknown uParam34, unknown uParam35, unknown uParam36, unknown uParam37, unknown uParam38, unknown uParam39, unknown uParam40, unknown uParam41, boolean bParam42)
{
    if ( /* IS_MAX_VALID */ sub_35429())
    {
        if ((NOT (GET_IS_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378() ))) AND ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( uParam0 )))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "UPDATE_FORCEWALK_AND_TRIGGER_PAIR - Force walk enabled", 0 );
            SET_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378(), 1 );
        }
        else if ((GET_IS_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378() )) AND (NOT ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( uParam0 ))))
        {
             /* WRITESCRIPTLOG */ sub_803( "RJM", "UPDATE_FORCEWALK_AND_TRIGGER_PAIR - Force walk disabled", 0 );
            SET_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        }
    }
    if ( /* F_ISPLAYERINTRIGGERBOX */ sub_56920( uParam21 ))
    {
        if (bParam42)
        {
            SET_PED_FORCED_TO_WALK(  /* PLAYER_PED_ID */ sub_11378(), 0 );
        }
        return 1;
    }
    return 0;
}

/* UNLOAD_SCRIPT_ASSETS */ void sub_93855()
{
     /* UNLOADMODEL */ sub_34347( g_U3097 );
     /* UNLOADMODEL */ sub_34347( -859113524 );
     /* UNLOADMODEL */ sub_34347( -1522991054 );
     /* UNLOADMODEL */ sub_34347( -1193498759 );
     /* UNLOADMODEL */ sub_34347( 588151771 );
     /* UNLOADMODEL */ sub_34347( 216303562 );
     /* UNLOADMODEL */ sub_34347( -946946919 );
     /* UNLOADMODEL */ sub_34347( 1740663406 );
     /* UNLOADMODEL */ sub_34347( g_U774 );
     /* UNLOADMODEL */ sub_34347( g_U775 );
     /* UNLOADMODEL */ sub_34347( g_U777 );
     /* UNLOADMODEL */ sub_34347( -1915312722 );
     /* UNLOADMODEL */ sub_34347( -1549971141 );
     /* UNLOAD_POST_MPM_ASSETS */ sub_78340();
     /* UNLOADANIMDICT */ sub_34599( "ny_wtanim" );
    return;
}

/* P_UNLOAD_WEAPONS */ void sub_94049(unknown uParam0)
{
    switch (uParam0)
    {
        case 0: break;
        case 1: break;
        case 2:
        case 5:
        case 6: break;
        case 7:
        case 8: break;
    }
    return;
}

